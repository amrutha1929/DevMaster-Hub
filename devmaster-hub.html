<!DOCTYPE html>
<!-- v2.0 - No login required -->
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>DevMaster Hub - Master Python, SQL & Golang</title>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#f5f7fa;--card:#fff;--text:#0f172a;--muted:#64748b;--accent:#0d9488;
  --accent2:#d97706;--success:#059669;--warn:#f59e0b;--danger:#dc2626;
  --border:#e2e8f0;--sidebar-bg:#0f172a;--sidebar-text:#94a3b8;--radius:14px;
  --shadow:0 4px 16px rgba(0,0,0,0.06);--card-hover:#f1f5f9;
}
body{font-family:'Inter','Segoe UI',system-ui,-apple-system,sans-serif;background:var(--bg);color:var(--text);display:flex;min-height:100vh}

/* Auth Overlay */
.auth-overlay{position:fixed;inset:0;background:linear-gradient(160deg,#0f172a 0%,#134e4a 50%,#1e3a5f 100%);z-index:9999;display:flex;align-items:center;justify-content:center}
.auth-overlay.hidden{display:none}
.auth-box{background:#fff;border-radius:20px;padding:2.5rem;width:90%;max-width:420px;box-shadow:0 24px 64px rgba(0,0,0,0.35);animation:authSlide .5s ease-out}
@keyframes authSlide{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.auth-logo{text-align:center;margin-bottom:1.5rem}
.auth-logo h1{font-size:1.6rem;color:#0f172a;margin-bottom:.2rem}
.auth-logo p{font-size:.85rem;color:#666}
.auth-tabs{display:flex;margin-bottom:1.5rem;border-radius:10px;overflow:hidden;border:2px solid #e0e0e0}
.auth-tab{flex:1;padding:.7rem;border:none;background:#f5f5f5;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s;color:#666}
.auth-tab.active{background:var(--accent);color:#fff}
.auth-form{display:none}.auth-form.active{display:block}
.auth-form .form-group{margin-bottom:1rem}
.auth-form .form-group label{display:block;font-size:.82rem;font-weight:600;color:#555;margin-bottom:.3rem}
.auth-form .form-group input{width:100%;padding:.7rem .9rem;border:2px solid #e0e0e0;border-radius:10px;font-size:.95rem;transition:border .2s;box-sizing:border-box}
.auth-form .form-group input:focus{outline:none;border-color:var(--accent)}
.auth-btn{width:100%;padding:.8rem;background:linear-gradient(135deg,#0d9488,#0f766e);color:#fff;border:none;border-radius:10px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s;margin-top:.5rem}
.auth-btn:hover{opacity:.9;transform:translateY(-1px)}
.auth-error{color:#e63946;font-size:.85rem;margin-top:.5rem;display:none}
.auth-success{color:#2ec4b6;font-size:.85rem;margin-top:.5rem;display:none}
body.dark{--bg:#0c1222;--card:#162032;--text:#e2e8f0;--muted:#94a3b8;--border:#1e3048;--shadow:0 4px 16px rgba(0,0,0,0.35);--card-hover:#1e293b}

/* Theme Presets */
body.theme-purple{--accent:#7c3aed;--accent2:#ec4899;--sidebar-bg:#1e1040;--sidebar-text:#a78bfa}
body.theme-purple.dark{--bg:#0f0a1f;--card:#1a1035;--border:#2d1b5e}
body.theme-sunset{--accent:#ea580c;--accent2:#e11d48;--sidebar-bg:#1c1210;--sidebar-text:#fb923c}
body.theme-sunset.dark{--bg:#1a0f0a;--card:#261810;--border:#4a2518}
body.theme-ocean{--accent:#2563eb;--accent2:#06b6d4;--sidebar-bg:#0c1929;--sidebar-text:#60a5fa}
body.theme-ocean.dark{--bg:#0a1525;--card:#101e35;--border:#1e3a5f}
body.theme-forest{--accent:#16a34a;--accent2:#84cc16;--sidebar-bg:#0a1a0e;--sidebar-text:#4ade80}
body.theme-forest.dark{--bg:#0a150c;--card:#122016;--border:#1a3a20}

/* Custom Scrollbar */
::-webkit-scrollbar{width:7px;height:7px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--accent);border-radius:10px;opacity:.6}
::-webkit-scrollbar-thumb:hover{opacity:1}
*{scrollbar-width:thin;scrollbar-color:var(--accent) transparent}

/* Sidebar */
.sidebar{width:240px;background:var(--sidebar-bg);color:var(--sidebar-text);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:100;transition:transform .3s}
.sidebar-header{padding:1.2rem;border-bottom:1px solid rgba(255,255,255,0.08)}
.sidebar-header h1{font-size:1.1rem;color:#fff;margin-bottom:.2rem}
.sidebar-header small{font-size:.75rem;opacity:.6}
.sidebar-nav{flex:1;overflow-y:auto;padding:.6rem 0}
.nav-section{padding:.4rem 1rem;font-size:.68rem;text-transform:uppercase;letter-spacing:1.2px;color:rgba(255,255,255,.35);margin-top:.6rem}
.nav-item{display:flex;align-items:center;gap:.7rem;padding:.7rem 1.2rem;cursor:pointer;transition:all .15s;font-size:.9rem;border-left:3px solid transparent}
.nav-item:hover{background:rgba(255,255,255,.06);padding-left:1.5rem}
.nav-item.active{background:rgba(13,148,136,.15);color:#fff;border-left-color:var(--accent);box-shadow:inset 4px 0 12px rgba(13,148,136,.25);position:relative}
.nav-item.active::after{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:6px;height:6px;border-radius:50%;background:var(--accent);box-shadow:0 0 8px var(--accent),0 0 16px var(--accent);animation:navGlow 2s ease-in-out infinite}
@keyframes navGlow{0%,100%{opacity:1;box-shadow:0 0 8px var(--accent),0 0 16px var(--accent)}50%{opacity:.5;box-shadow:0 0 4px var(--accent)}}
@keyframes confettiFall{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}

/* Quote Banner */
.quote-banner{background:linear-gradient(135deg,rgba(13,148,136,.08),rgba(217,119,6,.08));border:1px solid var(--border);border-radius:var(--radius);padding:1rem 1.2rem;margin-bottom:1.2rem;display:flex;align-items:center;gap:1rem;animation:quoteFade .8s ease-out}
.quote-banner .quote-icon{font-size:2rem;flex-shrink:0}
.quote-banner .quote-text{font-size:.92rem;font-style:italic;line-height:1.5;color:var(--text)}
.quote-banner .quote-author{font-size:.78rem;color:var(--muted);margin-top:.3rem;font-weight:600}
@keyframes quoteFade{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}

/* Progress Rings */
.progress-rings-card{margin-bottom:1.2rem}
.rings-grid{display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;padding:.5rem 0}
.ring-item{text-align:center}
.ring-label{font-size:.78rem;color:var(--muted);margin-top:.4rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}

/* Glassmorphism Cards */
.dash-stat-card{background:rgba(255,255,255,.7);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.2);border-radius:var(--radius);box-shadow:var(--shadow);padding:1rem;text-align:center;transition:transform .2s,box-shadow .2s}
.dash-stat-card:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.1)}
body.dark .dash-stat-card{background:rgba(22,32,50,.7);border:1px solid rgba(255,255,255,.06)}
body.dark .dash-stat-card:hover{box-shadow:0 8px 24px rgba(0,0,0,.3)}
.card{transition:transform .2s,box-shadow .2s}
.card:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.08)}
body.dark .card:hover{box-shadow:0 6px 20px rgba(0,0,0,.25)}

/* Theme dot active state */
.theme-dot:hover{transform:scale(1.3)!important;box-shadow:0 0 8px rgba(255,255,255,.3)}
.nav-item .icon{width:22px;text-align:center;font-size:1rem}
.sidebar-footer{padding:1rem;border-top:1px solid rgba(255,255,255,.08);display:flex;gap:.5rem}
.sidebar-footer button{flex:1;padding:.45rem;border:none;border-radius:8px;cursor:pointer;font-size:.8rem;background:rgba(255,255,255,.08);color:#ccc;transition:all .2s}
.sidebar-footer button:hover{background:rgba(255,255,255,.15);color:#fff}
.mobile-toggle{display:none;position:fixed;top:.8rem;left:.8rem;z-index:200;background:var(--accent);color:#fff;border:none;padding:.5rem .7rem;border-radius:8px;font-size:1.1rem;cursor:pointer}

/* Main */
.main-content{margin-left:240px;flex:1;min-height:100vh}
.topbar{background:var(--card);border-bottom:1px solid var(--border);padding:.8rem 1.5rem;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:50}
.topbar h2{font-size:1.1rem}
.user-select{display:flex;align-items:center;gap:.6rem}
.user-select label{font-size:.82rem;color:var(--muted)}
.user-select select{padding:.35rem .6rem;border:1.5px solid var(--border);border-radius:8px;font-size:.85rem;background:var(--card);color:var(--text)}
.content{padding:1.5rem;max-width:1100px;margin:0 auto}

/* Cards */
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:1.5rem;margin-bottom:1.2rem}
.card h3{font-size:1.05rem;margin-bottom:.8rem;display:flex;align-items:center;gap:.5rem}

/* Panels */
.panel{display:none}.panel.active{display:block}

/* Tabs inside panels */
.tabs{display:flex;gap:0;border-bottom:2px solid var(--border);margin-bottom:1.2rem;overflow-x:auto}
.tab{padding:.65rem 1.2rem;border:none;background:none;cursor:pointer;font-size:.88rem;font-weight:500;color:var(--muted);border-bottom:3px solid transparent;transition:all .2s;white-space:nowrap}
.tab:hover{color:var(--accent)}
.tab.active{color:var(--accent);border-bottom-color:var(--accent);font-weight:600}
.tab-panel{display:none}.tab-panel.active{display:block}

/* Buttons */
.btn{padding:.5rem 1rem;border:none;border-radius:8px;cursor:pointer;font-size:.87rem;font-weight:500;transition:all .2s;display:inline-flex;align-items:center;gap:.35rem}
.btn-primary{background:var(--accent);color:#fff}.btn-primary:hover{opacity:.9}
.btn-success{background:var(--success);color:#fff}
.btn-danger{background:var(--danger);color:#fff}.btn-danger:hover{opacity:.9}
.btn-outline{background:none;border:1.5px solid var(--border);color:var(--text)}.btn-outline:hover{border-color:var(--accent);color:var(--accent)}
.btn-sm{padding:.35rem .7rem;font-size:.8rem}
.btn-lg{padding:.65rem 1.5rem;font-size:1rem}

/* Forms */
input[type=text],input[type=number],input[type=url],select,textarea{width:100%;padding:.55rem .8rem;border:1.5px solid var(--border);border-radius:8px;font-size:.9rem;font-family:inherit;background:var(--card);color:var(--text);transition:border .2s}
input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent)}
textarea{resize:vertical;min-height:120px}
.form-group{margin-bottom:.8rem}
.form-group label{display:block;font-size:.78rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--muted);margin-bottom:.25rem}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:.8rem}

/* Concepts */
.concept-list{display:grid;gap:.8rem}
.concept-card{border:1px solid var(--border);border-radius:10px;overflow:hidden;transition:all .2s}
.concept-card:hover{box-shadow:0 3px 12px rgba(0,0,0,.08)}
.concept-header{padding:.8rem 1rem;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-weight:600;font-size:.95rem}
.concept-header .arrow{transition:transform .2s;font-size:.8rem}
.concept-card.open .arrow{transform:rotate(90deg)}
.concept-body{padding:0 1rem;max-height:0;overflow:hidden;transition:all .3s}
.concept-card.open .concept-body{padding:.5rem 1rem 1rem;max-height:2000px}
.concept-body p{font-size:.9rem;line-height:1.7;margin-bottom:.6rem;color:var(--muted)}
.concept-body code{background:rgba(13,148,136,.08);padding:.15rem .4rem;border-radius:4px;font-size:.85rem;color:var(--accent)}
.concept-body pre{background:#0f172a;color:#e2e8f0;padding:1rem;border-radius:8px;overflow-x:auto;font-size:.82rem;line-height:1.6;margin:.6rem 0}

/* Links Grid */
.links-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:.8rem}
.link-card{border:1px solid var(--border);border-radius:10px;padding:1rem;transition:all .2s}
.link-card:hover{border-color:var(--accent);box-shadow:0 2px 8px rgba(13,148,136,.1)}
.link-card h4{font-size:.92rem;margin-bottom:.3rem}
.link-card p{font-size:.8rem;color:var(--muted);margin-bottom:.5rem}
.link-card a{color:var(--accent);font-size:.82rem;text-decoration:none;font-weight:500}
.link-card a:hover{text-decoration:underline}
.link-tag{display:inline-block;padding:.12rem .5rem;border-radius:12px;font-size:.68rem;font-weight:600;text-transform:uppercase;margin-right:.3rem}
.tag-video{background:#fee2e2;color:#dc2626}.tag-tutorial{background:#e0f2fe;color:#0284c7}
.tag-docs{background:#f0fdf4;color:#16a34a}.tag-practice{background:#fef3c7;color:#d97706}
.tag-book{background:#f3e8ff;color:#9333ea}

/* Quiz */
.quiz-question{border:1px solid var(--border);border-radius:10px;padding:1.2rem;margin-bottom:1rem}
.quiz-question h4{font-size:.95rem;margin-bottom:.8rem}
.quiz-options{display:grid;gap:.4rem}
.quiz-option{display:flex;align-items:center;gap:.6rem;padding:.55rem .8rem;border:1.5px solid var(--border);border-radius:8px;cursor:pointer;transition:all .15s;font-size:.88rem}
.quiz-option:hover{border-color:var(--accent);background:rgba(13,148,136,.03)}
.quiz-option.selected{border-color:var(--accent);background:rgba(13,148,136,.08)}
.quiz-option.correct{border-color:var(--success);background:rgba(46,196,182,.1);color:var(--success)}
.quiz-option.wrong{border-color:var(--danger);background:rgba(230,57,70,.08);color:var(--danger)}
.quiz-option input{display:none}
.quiz-radio{width:18px;height:18px;border-radius:50%;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .15s}
.quiz-option.selected .quiz-radio{border-color:var(--accent)}
.quiz-option.selected .quiz-radio::after{content:'';width:9px;height:9px;border-radius:50%;background:var(--accent)}
.quiz-option.correct .quiz-radio{border-color:var(--success)}
.quiz-option.correct .quiz-radio::after{content:'âœ“';font-size:.7rem;color:var(--success);width:auto;height:auto;border-radius:0;background:none}
.quiz-explanation{margin-top:.6rem;padding:.6rem;background:rgba(46,196,182,.06);border-radius:8px;font-size:.85rem;color:var(--success);display:none}
.quiz-question.answered .quiz-explanation{display:block}
.quiz-score-bar{display:flex;align-items:center;gap:1rem;padding:1rem;background:var(--card);border-radius:10px;border:1px solid var(--border);margin-bottom:1rem}
.quiz-score-bar .score-num{font-size:2rem;font-weight:700;color:var(--accent)}

/* Exercises */
.exercise-card{border:1px solid var(--border);border-radius:10px;padding:1.2rem;margin-bottom:.8rem}
.exercise-card h4{margin-bottom:.5rem;display:flex;justify-content:space-between;align-items:center}
.exercise-card pre{background:#0f172a;color:#e2e8f0;padding:.8rem;border-radius:8px;font-size:.8rem;line-height:1.5;overflow-x:auto;margin:.5rem 0}
.diff-badge{padding:.15rem .5rem;border-radius:12px;font-size:.7rem;font-weight:600}
.diff-easy{background:#e6f4ea;color:#137333}.diff-medium{background:#fef7e0;color:#b06000}.diff-hard{background:#fce8e6;color:#c5221f}

/* Scores */
.scores-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem}
.score-column{border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem}
.score-column h3{text-align:center;margin-bottom:1rem;padding-bottom:.6rem;border-bottom:2px solid var(--border)}
.score-entry{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--border);font-size:.88rem}
.score-entry:last-child{border-bottom:none}
.score-total{font-size:1.5rem;font-weight:700;text-align:center;margin:1rem 0;color:var(--accent)}
.compare-bar{display:flex;height:30px;border-radius:8px;overflow:hidden;margin:.4rem 0}
.compare-fill-1{background:var(--accent);display:flex;align-items:center;justify-content:center;color:#fff;font-size:.75rem;font-weight:600;transition:width .4s}
.compare-fill-2{background:var(--accent2);display:flex;align-items:center;justify-content:center;color:#fff;font-size:.75rem;font-weight:600;transition:width .4s}
.add-score-form{display:grid;grid-template-columns:1fr auto auto;gap:.5rem;align-items:end;margin-bottom:1rem}

/* Notes */
.notes-grid{display:grid;grid-template-columns:220px 1fr;gap:1rem;min-height:450px}
.notes-list{border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.notes-list-header{padding:.7rem;background:rgba(13,148,136,.05);font-weight:600;font-size:.85rem;display:flex;justify-content:space-between;align-items:center}
.note-item{padding:.6rem .8rem;cursor:pointer;border-bottom:1px solid var(--border);font-size:.87rem;transition:all .15s;display:flex;justify-content:space-between;align-items:center}
.note-item:hover{background:rgba(13,148,136,.04)}
.note-item.active{background:rgba(13,148,136,.1);font-weight:600;color:var(--accent)}
.note-item .note-delete{opacity:0;background:none;border:none;cursor:pointer;color:var(--danger);font-size:.8rem;transition:opacity .15s}
.note-item:hover .note-delete{opacity:1}
.notes-editor-area{display:flex;flex-direction:column;gap:.6rem}
.notes-editor-area textarea{flex:1;min-height:350px;font-size:.92rem;line-height:1.7}
.notes-status{font-size:.8rem;color:var(--success)}

/* Books */
.book-card{display:flex;gap:1rem;border:1px solid var(--border);border-radius:10px;padding:1rem;margin-bottom:.8rem}
.book-icon{width:50px;height:65px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:6px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5rem;flex-shrink:0}
.book-info h4{font-size:.95rem;margin-bottom:.2rem}
.book-info p{font-size:.82rem;color:var(--muted);margin-bottom:.3rem}
.book-info .book-tags{display:flex;gap:.3rem;flex-wrap:wrap}

/* Progress bar */
.progress-bg{height:10px;background:var(--bg);border-radius:5px;overflow:hidden;margin:.3rem 0}
.progress-fill{height:100%;border-radius:5px;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .4s}

/* Download btn */
.download-btn{display:inline-flex;align-items:center;gap:.4rem;padding:.5rem 1rem;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:.85rem;font-weight:500;transition:opacity .2s;text-decoration:none}
.download-btn:hover{opacity:.85}

/* Modal */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:300;align-items:center;justify-content:center}
.modal-overlay.show{display:flex}
.modal{background:var(--card);border-radius:var(--radius);padding:1.5rem;width:90%;max-width:420px;box-shadow:0 8px 32px rgba(0,0,0,.2)}
.modal h3{margin-bottom:1rem}
.modal-actions{display:flex;gap:.5rem;justify-content:flex-end;margin-top:1rem}

/* XP & Level */
.xp-bar-outer{height:22px;background:var(--bg);border-radius:11px;overflow:hidden;position:relative;border:1px solid var(--border)}
.xp-bar-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));border-radius:11px;transition:width .6s}
.xp-bar-text{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:.72rem;font-weight:700;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.4)}
.level-badge{display:inline-flex;align-items:center;justify-content:center;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;font-size:1.3rem;font-weight:800;box-shadow:0 3px 12px rgba(13,148,136,.3)}
.xp-stat{text-align:center}
.xp-stat .num{font-size:1.8rem;font-weight:800;color:var(--accent)}
.xp-stat .label{font-size:.72rem;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.dash-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:1.2rem}
.dash-stat-card{border-radius:var(--radius);box-shadow:var(--shadow);padding:1rem;text-align:center}
.dash-stat-card .icon{font-size:1.5rem;margin-bottom:.3rem}
.dash-stat-card .val{font-size:1.6rem;font-weight:800}
.dash-stat-card .lbl{font-size:.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:.5px}

/* Streak */
.streak-cal{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}
.streak-day{width:100%;aspect-ratio:1;border-radius:4px;background:var(--border);position:relative}
.streak-day.active{background:var(--success)}
.streak-day.today{outline:2px solid var(--accent);outline-offset:1px}
.streak-day.start{outline:2px solid var(--warn);outline-offset:1px}
.streak-day .streak-tip{display:none;position:absolute;bottom:110%;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:2px 6px;border-radius:4px;font-size:.65rem;white-space:nowrap;z-index:5}
.streak-day:hover .streak-tip{display:block}

/* Badges */
.badge-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:.8rem}
.badge-card{text-align:center;padding:.8rem;border-radius:10px;border:1.5px solid var(--border);transition:all .2s}
.badge-card.unlocked{border-color:var(--warn);background:rgba(255,159,28,.05)}
.badge-card .badge-icon{font-size:2rem;margin-bottom:.3rem;filter:grayscale(1) opacity(.3)}
.badge-card.unlocked .badge-icon{filter:none}
.badge-card .badge-name{font-size:.78rem;font-weight:600}
.badge-card .badge-desc{font-size:.68rem;color:var(--muted)}

/* Leaderboard */
.lb-row{display:flex;align-items:center;gap:.8rem;padding:.7rem .8rem;border-radius:8px;margin-bottom:.4rem;border:1px solid var(--border)}
.lb-row.rank-1{background:rgba(255,215,0,.08);border-color:rgba(255,215,0,.3)}
.lb-row.rank-2{background:rgba(192,192,192,.08);border-color:rgba(192,192,192,.3)}
.lb-row.rank-3{background:rgba(205,127,50,.08);border-color:rgba(205,127,50,.3)}
.lb-rank{font-size:1.3rem;width:32px;text-align:center}
.lb-name{flex:1;font-weight:600;font-size:.92rem}
.lb-xp{font-weight:700;color:var(--accent)}

/* Flashcards */
.fc-container{display:flex;flex-direction:column;align-items:center;gap:1rem}
.fc-deck-select{display:flex;gap:.5rem;flex-wrap:wrap;justify-content:center}
.fc-deck-btn{padding:.5rem 1rem;border:1.5px solid var(--border);border-radius:20px;background:var(--card);cursor:pointer;font-size:.85rem;transition:all .2s}
.fc-deck-btn:hover,.fc-deck-btn.active{border-color:var(--accent);color:var(--accent);background:rgba(13,148,136,.05)}
.fc-card-wrap{perspective:800px;width:100%;max-width:480px;height:260px;cursor:pointer}
.fc-card{width:100%;height:100%;position:relative;transition:transform .5s;transform-style:preserve-3d}
.fc-card.flipped{transform:rotateY(180deg)}
.fc-face{position:absolute;inset:0;backface-visibility:hidden;border-radius:var(--radius);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1.5rem;text-align:center;border:2px solid var(--border)}
.fc-front{background:var(--card);font-size:1.1rem;font-weight:600}
.fc-back{background:linear-gradient(135deg,rgba(13,148,136,.05),rgba(217,119,6,.05));transform:rotateY(180deg);font-size:.95rem;line-height:1.6}
.fc-nav{display:flex;gap:.8rem;align-items:center}
.fc-progress{font-size:.85rem;color:var(--muted)}
.fc-mastery{display:flex;gap:.5rem;margin-top:.5rem}
.fc-mastery .btn{padding:.45rem 1.2rem}

/* Challenges */
.ch-card{border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1rem}
.ch-card h4{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}
.ch-timer{font-size:1.8rem;font-weight:800;font-variant-numeric:tabular-nums;text-align:center;margin:.8rem 0;color:var(--accent)}
.ch-textarea{width:100%;min-height:150px;font-family:'Consolas','Courier New',monospace;font-size:.85rem;padding:.8rem;border:1.5px solid var(--border);border-radius:8px;background:var(--card);color:var(--text);resize:vertical}

/* Video Tutorials */
.video-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1rem}
.video-card{border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;transition:all .2s}
.video-card:hover{box-shadow:0 4px 16px rgba(0,0,0,.1);transform:translateY(-2px)}
.video-thumb{position:relative;width:100%;padding-top:56.25%;background:#000;overflow:hidden;cursor:pointer}
.video-thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
.video-thumb .play-btn{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.35);transition:background .2s}
.video-thumb:hover .play-btn{background:rgba(0,0,0,.5)}
.play-btn span{width:56px;height:56px;background:rgba(255,0,0,.9);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.3rem;color:#fff;padding-left:3px}
.video-info{padding:.8rem 1rem}
.video-info h4{font-size:.92rem;margin-bottom:.25rem;line-height:1.3}
.video-info .video-meta{font-size:.75rem;color:var(--muted);display:flex;gap:.8rem;align-items:center;margin-bottom:.3rem}
.video-info .video-desc{font-size:.82rem;color:var(--muted);line-height:1.5}
.video-lang-tag{display:inline-block;padding:.12rem .5rem;border-radius:12px;font-size:.68rem;font-weight:700;text-transform:uppercase}
.vt-python{background:#306998;color:#ffd43b}.vt-sql{background:#e48e00;color:#fff}.vt-golang{background:#00add8;color:#fff}.vt-general{background:var(--accent);color:#fff}
.video-filter-bar{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1.2rem}
.vf-btn{padding:.4rem .9rem;border:1.5px solid var(--border);border-radius:20px;background:var(--card);cursor:pointer;font-size:.82rem;color:var(--muted);transition:all .15s}
.vf-btn:hover,.vf-btn.active{border-color:var(--accent);color:var(--accent);background:rgba(13,148,136,.05)}
.video-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:500;align-items:center;justify-content:center;padding:1rem}
.video-modal.show{display:flex}
.video-modal-inner{width:100%;max-width:800px;background:var(--card);border-radius:var(--radius);overflow:hidden}
.video-modal-inner iframe{width:100%;aspect-ratio:16/9;border:none;display:block}
.video-modal-close{position:absolute;top:1rem;right:1.5rem;background:rgba(255,255,255,.15);border:none;color:#fff;font-size:1.5rem;cursor:pointer;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background .2s}
.video-modal-close:hover{background:rgba(255,255,255,.3)}

/* Cheatsheet */
.cheat-section{margin-bottom:1.2rem}
.cheat-section h4{font-size:.92rem;margin-bottom:.5rem;color:var(--accent)}
.cheat-table{width:100%;border-collapse:collapse;font-size:.82rem;margin-bottom:.8rem}
.cheat-table th{background:rgba(13,148,136,.08);text-align:left;padding:.45rem .6rem;font-weight:600;border:1px solid var(--border)}
.cheat-table td{padding:.4rem .6rem;border:1px solid var(--border);font-family:'Consolas',monospace;font-size:.8rem}
.cheat-table tr:hover{background:rgba(13,148,136,.03)}

/* Schedule */
.sched-day-card{border:1px solid var(--border);border-radius:var(--radius);padding:1rem;margin-bottom:.8rem;display:grid;grid-template-columns:60px 1fr;gap:1rem}
.sched-day-num{display:flex;flex-direction:column;align-items:center;justify-content:center}
.sched-day-num .num{font-size:1.5rem;font-weight:800;color:var(--accent)}
.sched-day-num .lang-icon{font-size:1.2rem}
.sched-day-card.completed{opacity:.6;border-color:var(--success)}
.sched-day-card.today-card{border-color:var(--accent);box-shadow:0 0 0 2px rgba(13,148,136,.15)}
.sched-time-block{display:inline-block;padding:.15rem .5rem;border-radius:6px;font-size:.72rem;font-weight:600;margin-right:.3rem}
.sched-morning{background:#e0f2fe;color:#0284c7}
.sched-afternoon{background:#fef3c7;color:#d97706}

/* Mini Projects */
.project-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.2rem}
.project-card{border:1.5px solid var(--border);border-radius:var(--radius);overflow:hidden;transition:all .2s;background:var(--card)}
.project-card:hover{border-color:var(--accent);box-shadow:0 4px 16px rgba(13,148,136,.12)}
.project-header{display:flex;justify-content:space-between;align-items:start;gap:.8rem;padding:1.2rem}
.project-title{flex:1}
.project-title h4{font-size:1rem;margin-bottom:.3rem;color:var(--text)}
.project-title p{font-size:.8rem;color:var(--muted)}
.project-badges{display:flex;gap:.4rem}
.project-diff-badge{padding:.25rem .6rem;border-radius:8px;font-size:.7rem;font-weight:600}
.project-diff-badge.easy{background:#e6f4ea;color:#137333}
.project-diff-badge.medium{background:#fef7e0;color:#b06000}
.project-diff-badge.hard{background:#fce8e6;color:#c5221f}
.project-xp-badge{padding:.25rem .6rem;border-radius:8px;font-size:.7rem;font-weight:600;background:rgba(13,148,136,.1);color:var(--accent)}
.project-section{padding:0 1.2rem 1rem}
.project-section h5{font-size:.78rem;text-transform:uppercase;letter-spacing:.5px;color:var(--muted);margin-bottom:.4rem;font-weight:600}
.project-content{font-size:.85rem;line-height:1.6;color:var(--text)}
.project-content ul{margin-left:1.2rem;margin-bottom:.5rem}
.project-content li{margin-bottom:.3rem}
.project-content code{background:rgba(13,148,136,.08);padding:.1rem .3rem;border-radius:3px;font-size:.82rem;color:var(--accent)}
.project-code-block{background:#0f172a;color:#e2e8f0;padding:1rem;border-radius:8px;font-size:.8rem;font-family:monospace;overflow-x:auto;line-height:1.5;margin:.5rem 0}
.project-footer{display:flex;gap:.5rem;padding:1rem 1.2rem;border-top:1px solid var(--border);background:rgba(13,148,136,.02)}
.project-status{flex:1;display:flex;align-items:center;gap:.4rem;font-size:.8rem}
.project-status.locked{color:var(--muted)}
.project-status.completed{color:var(--success)}
.project-status.in-progress{color:var(--warn)}
.project-btn{padding:.45rem 1rem;border:none;border-radius:6px;cursor:pointer;font-size:.8rem;font-weight:600;transition:all .2s}
.project-btn.start{background:var(--accent);color:#fff}
.project-btn.start:hover{opacity:.9}
.project-btn.view{background:rgba(13,148,136,.08);color:var(--accent)}
.project-btn.view:hover{background:rgba(13,148,136,.15)}
.project-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:400;align-items:center;justify-content:center;padding:1rem;overflow-y:auto}
.project-modal.show{display:flex}
.project-modal-content{background:var(--card);border-radius:var(--radius);max-width:700px;width:100%;max-height:90vh;overflow-y:auto;padding:2rem}
.project-modal-close{position:absolute;top:1.5rem;right:1.5rem;background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--muted)}
.project-modal-close:hover{color:var(--text)}
.project-modal h3{margin-bottom:.5rem}
.project-modal p{font-size:.9rem;line-height:1.6;margin-bottom:.8rem}
.project-tasks{background:var(--bg);border-radius:8px;padding:1rem;margin:1rem 0}
.project-task{display:flex;gap:.6rem;margin-bottom:.6rem}
.project-task input[type=checkbox]{width:18px;height:18px;cursor:pointer;flex-shrink:0;margin-top:.2rem}
.project-task label{flex:1;font-size:.9rem}
.project-starter-code{background:#0f172a;color:#e2e8f0;padding:1rem;border-radius:8px;font-family:monospace;font-size:.8rem;line-height:1.5;overflow-x:auto;margin:1rem 0}
.project-modal-buttons{display:flex;gap:.8rem;margin-top:1.5rem;flex-wrap:wrap}
.project-modal-buttons .btn{flex:1;min-width:120px}
.sched-evening{background:#f3e8ff;color:#9333ea}

/* Notification toast */
.toast{position:fixed;top:1rem;right:1rem;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:.8rem 1.2rem;box-shadow:0 4px 20px rgba(0,0,0,.15);z-index:400;transform:translateX(120%);transition:transform .3s;display:flex;align-items:center;gap:.6rem;font-size:.88rem;max-width:340px}
.toast.show{transform:translateX(0)}
.toast .toast-icon{font-size:1.2rem}

/* Floating Chatbot Widget */
.chatbot-button{position:fixed;bottom:2rem;right:2rem;width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg, var(--accent), var(--accent2));color:white;border:none;cursor:pointer;font-size:1.5rem;box-shadow:0 4px 16px rgba(13,148,136,.4);display:flex;align-items:center;justify-content:center;z-index:10001;transition:all .3s;animation:bounce 2s infinite}
.chatbot-button:hover,.chatbot-button.open{transform:scale(1.1);box-shadow:0 6px 24px rgba(13,148,136,.6);animation:none}
@keyframes bounce{0%, 100%{transform:translateY(0)} 50%{transform:translateY(-8px)}}

.chatbot-modal{position:fixed;bottom:5.5rem;right:2rem;width:420px;height:600px;background:var(--card);border-radius:16px;box-shadow:0 8px 40px rgba(0,0,0,.3);display:flex;flex-direction:column;z-index:10001;border:1.5px solid var(--border);opacity:0;transform:translateY(20px);pointer-events:none;transition:all .3s ease}
.chatbot-modal.open{opacity:1;transform:translateY(0);pointer-events:all}

.chatbot-header{padding:1rem;border-bottom:1.5px solid var(--border);display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg, rgba(13,148,136,.05), rgba(217,119,6,.05))}
.chatbot-header h4{margin:0;font-size:.95rem}
.chatbot-header button{background:rgba(13,148,136,.1);border:none;font-size:1.2rem;cursor:pointer;color:var(--text);width:32px;height:32px;border-radius:50%;transition:all .2s}
.chatbot-header button:hover{background:rgba(13,148,136,.2)}

.chatbot-messages{flex:1;overflow-y:auto;padding:1rem;display:flex;flex-direction:column;gap:.8rem}
.chatbot-message{padding:.8rem 1rem;border-radius:10px;max-width:85%;font-size:.85rem;line-height:1.5;animation:slideUp .3s ease}
.chatbot-message.user{background:var(--accent);color:white;align-self:flex-end;text-align:right;border-radius:12px 0 12px 12px}
.chatbot-message.bot{background:var(--border);color:var(--text);align-self:flex-start;border-radius:0 12px 12px 12px}
.chatbot-message.bot.loading{opacity:.7;font-style:italic}
@keyframes slideUp{from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)}}

.chatbot-input{padding:1rem;border-top:1.5px solid var(--border);display:flex;gap:.5rem}
.chatbot-input input{flex:1;padding:.6rem .8rem;border:1.5px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:.85rem;font-family:inherit}
.chatbot-input input:focus{outline:none;border-color:var(--accent)}
.chatbot-input button{padding:.6rem 1rem;background:var(--accent);color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s}
.chatbot-input button:hover{opacity:.9;transform:scale(1.05)}

.chatbot-setup{padding:1.5rem;display:flex;flex-direction:column;gap:1rem;background:var(--card);border-radius:12px;border:1.5px solid var(--border);min-width:380px}
.chatbot-setup h3{margin:0 0 .5rem 0;font-size:.95rem;color:var(--text)}
.chatbot-setup input{padding:.6rem;border:1.5px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:.85rem;font-family:monospace}
.chatbot-setup input:focus{outline:none;border-color:var(--accent)}
.chatbot-setup button{padding:.7rem 1.5rem;background:var(--accent);color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s}
.chatbot-setup button:hover{opacity:.9;transform:translateY(-2px)}
.chatbot-setup p{margin:0;font-size:.8rem;color:var(--muted);line-height:1.5}

/* Chatbot Ring Notification */
.chatbot-button .ring{position:absolute;inset:-4px;border-radius:50%;border:2px solid var(--accent);animation:chatRing 1.5s ease-out infinite;pointer-events:none}
@keyframes chatRing{0%{transform:scale(1);opacity:.8}100%{transform:scale(1.4);opacity:0}}
.chatbot-quick-prompts{display:flex;flex-wrap:wrap;gap:.4rem;padding:.5rem 1rem;border-top:1px solid var(--border)}
.chatbot-quick-prompts button{padding:.3rem .7rem;border:1.5px solid var(--border);border-radius:16px;background:var(--card);cursor:pointer;font-size:.75rem;color:var(--muted);transition:all .15s;white-space:nowrap}
.chatbot-quick-prompts button:hover{border-color:var(--accent);color:var(--accent);background:rgba(13,148,136,.05)}

/* Enhanced Progress Map */
.pm-dot{cursor:pointer}
.pm-dot.current{animation:pmPulse 2s ease-in-out infinite}
@keyframes pmPulse{0%,100%{box-shadow:0 0 0 4px rgba(13,148,136,.2)}50%{box-shadow:0 0 0 8px rgba(13,148,136,.1)}}
.pm-node{transition:all .2s ease}
.pm-node:hover{transform:translateX(4px)}
.pm-node.done .pm-dot{transition:all .3s ease}
.pm-summary{display:flex;gap:1.5rem;padding:.8rem 1rem;background:rgba(13,148,136,.04);border-radius:10px;margin-bottom:1rem;flex-wrap:wrap}
.pm-summary-item{display:flex;align-items:center;gap:.4rem;font-size:.82rem;color:var(--muted)}
.pm-summary-item .dot{width:12px;height:12px;border-radius:50%;flex-shrink:0}

/* Standalone Cheat Sheet Panel */
.cs-lang-tabs{display:flex;gap:.5rem;margin-bottom:1.2rem}
.cs-lang-tab{padding:.5rem 1.2rem;border:2px solid var(--border);border-radius:20px;background:var(--card);cursor:pointer;font-size:.88rem;font-weight:600;transition:all .2s;display:flex;align-items:center;gap:.4rem}
.cs-lang-tab:hover{border-color:var(--accent);color:var(--accent)}
.cs-lang-tab.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.cs-search{display:flex;gap:.5rem;margin-bottom:1rem}
.cs-search input{flex:1;padding:.55rem .9rem;border:1.5px solid var(--border);border-radius:8px;font-size:.88rem;background:var(--card);color:var(--text)}
.cs-search input:focus{outline:none;border-color:var(--accent)}
.cs-content{animation:csFade .3s ease}
@keyframes csFade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* Code Playground */
.pg-editor{display:grid;grid-template-columns:1fr 1fr;gap:1rem;min-height:350px}
.pg-code{font-family:'Consolas','Courier New',monospace;font-size:.85rem;line-height:1.6;padding:.8rem;border:1.5px solid var(--border);border-radius:8px;background:#0f172a;color:#e2e8f0;resize:none;min-height:300px;tab-size:2}
.pg-output{background:var(--bg);border:1.5px solid var(--border);border-radius:8px;padding:.8rem;font-family:'Consolas',monospace;font-size:.83rem;white-space:pre-wrap;overflow:auto;max-height:350px;min-height:300px}
.pg-bar{display:flex;gap:.5rem;margin-bottom:.8rem;align-items:center;flex-wrap:wrap}

/* Pomodoro */
.pomo-display{font-size:5rem;font-weight:800;font-variant-numeric:tabular-nums;text-align:center;letter-spacing:3px;margin:1rem 0}
.pomo-label{text-align:center;font-size:1rem;text-transform:uppercase;letter-spacing:2px;color:var(--muted)}
.pomo-controls{display:flex;gap:.8rem;justify-content:center;margin:1.2rem 0}
.pomo-controls .btn{padding:.65rem 1.6rem;font-size:.95rem}
.pomo-sessions{display:flex;gap:.3rem;justify-content:center;margin-top:.8rem}
.pomo-dot{width:14px;height:14px;border-radius:50%;border:2px solid var(--accent)}
.pomo-dot.filled{background:var(--accent)}

/* Daily Quiz */
.dq-card{border:2px solid var(--accent);border-radius:var(--radius);padding:1.5rem;text-align:center;background:linear-gradient(135deg,rgba(13,148,136,.03),rgba(217,119,6,.03))}
.dq-card h3{margin-bottom:1rem}

/* Interview */
.interview-card{border:1px solid var(--border);border-radius:10px;margin-bottom:.8rem;overflow:hidden}
.interview-q{padding:.8rem 1rem;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-weight:600;font-size:.92rem}
.interview-q:hover{background:rgba(13,148,136,.03)}
.interview-a{padding:0 1rem;max-height:0;overflow:hidden;transition:all .3s}
.interview-card.open .interview-a{padding:.5rem 1rem 1rem;max-height:3000px}
.interview-card.open .iv-arrow{transform:rotate(90deg)}
.iv-arrow{transition:transform .2s;font-size:.8rem}

/* Error Dictionary */
.err-card{border-left:4px solid var(--danger);padding:.8rem 1rem;margin-bottom:.8rem;border-radius:0 8px 8px 0;background:rgba(230,57,70,.03)}
.err-card h4{color:var(--danger);font-size:.9rem;margin-bottom:.3rem;font-family:'Consolas',monospace}
.err-card .err-fix{background:rgba(46,196,182,.06);border-left:3px solid var(--success);padding:.5rem .8rem;margin-top:.4rem;border-radius:0 6px 6px 0;font-size:.85rem}

/* Comparison Table */
.cmp-table{width:100%;border-collapse:collapse;font-size:.82rem}
.cmp-table th{background:rgba(13,148,136,.08);padding:.55rem .7rem;text-align:left;font-weight:700;border:1px solid var(--border)}
.cmp-table td{padding:.5rem .7rem;border:1px solid var(--border);font-family:'Consolas',monospace;font-size:.8rem;vertical-align:top}
.cmp-table tr:hover{background:rgba(13,148,136,.03)}

/* Certificate */
.cert-preview{border:3px solid var(--accent);border-radius:16px;padding:2.5rem;text-align:center;background:linear-gradient(135deg,rgba(13,148,136,.02),rgba(217,119,6,.02));max-width:650px;margin:0 auto}
.cert-preview .cert-title{font-size:1.8rem;font-weight:800;color:var(--accent);margin-bottom:.5rem}
.cert-preview .cert-name{font-size:1.5rem;font-weight:700;color:var(--accent2);margin:1rem 0}
.cert-preview .cert-detail{font-size:.9rem;color:var(--muted);margin:.3rem 0}
.cert-preview .cert-badge{font-size:3rem;margin:.5rem 0}

/* Glossary */
.glossary-list{column-count:2;column-gap:1.5rem}
.glossary-item{break-inside:avoid;padding:.5rem 0;border-bottom:1px solid var(--border);margin-bottom:.3rem}
.glossary-item dt{font-weight:700;font-size:.9rem;color:var(--accent)}
.glossary-item dd{font-size:.83rem;color:var(--muted);margin-left:0}

/* Debug Exercises */
.debug-card{border:1px solid var(--border);border-radius:10px;padding:1.2rem;margin-bottom:1rem}
.debug-card h4{display:flex;justify-content:space-between;align-items:center;margin-bottom:.6rem}
.debug-code{background:#0f172a;color:#e2e8f0;padding:.8rem;border-radius:8px;font-family:'Consolas',monospace;font-size:.83rem;line-height:1.6;margin:.5rem 0;overflow-x:auto;white-space:pre}
.debug-input{width:100%;padding:.5rem .8rem;border:1.5px solid var(--border);border-radius:8px;font-family:'Consolas',monospace;font-size:.85rem;background:var(--card);color:var(--text);margin:.4rem 0}
.debug-result{padding:.5rem .8rem;border-radius:8px;font-size:.85rem;margin-top:.4rem;display:none}
.debug-result.correct{display:block;background:rgba(46,196,182,.1);color:var(--success);border:1px solid var(--success)}
.debug-result.wrong{display:block;background:rgba(230,57,70,.08);color:var(--danger);border:1px solid var(--danger)}

/* Fill in the Blank */
.fitb-card{border:1px solid var(--border);border-radius:10px;padding:1.2rem;margin-bottom:1rem}
.fitb-code{background:#0f172a;color:#e2e8f0;padding:.8rem;border-radius:8px;font-family:'Consolas',monospace;font-size:.83rem;line-height:2;margin:.5rem 0}
.fitb-blank{background:rgba(13,148,136,.2);border:1.5px dashed var(--accent);border-radius:4px;padding:2px 4px;min-width:80px;display:inline-block;color:var(--accent);font-weight:600}
.fitb-blank input{background:transparent;border:none;color:#ffd43b;font-family:'Consolas',monospace;font-size:.83rem;width:100px;outline:none;text-align:center}
.fitb-result{padding:.5rem .8rem;border-radius:8px;font-size:.85rem;margin-top:.4rem;display:none}
.fitb-result.show{display:block}

/* Drag & Drop Code Order */
.dnd-card{border:1px solid var(--border);border-radius:10px;padding:1.2rem;margin-bottom:1rem}
.dnd-lines{min-height:50px}
.dnd-line{background:var(--bg);border:1.5px solid var(--border);border-radius:8px;padding:.5rem .8rem;margin-bottom:.4rem;cursor:grab;font-family:'Consolas',monospace;font-size:.83rem;display:flex;align-items:center;gap:.6rem;transition:all .15s;user-select:none}
.dnd-line:active{cursor:grabbing;box-shadow:0 3px 12px rgba(0,0,0,.15)}
.dnd-line .drag-handle{color:var(--muted);font-size:.8rem}
.dnd-line.drag-over{border-color:var(--accent);background:rgba(13,148,136,.05)}
.dnd-line.correct-line{border-color:var(--success);background:rgba(46,196,182,.08)}
.dnd-line.wrong-line{border-color:var(--danger);background:rgba(230,57,70,.06)}

/* Concept Mini Quiz */
.concept-mini-quiz{background:rgba(13,148,136,.04);border:1px solid rgba(13,148,136,.15);border-radius:8px;padding:.8rem;margin-top:.6rem}
.concept-mini-quiz h5{font-size:.82rem;color:var(--accent);margin-bottom:.5rem}
.cmq-option{display:block;padding:.35rem .6rem;border:1px solid var(--border);border-radius:6px;margin-bottom:.3rem;cursor:pointer;font-size:.82rem;transition:all .15s}
.cmq-option:hover{border-color:var(--accent);background:rgba(13,148,136,.03)}
.cmq-option.cmq-correct{border-color:var(--success);background:rgba(46,196,182,.1);color:var(--success)}
.cmq-option.cmq-wrong{border-color:var(--danger);background:rgba(230,57,70,.08);color:var(--danger)}

/* Progress Map */
.progress-map{position:relative;padding:1rem 0}
.pm-track{display:flex;flex-direction:column;gap:0;position:relative}
.pm-node{display:flex;align-items:center;gap:1rem;padding:.6rem 0;position:relative}
.pm-dot{width:36px;height:36px;border-radius:50%;border:3px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:.8rem;font-weight:700;flex-shrink:0;background:var(--card);z-index:2;transition:all .3s}
.pm-dot.done{background:var(--success);border-color:var(--success);color:#fff}
.pm-dot.current{background:var(--accent);border-color:var(--accent);color:#fff;box-shadow:0 0 0 4px rgba(13,148,136,.2)}
.pm-dot.locked{opacity:.4}
.pm-line{position:absolute;left:17px;top:42px;bottom:0;width:3px;background:var(--border);z-index:1}
.pm-node:last-child .pm-line{display:none}
.pm-node.done .pm-line{background:var(--success)}
.pm-info{flex:1}
.pm-info .pm-title{font-weight:600;font-size:.9rem}
.pm-info .pm-sub{font-size:.78rem;color:var(--muted)}
.pm-lang-tabs{display:flex;gap:.5rem;margin-bottom:1rem}

/* Study Timer */
.study-timer-bar{display:flex;gap:.4rem;margin-top:.5rem}
.st-segment{flex:1;border-radius:6px;text-align:center;padding:.4rem;font-size:.7rem;font-weight:600;color:#fff;min-height:30px;display:flex;flex-direction:column;align-items:center;justify-content:center}
.st-python{background:#306998}.st-sql{background:#e48e00}.st-golang{background:#00add8}
.study-timer-active{display:flex;align-items:center;gap:.5rem;padding:.4rem .8rem;background:rgba(13,148,136,.08);border-radius:8px;font-size:.82rem;margin-top:.4rem}
.study-timer-active .st-pulse{width:8px;height:8px;border-radius:50%;background:var(--danger);animation:stpulse 1.5s infinite}
@keyframes stpulse{0%,100%{opacity:1}50%{opacity:.3}}

/* Daily Tip */
.daily-tip-card{border:2px solid var(--warn);border-radius:var(--radius);padding:1rem;background:linear-gradient(135deg,rgba(255,159,28,.04),rgba(255,159,28,.01));margin-bottom:1.2rem}
.daily-tip-card h3{font-size:.95rem;margin-bottom:.5rem;color:var(--warn)}
.daily-tip-card .tip-text{font-size:.88rem;line-height:1.6}
.daily-tip-card .tip-challenge{background:rgba(13,148,136,.05);border:1px solid var(--border);border-radius:8px;padding:.6rem;margin-top:.5rem;font-size:.85rem}

/* Peer Challenge */
.peer-card{border:2px solid var(--accent2);border-radius:var(--radius);padding:1.5rem;text-align:center;background:linear-gradient(135deg,rgba(217,119,6,.03),rgba(13,148,136,.03))}
.peer-vs{font-size:2rem;font-weight:800;color:var(--accent2);margin:.8rem 0}
.peer-result-grid{display:grid;grid-template-columns:1fr auto 1fr;gap:1rem;align-items:center;margin-top:1rem}
.peer-col{text-align:center}
.peer-col .name{font-weight:700;font-size:.95rem;margin-bottom:.3rem}

/* Streak Milestones */
.streak-milestones{display:flex;gap:.5rem;margin-top:.6rem;flex-wrap:wrap}
.streak-ms{padding:.25rem .6rem;border-radius:12px;font-size:.72rem;font-weight:600;border:1.5px solid var(--border);opacity:.4;transition:all .2s}
.streak-ms.unlocked{opacity:1;border-color:var(--warn);background:rgba(255,159,28,.1);color:var(--warn)}

/* Export Report */
.report-preview{border:2px solid var(--border);border-radius:var(--radius);padding:1.5rem;max-height:400px;overflow-y:auto;font-size:.85rem;line-height:1.7}

/* AI Prompts */
.prompt-card{border:1px solid var(--border);border-radius:10px;padding:1rem;margin-bottom:.8rem;cursor:pointer;transition:all .15s}
.prompt-card:hover{border-color:var(--accent);background:rgba(13,148,136,.03)}
.prompt-card h4{font-size:.9rem;margin-bottom:.3rem}
.prompt-card p{font-size:.82rem;color:var(--muted)}
.prompt-text{background:#0f172a;color:#e2e8f0;padding:.6rem .8rem;border-radius:6px;font-size:.82rem;margin-top:.4rem;cursor:text;user-select:all}
.copied-badge{display:inline-block;color:var(--success);font-size:.75rem;font-weight:600;margin-left:.5rem;opacity:0;transition:opacity .2s}
.copied-badge.show{opacity:1}

/* Weekly Goals */
.goal-item{display:flex;align-items:center;gap:.7rem;padding:.6rem 0;border-bottom:1px solid var(--border)}
.goal-check{width:22px;height:22px;border-radius:6px;border:2px solid var(--border);cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .15s;font-size:.7rem}
.goal-check:hover{border-color:var(--success)}
.goal-item.done .goal-check{background:var(--success);border-color:var(--success);color:#fff}
.goal-item.done .goal-text{text-decoration:line-through;opacity:.5}
.goal-text{flex:1;font-size:.9rem}

/* Typing Practice */
.type-area{font-family:'Consolas',monospace;font-size:1rem;line-height:1.8;padding:1rem;border-radius:8px;background:var(--bg);border:1.5px solid var(--border);position:relative;min-height:120px;cursor:text}
.type-target span{padding:1px 0}
.type-correct{color:var(--success)}.type-wrong{color:var(--danger);text-decoration:underline}
.type-cursor{border-left:2px solid var(--accent);animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
.type-stats{display:flex;gap:2rem;justify-content:center;margin:1rem 0}
.type-stat{text-align:center}
.type-stat .num{font-size:1.5rem;font-weight:800;color:var(--accent)}
.type-stat .lbl{font-size:.72rem;color:var(--muted);text-transform:uppercase}

/* Community */
.comm-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1rem}
.comm-card{border:1px solid var(--border);border-radius:10px;padding:1rem;text-align:center;transition:all .2s}
.comm-card:hover{border-color:var(--accent);box-shadow:0 2px 8px rgba(13,148,136,.1)}
.comm-card .comm-icon{font-size:2rem;margin-bottom:.5rem}
.comm-card h4{font-size:.92rem;margin-bottom:.3rem}
.comm-card p{font-size:.8rem;color:var(--muted);margin-bottom:.5rem}

/* Responsive */
@media(max-width:900px){
  .sidebar{transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .mobile-toggle{display:block}
  .main-content{margin-left:0}
  .scores-grid{grid-template-columns:1fr}
  .notes-grid{grid-template-columns:1fr}
  .form-row{grid-template-columns:1fr}
  .add-score-form{grid-template-columns:1fr}
  .dash-stats{grid-template-columns:repeat(2,1fr)!important}
  .badge-grid{grid-template-columns:repeat(2,1fr)}
  .pg-editor{grid-template-columns:1fr}
  .glossary-list{column-count:1}
  .pomo-display{font-size:3.5rem}
}
@media(max-width:600px){
  .links-grid{grid-template-columns:1fr}
  .content{padding:1rem}
}

/* Typing Speed Test */
.typing-test-container{max-width:800px;margin:0 auto}
.typing-test-controls{display:flex;gap:.8rem;align-items:center;flex-wrap:wrap;margin-bottom:1rem}
.typing-test-display{font-family:'Consolas','Courier New',monospace;font-size:.95rem;line-height:2;padding:1.2rem;border-radius:10px;background:#0f172a;color:#64748b;min-height:160px;position:relative;border:2px solid var(--border);user-select:none;white-space:pre-wrap;word-wrap:break-word}
.typing-char{transition:color .05s}
.typing-correct{color:#4ade80}
.typing-wrong{color:#f87171;background:rgba(248,113,113,.15);border-radius:2px}
.typing-current{border-left:2px solid var(--accent);animation:blink 1s infinite}
.typing-stats{display:flex;gap:1.5rem;justify-content:center;margin:1.2rem 0;flex-wrap:wrap}
.typing-stat{text-align:center;padding:.6rem 1rem;background:var(--bg);border:1px solid var(--border);border-radius:10px;min-width:100px}
.typing-stat .num{font-size:1.8rem;font-weight:800;color:var(--accent);font-variant-numeric:tabular-nums}
.typing-stat .lbl{font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;margin-top:.2rem}
.typing-result{border:2px solid var(--accent);border-radius:var(--radius);padding:1.5rem;text-align:center;background:linear-gradient(135deg,rgba(13,148,136,.04),rgba(217,119,6,.04));margin-top:1.2rem;animation:quoteFade .5s ease-out}
.typing-result h3{margin-bottom:1rem;color:var(--accent)}
.typing-result-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:1rem}
.typing-result-stat{text-align:center}
.typing-result-stat .big{font-size:2rem;font-weight:800;color:var(--accent)}
.typing-result-stat .small{font-size:.75rem;color:var(--muted);text-transform:uppercase}
.typing-textarea{width:100%;min-height:120px;font-family:'Consolas','Courier New',monospace;font-size:.95rem;line-height:2;padding:1rem;border:2px solid var(--border);border-radius:10px;background:var(--card);color:var(--text);resize:none;transition:border-color .2s}
.typing-textarea:focus{outline:none;border-color:var(--accent)}
.typing-textarea:disabled{opacity:.5;cursor:not-allowed}
.typing-history{margin-top:1.2rem}
.typing-history-row{display:grid;grid-template-columns:auto 1fr repeat(3,auto);gap:1rem;align-items:center;padding:.5rem .8rem;border-bottom:1px solid var(--border);font-size:.82rem}
.typing-history-row:first-child{font-weight:700;color:var(--muted);font-size:.72rem;text-transform:uppercase;letter-spacing:.5px}

/* Welcome Banner */
.welcome-banner{background:linear-gradient(135deg,rgba(13,148,136,.12),rgba(217,119,6,.08));border:1px solid rgba(13,148,136,.2);border-radius:var(--radius);padding:1.2rem 1.5rem;margin-bottom:1.2rem;display:flex;align-items:center;gap:1.2rem;animation:quoteFade .8s ease-out;overflow:hidden;position:relative}
.welcome-banner::before{content:'';position:absolute;top:-50%;right:-10%;width:200px;height:200px;background:radial-gradient(circle,rgba(13,148,136,.1) 0%,transparent 70%);border-radius:50%;pointer-events:none}
.welcome-avatar{font-size:2.5rem;flex-shrink:0}
.welcome-text{font-size:1.15rem;font-weight:700;color:var(--text);white-space:nowrap;overflow:hidden;border-right:3px solid var(--accent);padding-right:4px}
.welcome-text.done{border-right:none}
.welcome-subtitle{font-size:.85rem;color:var(--muted);margin-top:.3rem;opacity:0;animation:fadeInUp .5s ease-out forwards;animation-delay:.8s}
@keyframes fadeInUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>

<button class="mobile-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open')">â˜°</button>

<!-- Auth Overlay -->
<div class="auth-overlay" id="authOverlay">
  <div class="auth-box">
    <div class="auth-logo">
      <h1>ðŸš€ DevMaster Hub</h1>
      <p>Python &bull; SQL &bull; Golang</p>
    </div>
    <div class="auth-tabs">
      <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
      <button class="auth-tab" onclick="switchAuthTab('register')">Register</button>
    </div>
    <div class="auth-form active" id="loginForm">
      <div class="form-group">
        <label>Email / Username</label>
        <input type="text" id="loginEmail" placeholder="Enter your email...">
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="loginPassword" placeholder="Enter password...">
      </div>
      <button class="auth-btn" onclick="doLogin()">Login</button>
      <div class="auth-error" id="loginError"></div>
    </div>
    <div class="auth-form" id="registerForm">
      <div class="form-group">
        <label>Full Name</label>
        <input type="text" id="regName" placeholder="Your display name...">
      </div>
      <div class="form-group">
        <label>Email / Username</label>
        <input type="text" id="regEmail" placeholder="Choose an email...">
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="regPassword" placeholder="Min 4 characters...">
      </div>
      <div class="form-group">
        <label>Confirm Password</label>
        <input type="password" id="regConfirm" placeholder="Re-enter password...">
      </div>
      <button class="auth-btn" onclick="doRegister()">Create Account</button>
      <div class="auth-error" id="regError"></div>
      <div class="auth-success" id="regSuccess"></div>
    </div>
  </div>
</div>

<!-- Sidebar -->
<nav class="sidebar">
  <div class="sidebar-header">
    <h1>DevMaster Hub</h1>
    <small>Python â€¢ SQL â€¢ Golang</small>
  </div>
  <div class="sidebar-nav">
    <div class="nav-section">Home</div>
    <div class="nav-item active" data-panel="dashboard" onclick="switchPanel(this)"><span class="icon">ðŸ </span>Dashboard</div>
    <div class="nav-item" data-panel="schedule" onclick="switchPanel(this)"><span class="icon">ðŸ“…</span>30-Day Plan</div>
    <div class="nav-item" data-panel="progressmap" onclick="switchPanel(this)"><span class="icon">ðŸ—ºï¸</span>Progress Map</div>
    <div class="nav-section">Modules</div>
    <div class="nav-item" data-panel="python" onclick="switchPanel(this)"><span class="icon">ðŸ</span>Python</div>
    <div class="nav-item" data-panel="sql" onclick="switchPanel(this)"><span class="icon">ðŸ—„ï¸</span>SQL</div>
    <div class="nav-item" data-panel="golang" onclick="switchPanel(this)"><span class="icon">ðŸ”·</span>Golang</div>
    <div class="nav-section">Practice</div>
    <div class="nav-item" data-panel="playground" onclick="switchPanel(this)"><span class="icon">ðŸ’»</span>Code Playground</div>
    <div class="nav-item" data-panel="videos" onclick="switchPanel(this)"><span class="icon">ðŸŽ¬</span>Video Tutorials</div>
    <div class="nav-item" data-panel="flashcards" onclick="switchPanel(this)"><span class="icon">ðŸƒ</span>Flashcards</div>
    <div class="nav-item" data-panel="challenges" onclick="switchPanel(this)"><span class="icon">âš¡</span>Challenges</div>
    <div class="nav-item" data-panel="miniprojects" onclick="switchPanel(this)"><span class="icon">ðŸš€</span>Mini Projects</div>
    <div class="nav-item" data-panel="codeplayground" onclick="switchPanel(this)"><span class="icon">ðŸ’»</span>Live Playground</div>
    <div class="nav-item" data-panel="typing" onclick="switchPanel(this)"><span class="icon">âŒ¨ï¸</span>Typing Practice</div>
    <div class="nav-item" data-panel="codegame" onclick="switchPanel(this)"><span class="icon">ðŸŽ®</span>Code Game</div>
    <div class="nav-item" data-panel="debugex" onclick="switchPanel(this)"><span class="icon">ðŸž</span>Debug Challenge</div>
    <div class="nav-item" data-panel="fillblank" onclick="switchPanel(this)"><span class="icon">ðŸ“</span>Fill the Blank</div>
    <div class="nav-item" data-panel="codeorder" onclick="switchPanel(this)"><span class="icon">ðŸ”€</span>Code Order</div>
    <div class="nav-item" data-panel="peerchallenge" onclick="switchPanel(this)"><span class="icon">ðŸ¤</span>Peer Challenge</div>
    <div class="nav-item" data-panel="cheatsheets" onclick="switchPanel(this)"><span class="icon">ðŸ“‹</span>Cheat Sheets</div>
    <div class="nav-section">Reference</div>
    <div class="nav-item" data-panel="interview" onclick="switchPanel(this)"><span class="icon">ðŸŽ¤</span>Interview Prep</div>
    <div class="nav-item" data-panel="interviewquestions" onclick="switchPanel(this)"><span class="icon">ðŸ’¡</span>Interview Questions</div>
    <div class="nav-item" data-panel="learningpath" onclick="switchPanel(this)"><span class="icon">ðŸ§ </span>Learning Path</div>
    <div class="nav-item" data-panel="errors" onclick="switchPanel(this)"><span class="icon">ðŸ›</span>Error Dictionary</div>
    <div class="nav-item" data-panel="compare" onclick="switchPanel(this)"><span class="icon">âš–ï¸</span>Compare Languages</div>
    <div class="nav-item" data-panel="glossary" onclick="switchPanel(this)"><span class="icon">ðŸ“–</span>Glossary</div>
    <div class="nav-item" data-panel="prompts" onclick="switchPanel(this)"><span class="icon">ðŸ¤–</span>AI Prompts</div>
    <div class="nav-section">Tools</div>
    <div class="nav-item" data-panel="chatbot" onclick="switchPanel(this)"><span class="icon">ðŸ’¬</span>AI Chatbot</div>
    <div class="nav-item" data-panel="pomodoro" onclick="switchPanel(this)"><span class="icon">ðŸ…</span>Pomodoro Timer</div>
    <div class="nav-item" data-panel="goals" onclick="switchPanel(this)"><span class="icon">ðŸŽ¯</span>Weekly Goals</div>
    <div class="nav-item" data-panel="streaktracker" onclick="switchPanel(this)"><span class="icon">ðŸ”¥</span>Streak Tracker</div>
    <div class="nav-item" data-panel="leaderboards" onclick="switchPanel(this)"><span class="icon">ðŸ…</span>Leaderboards</div>
    <div class="nav-item" data-panel="analytics" onclick="switchPanel(this)"><span class="icon">ðŸ“ˆ</span>Analytics</div>
    <div class="nav-item" data-panel="scores" onclick="switchPanel(this)"><span class="icon">ðŸ†</span>Scores</div>
    <div class="nav-item" data-panel="certificate" onclick="switchPanel(this)"><span class="icon">ðŸ“œ</span>Certificate</div>
    <div class="nav-item" data-panel="notes" onclick="switchPanel(this)"><span class="icon">ðŸ“</span>Notes & Books</div>
    <div class="nav-item" data-panel="userguide" onclick="switchPanel(this)"><span class="icon">ðŸ“–</span>User Guide</div>
    <div class="nav-item" data-panel="typingtest" onclick="switchPanel(this)"><span class="icon">âŒ¨ï¸</span>Typing Speed Test</div>
    <div class="nav-item" data-panel="community" onclick="switchPanel(this)"><span class="icon">ðŸŒ</span>Community</div>
    <div class="nav-item" data-panel="report" onclick="switchPanel(this)"><span class="icon">ðŸ“Š</span>Progress Report</div>
  </div>
  <div class="sidebar-footer" style="flex-direction:column;gap:.4rem">
    <div style="display:flex;gap:.4rem">
      <button onclick="toggleDark()" style="flex:1">ðŸŒ™ Dark</button>
      <button onclick="exportAllData()" style="flex:1">ðŸ’¾ Export</button>
    </div>
    <div class="theme-picker" style="display:flex;gap:.3rem;justify-content:center">
      <button onclick="setTheme('')" class="theme-dot" title="Teal" style="background:linear-gradient(135deg,#0d9488,#0f766e);width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s"></button>
      <button onclick="setTheme('theme-purple')" class="theme-dot" title="Purple Galaxy" style="background:linear-gradient(135deg,#7c3aed,#ec4899);width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s"></button>
      <button onclick="setTheme('theme-sunset')" class="theme-dot" title="Sunset" style="background:linear-gradient(135deg,#ea580c,#e11d48);width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s"></button>
      <button onclick="setTheme('theme-ocean')" class="theme-dot" title="Ocean Blue" style="background:linear-gradient(135deg,#2563eb,#06b6d4);width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s"></button>
      <button onclick="setTheme('theme-forest')" class="theme-dot" title="Forest" style="background:linear-gradient(135deg,#16a34a,#84cc16);width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s"></button>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="main-content">
  <div class="topbar">
    <h2 id="topbarTitle">Dashboard</h2>
    <div class="user-select">
      <label>User:</label>
      <select id="currentUser" onchange="onUserSwitch()"></select>
      <button class="btn btn-sm btn-outline" onclick="openAddUserModal()">+ Add</button>
      <button class="btn btn-sm btn-danger" onclick="deleteCurrentUser()">- Remove</button>
      <button class="btn btn-sm btn-outline" onclick="doLogout()" title="Logout">ðŸšª Logout</button>
    </div>
  </div>

  <div class="content">

    <!-- ======================== DASHBOARD PANEL ======================== -->
    <div id="dashboard" class="panel active">
      <div id="welcomeBanner" class="welcome-banner" style="display:none">
        <div class="welcome-avatar">ðŸ‘‹</div>
        <div>
          <div class="welcome-text" id="welcomeText"></div>
          <div class="welcome-subtitle" id="welcomeSubtitle"></div>
        </div>
      </div>
      <div class="dash-stats" style="grid-template-columns:repeat(5,1fr)">
        <div class="dash-stat-card"><div class="icon">âš¡</div><div class="val" id="dashXP">0</div><div class="lbl">Total XP</div></div>
        <div class="dash-stat-card"><div class="icon">ðŸ”¥</div><div class="val" id="dashStreak">0</div><div class="lbl">Day Streak</div></div>
        <div class="dash-stat-card"><div class="icon">ðŸŽ¯</div><div class="val" id="dashQuizzes">0</div><div class="lbl">Quiz Score</div></div>
        <div class="dash-stat-card"><div class="icon">ðŸ…</div><div class="val" id="dashBadges">0</div><div class="lbl">Badges</div></div>
        <div class="dash-stat-card"><div class="icon">ðŸ“š</div><div class="val" id="dashConceptPct">0%</div><div class="lbl">Concepts Done</div></div>
      </div>
      <!-- Daily Tip -->
      <div class="daily-tip-card" id="dailyTipCard"></div>
      <!-- Study Timer -->
      <div class="card" style="margin-bottom:1.2rem">
        <h3>â±ï¸ Study Time Today</h3>
        <div class="study-timer-bar" id="studyTimerBar"></div>
        <div class="study-timer-active" id="studyTimerActive" style="display:none">
          <span class="st-pulse"></span>
          <span>Tracking: <strong id="stActiveLang">-</strong></span>
          <span id="stActiveTime">0:00</span>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.2rem">
        <div class="card">
          <h3>Level & XP</h3>
          <div style="display:flex;align-items:center;gap:1rem;margin-bottom:.8rem">
            <div class="level-badge" id="dashLevel">1</div>
            <div style="flex:1">
              <div style="font-weight:600;margin-bottom:.3rem">Level <span id="dashLevelText">1</span> â€” <span id="dashLevelTitle">Beginner</span></div>
              <div class="xp-bar-outer"><div class="xp-bar-fill" id="dashXPBar" style="width:0%"></div><div class="xp-bar-text" id="dashXPBarText">0 / 100 XP</div></div>
            </div>
          </div>
        </div>
        <div class="card">
          <h3>ðŸ”¥ Daily Streak</h3>
          <div style="display:flex;align-items:center;gap:1rem;margin-bottom:.6rem">
            <div style="font-size:2.5rem">ðŸ”¥</div>
            <div><span id="streakCount" style="font-size:2rem;font-weight:800;color:var(--warn)">0</span><span style="color:var(--muted);font-size:.85rem"> days</span></div>
          </div>
          <div style="display:flex;align-items:center;gap:.6rem;margin-bottom:.6rem;flex-wrap:wrap">
            <label style="font-size:.82rem;font-weight:600;color:var(--muted)">Streak started on:</label>
            <input type="date" id="streakStartDate" onchange="setStreakStart(this.value)" style="padding:.3rem .5rem;border:1.5px solid var(--border);border-radius:8px;font-size:.82rem;background:var(--card);color:var(--text)">
            <button class="btn btn-sm btn-outline" onclick="resetStreakStart()" title="Reset to first login date">Reset</button>
          </div>
          <div class="streak-cal" id="streakCal"></div>
          <div class="streak-milestones" id="streakMilestones"></div>
        </div>
      </div>
      <div class="card">
        <h3>ðŸ… Achievements</h3>
        <div class="badge-grid" id="badgeGrid"></div>
      </div>
      <div class="card">
        <h3>ðŸ† Leaderboard</h3>
        <div id="leaderboard"></div>
      </div>
    </div>

    <!-- ======================== SCHEDULE PANEL ======================== -->
    <div id="schedule" class="panel">
      <div class="card">
        <h3>ðŸ“… 30-Day Learning Plan</h3>
        <div style="display:flex;gap:.6rem;align-items:center;margin-bottom:1rem">
          <span style="font-size:.85rem;color:var(--muted)">You are on</span>
          <select id="currentDaySelect" onchange="renderSchedule()" style="width:auto;padding:.3rem .6rem"></select>
        </div>
        <div id="scheduleList"></div>
      </div>
      <div class="card">
        <h3>Today's Timetable</h3>
        <div id="todayTimetable"></div>
      </div>
    </div>

    <!-- ======================== PYTHON PANEL ======================== -->
    <div id="python" class="panel">
      <div class="tabs">
        <button class="tab active" onclick="switchTab(this,'python')">Concepts</button>
        <button class="tab" onclick="switchTab(this,'python')">Cheat Sheet</button>
        <button class="tab" onclick="switchTab(this,'python')">Resources</button>
        <button class="tab" onclick="switchTab(this,'python')">Quiz</button>
        <button class="tab" onclick="switchTab(this,'python')">Exercises</button>
      </div>

      <!-- Python Concepts -->
      <div class="tab-panel active" data-module="python" data-tab="Concepts">
        <div class="concept-list" id="pythonConcepts"></div>
      </div>

      <!-- Python Cheat Sheet -->
      <div class="tab-panel" data-module="python" data-tab="Cheat Sheet">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <h3>Python Quick Reference</h3>
          <button class="download-btn" onclick="downloadCheatSheet('python')">â¬‡ Download Cheat Sheet</button>
        </div>
        <div id="pythonCheatSheet"></div>
      </div>

      <!-- Python Resources -->
      <div class="tab-panel" data-module="python" data-tab="Resources">
        <div class="links-grid" id="pythonResources"></div>
      </div>

      <!-- Python Quiz -->
      <div class="tab-panel" data-module="python" data-tab="Quiz">
        <div class="quiz-score-bar">
          <div class="score-num" id="pythonQuizScore">0</div>
          <div><strong>Score</strong><br><span style="font-size:.82rem;color:var(--muted)" id="pythonQuizProgress">0 / 15 answered</span></div>
          <div style="margin-left:auto"><button class="btn btn-outline btn-sm" onclick="resetQuiz('python')">Reset Quiz</button></div>
        </div>
        <div id="pythonQuiz"></div>
      </div>

      <!-- Python Exercises -->
      <div class="tab-panel" data-module="python" data-tab="Exercises">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <h3>Daily Practice Exercises</h3>
          <button class="download-btn" onclick="downloadExercises('python')">â¬‡ Download Sheet</button>
        </div>
        <div id="pythonExercises"></div>
      </div>
    </div>

    <!-- ======================== SQL PANEL ======================== -->
    <div id="sql" class="panel">
      <div class="tabs">
        <button class="tab active" onclick="switchTab(this,'sql')">Concepts</button>
        <button class="tab" onclick="switchTab(this,'sql')">Cheat Sheet</button>
        <button class="tab" onclick="switchTab(this,'sql')">Resources</button>
        <button class="tab" onclick="switchTab(this,'sql')">Quiz</button>
        <button class="tab" onclick="switchTab(this,'sql')">Exercises</button>
      </div>
      <div class="tab-panel active" data-module="sql" data-tab="Concepts"><div class="concept-list" id="sqlConcepts"></div></div>
      <div class="tab-panel" data-module="sql" data-tab="Cheat Sheet">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <h3>SQL Quick Reference</h3>
          <button class="download-btn" onclick="downloadCheatSheet('sql')">â¬‡ Download Cheat Sheet</button>
        </div>
        <div id="sqlCheatSheet"></div>
      </div>
      <div class="tab-panel" data-module="sql" data-tab="Resources"><div class="links-grid" id="sqlResources"></div></div>
      <div class="tab-panel" data-module="sql" data-tab="Quiz">
        <div class="quiz-score-bar">
          <div class="score-num" id="sqlQuizScore">0</div>
          <div><strong>Score</strong><br><span style="font-size:.82rem;color:var(--muted)" id="sqlQuizProgress">0 / 15 answered</span></div>
          <div style="margin-left:auto"><button class="btn btn-outline btn-sm" onclick="resetQuiz('sql')">Reset Quiz</button></div>
        </div>
        <div id="sqlQuiz"></div>
      </div>
      <div class="tab-panel" data-module="sql" data-tab="Exercises">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <h3>Daily Practice Exercises</h3>
          <button class="download-btn" onclick="downloadExercises('sql')">â¬‡ Download Sheet</button>
        </div>
        <div id="sqlExercises"></div>
      </div>
    </div>

    <!-- ======================== GOLANG PANEL ======================== -->
    <div id="golang" class="panel">
      <div class="tabs">
        <button class="tab active" onclick="switchTab(this,'golang')">Concepts</button>
        <button class="tab" onclick="switchTab(this,'golang')">Cheat Sheet</button>
        <button class="tab" onclick="switchTab(this,'golang')">Resources</button>
        <button class="tab" onclick="switchTab(this,'golang')">Quiz</button>
        <button class="tab" onclick="switchTab(this,'golang')">Exercises</button>
      </div>
      <div class="tab-panel active" data-module="golang" data-tab="Concepts"><div class="concept-list" id="golangConcepts"></div></div>
      <div class="tab-panel" data-module="golang" data-tab="Cheat Sheet">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <h3>Golang Quick Reference</h3>
          <button class="download-btn" onclick="downloadCheatSheet('golang')">â¬‡ Download Cheat Sheet</button>
        </div>
        <div id="golangCheatSheet"></div>
      </div>
      <div class="tab-panel" data-module="golang" data-tab="Resources"><div class="links-grid" id="golangResources"></div></div>
      <div class="tab-panel" data-module="golang" data-tab="Quiz">
        <div class="quiz-score-bar">
          <div class="score-num" id="golangQuizScore">0</div>
          <div><strong>Score</strong><br><span style="font-size:.82rem;color:var(--muted)" id="golangQuizProgress">0 / 15 answered</span></div>
          <div style="margin-left:auto"><button class="btn btn-outline btn-sm" onclick="resetQuiz('golang')">Reset Quiz</button></div>
        </div>
        <div id="golangQuiz"></div>
      </div>
      <div class="tab-panel" data-module="golang" data-tab="Exercises">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <h3>Daily Practice Exercises</h3>
          <button class="download-btn" onclick="downloadExercises('golang')">â¬‡ Download Sheet</button>
        </div>
        <div id="golangExercises"></div>
      </div>
    </div>

    <!-- ======================== CODE PLAYGROUND ======================== -->
    <div id="playground" class="panel">
      <div class="card">
        <h3>ðŸ’» Code Playground</h3>
        <div class="pg-bar">
          <select id="pgLang" onchange="loadPgTemplate()" style="width:auto;padding:.35rem .6rem">
            <option value="python">Python</option><option value="sql">SQL</option><option value="golang">Go</option>
          </select>
          <button class="btn btn-primary btn-sm" onclick="runPlayground()">â–¶ Run</button>
          <button class="btn btn-outline btn-sm" onclick="clearPg()">Clear</button>
          <button class="btn btn-outline btn-sm" onclick="loadPgTemplate()">Reset Template</button>
          <span style="font-size:.78rem;color:var(--muted);margin-left:auto">Python runs in browser | SQL/Go show expected output</span>
        </div>
        <div class="pg-editor">
          <textarea class="pg-code" id="pgCode" spellcheck="false" placeholder="Write your code here..."></textarea>
          <div class="pg-output" id="pgOutput">Output will appear here...</div>
        </div>
      </div>
    </div>

    <!-- ======================== TYPING PRACTICE ======================== -->
    <div id="typing" class="panel">
      <div class="card">
        <h3>âŒ¨ï¸ Code Typing Practice</h3>
        <div class="pg-bar">
          <select id="typeLang" onchange="initTyping()" style="width:auto;padding:.35rem .6rem">
            <option value="python">Python</option><option value="sql">SQL</option><option value="golang">Go</option>
          </select>
          <button class="btn btn-primary btn-sm" onclick="initTyping()">New Snippet</button>
          <button class="btn btn-outline btn-sm" onclick="resetTyping()">Reset</button>
        </div>
        <div class="type-stats">
          <div class="type-stat"><div class="num" id="typeWPM">0</div><div class="lbl">WPM</div></div>
          <div class="type-stat"><div class="num" id="typeAcc">0%</div><div class="lbl">Accuracy</div></div>
          <div class="type-stat"><div class="num" id="typeTime">0s</div><div class="lbl">Time</div></div>
        </div>
        <div class="type-area" id="typeArea" tabindex="0"></div>
        <p style="font-size:.8rem;color:var(--muted);margin-top:.5rem;text-align:center">Click the box above and start typing. Match the code exactly!</p>
      </div>
    </div>

    <!-- ======================== INTERVIEW PREP ======================== -->
    <div id="interview" class="panel">
      <div class="card">
        <h3>ðŸŽ¤ Interview Prep</h3>
        <div class="tabs">
          <button class="tab active" onclick="switchTab(this,'interview')">Python</button>
          <button class="tab" onclick="switchTab(this,'interview')">SQL</button>
          <button class="tab" onclick="switchTab(this,'interview')">Golang</button>
        </div>
        <div class="tab-panel active" data-module="interview" data-tab="Python"><div id="interviewPython"></div></div>
        <div class="tab-panel" data-module="interview" data-tab="SQL"><div id="interviewSql"></div></div>
        <div class="tab-panel" data-module="interview" data-tab="Golang"><div id="interviewGolang"></div></div>
      </div>
    </div>

    <!-- ======================== ERROR DICTIONARY ======================== -->
    <div id="errors" class="panel">
      <div class="card">
        <h3>ðŸ› Common Errors & Fixes</h3>
        <div class="tabs">
          <button class="tab active" onclick="switchTab(this,'errors')">Python</button>
          <button class="tab" onclick="switchTab(this,'errors')">SQL</button>
          <button class="tab" onclick="switchTab(this,'errors')">Golang</button>
        </div>
        <div class="tab-panel active" data-module="errors" data-tab="Python"><div id="errorsPython"></div></div>
        <div class="tab-panel" data-module="errors" data-tab="SQL"><div id="errorsSql"></div></div>
        <div class="tab-panel" data-module="errors" data-tab="Golang"><div id="errorsGolang"></div></div>
      </div>
    </div>

    <!-- ======================== COMPARE LANGUAGES ======================== -->
    <div id="compare" class="panel">
      <div class="card">
        <h3>âš–ï¸ Python vs SQL vs Golang â€” Side by Side</h3>
        <div id="compareTable"></div>
      </div>
    </div>

    <!-- ======================== GLOSSARY ======================== -->
    <div id="glossary" class="panel">
      <div class="card">
        <h3>ðŸ“– Coding Glossary</h3>
        <input type="text" id="glossarySearch" placeholder="Search terms..." oninput="renderGlossary()" style="margin-bottom:1rem">
        <dl class="glossary-list" id="glossaryList"></dl>
      </div>
    </div>

    <!-- ======================== AI PROMPTS ======================== -->
    <div id="prompts" class="panel">
      <div class="card">
        <h3>ðŸ¤– AI Prompt Library</h3>
        <p style="font-size:.85rem;color:var(--muted);margin-bottom:1rem">Ready-made prompts to ask Claude or ChatGPT. Click to copy!</p>
        <div class="tabs">
          <button class="tab active" onclick="switchTab(this,'prompts')">Python</button>
          <button class="tab" onclick="switchTab(this,'prompts')">SQL</button>
          <button class="tab" onclick="switchTab(this,'prompts')">Golang</button>
          <button class="tab" onclick="switchTab(this,'prompts')">General</button>
        </div>
        <div class="tab-panel active" data-module="prompts" data-tab="Python"><div id="promptsPython"></div></div>
        <div class="tab-panel" data-module="prompts" data-tab="SQL"><div id="promptsSql"></div></div>
        <div class="tab-panel" data-module="prompts" data-tab="Golang"><div id="promptsGolang"></div></div>
        <div class="tab-panel" data-module="prompts" data-tab="General"><div id="promptsGeneral"></div></div>
      </div>
    </div>

    <!-- ======================== POMODORO ======================== -->
    <div id="pomodoro" class="panel">
      <div class="card">
        <div class="pomo-label" id="pomoLabel">Focus Time</div>
        <div class="pomo-display" id="pomoDisplay">25:00</div>
        <div class="pomo-controls">
          <button class="btn btn-primary" id="pomoStartBtn" onclick="togglePomo()">Start</button>
          <button class="btn btn-danger" onclick="resetPomo()">Reset</button>
        </div>
        <div style="text-align:center">
          <span id="pomoSessions" style="font-size:.88rem;color:var(--muted)">Sessions: 0</span>
          <div class="pomo-sessions" id="pomoDots"></div>
        </div>
        <div style="display:flex;gap:1.5rem;justify-content:center;margin-top:1.2rem">
          <div style="text-align:center"><label style="font-size:.72rem;color:var(--muted);font-weight:600">FOCUS</label><input type="number" id="pomoFocus" value="25" min="1" max="120" style="width:65px;text-align:center;padding:.3rem" onchange="resetPomo()"></div>
          <div style="text-align:center"><label style="font-size:.72rem;color:var(--muted);font-weight:600">BREAK</label><input type="number" id="pomoBreak" value="5" min="1" max="30" style="width:65px;text-align:center;padding:.3rem"></div>
          <div style="text-align:center"><label style="font-size:.72rem;color:var(--muted);font-weight:600">LONG BREAK</label><input type="number" id="pomoLong" value="15" min="1" max="60" style="width:65px;text-align:center;padding:.3rem"></div>
        </div>
      </div>
    </div>

    <!-- ======================== WEEKLY GOALS ======================== -->
    <div id="goals" class="panel">
      <div class="card">
        <h3>ðŸŽ¯ Weekly Goals</h3>
        <div style="display:flex;gap:.5rem;margin-bottom:1rem">
          <input type="text" id="goalInput" placeholder="Add a goal (e.g., Complete 5 Python exercises)">
          <button class="btn btn-primary" onclick="addGoal()">Add</button>
        </div>
        <div id="goalsList"></div>
        <div style="margin-top:1rem;display:flex;justify-content:space-between;align-items:center">
          <span style="font-size:.85rem;color:var(--muted)" id="goalsProgress">0 / 0 completed</span>
          <button class="btn btn-outline btn-sm" onclick="clearCompletedGoals()">Clear Done</button>
        </div>
      </div>
    </div>

    <!-- ======================== CERTIFICATE ======================== -->
    <div id="certificate" class="panel">
      <div class="card">
        <h3>ðŸ“œ Completion Certificate</h3>
        <p style="font-size:.85rem;color:var(--muted);margin-bottom:1rem">Generate a certificate based on your progress. Complete quizzes and exercises to fill it up!</p>
        <div class="cert-preview" id="certPreview"></div>
        <div style="text-align:center;margin-top:1rem">
          <button class="btn btn-primary btn-lg" onclick="downloadCertificate()">â¬‡ Download Certificate</button>
        </div>
      </div>
    </div>

    <!-- ======================== USER GUIDE ======================== -->
    <div id="userguide" class="panel">
      <div class="card">
        <h3>ðŸ“– User Manual & Guide</h3>
        <p style="font-size:.9rem;color:var(--muted);margin-bottom:1.5rem">Learn how to use every feature in DevMaster Hub</p>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem">
          <!-- LEFT COLUMN -->
          <div>
            <h4 style="color:var(--accent);margin-bottom:.8rem">ðŸ“š Learning Modules</h4>
            <div style="background:var(--bg);padding:1rem;border-radius:10px;margin-bottom:1rem">
              <strong>Python, SQL, Golang</strong><br>
              <span style="font-size:.85rem;color:var(--muted);line-height:1.5">Click on any language to access concepts, quizzes, exercises, and daily 14-day practice plans. Each has 10+ concepts with code examples.</span>
            </div>

            <h4 style="color:var(--accent);margin-bottom:.8rem">ðŸŽ¯ Practice & Challenges</h4>
            <div style="background:var(--bg);padding:1rem;border-radius:10px;margin-bottom:1rem">
              <strong>â€¢ Flashcards</strong> - Flip cards to learn concepts<br>
              <strong>â€¢ Challenges</strong> - Timed coding problems<br>
              <strong>â€¢ Mini Projects</strong> - Build 15 real projects<br>
              <strong>â€¢ Quiz Game</strong> - Guess code output<br>
              <strong>â€¢ Debug Challenge</strong> - Fix buggy code<br>
              <span style="font-size:.82rem;color:var(--muted)">Each activity earns XP!</span>
            </div>

            <h4 style="color:var(--accent);margin-bottom:.8rem">ðŸ“Š Progress Tracking</h4>
            <div style="background:var(--bg);padding:1rem;border-radius:10px">
              <strong>â€¢ Dashboard</strong> - Daily overview<br>
              <strong>â€¢ Progress Map</strong> - Visual journey<br>
              <strong>â€¢ Scores</strong> - Quiz & practice results<br>
              <strong>â€¢ Report</strong> - Download progress PDF<br>
              <span style="font-size:.82rem;color:var(--muted)">Toggle users to compare scores!</span>
            </div>
          </div>

          <!-- RIGHT COLUMN -->
          <div>
            <h4 style="color:var(--accent);margin-bottom:.8rem">ðŸŽ“ Reference & Resources</h4>
            <div style="background:var(--bg);padding:1rem;border-radius:10px;margin-bottom:1rem">
              <strong>â€¢ Cheat Sheets</strong> - Quick syntax reference<br>
              <strong>â€¢ Video Tutorials</strong> - 50+ curated videos<br>
              <strong>â€¢ Books & Resources</strong> - 15+ free/paid books<br>
              <strong>â€¢ Error Dictionary</strong> - Understand errors<br>
              <strong>â€¢ Interview Prep</strong> - Common questions<br>
              <strong>â€¢ Glossary</strong> - Programming terms
            </div>

            <h4 style="color:var(--accent);margin-bottom:.8rem">âš™ï¸ Tools & Features</h4>
            <div style="background:var(--bg);padding:1rem;border-radius:10px;margin-bottom:1rem">
              <strong>â€¢ Code Playground</strong> - Online editor & compiler<br>
              <strong>â€¢ Typing Practice</strong> - Improve typing speed<br>
              <strong>â€¢ Notes</strong> - Save personal notes<br>
              <strong>â€¢ Pomodoro Timer</strong> - 25 min focus sessions<br>
              <strong>â€¢ Badges & Achievements</strong> - Unlock rewards!
            </div>

            <h4 style="color:var(--accent);margin-bottom:.8rem">ðŸ’¡ Pro Tips</h4>
            <div style="background:#fef7e0;padding:1rem;border-radius:10px;color:#744210;font-size:.85rem;line-height:1.6">
              âœ“ Complete at least 1 concept daily<br>
              âœ“ Do the exercises in order (easyâ†’hard)<br>
              âœ“ Build mini projects for portfolio<br>
              âœ“ Use dark mode for late-night study<br>
              âœ“ Track your streaks for motivation
            </div>
          </div>
        </div>

        <!-- DETAILED GUIDE -->
        <div style="margin-top:2rem;padding-top:2rem;border-top:2px solid var(--border)">
          <h4 style="color:var(--accent);margin-bottom:1rem">ðŸ—ºï¸ Navigation Map</h4>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;font-size:.85rem">
            <div style="background:rgba(13,148,136,.05);padding:1rem;border-radius:8px">
              <strong style="color:#0d9488">LEARN ðŸŽ“</strong><br><br>
              1. Pick a language<br>
              2. Read concepts<br>
              3. Watch videos<br>
              4. Take quizzes<br>
              5. Do exercises<br>
              6. Build projects
            </div>
            <div style="background:rgba(217,119,6,.05);padding:1rem;border-radius:8px">
              <strong style="color:#d97706">PRACTICE ðŸ’ª</strong><br><br>
              1. Challenges (timed)<br>
              2. Code Game<br>
              3. Debug exercises<br>
              4. Mini Projects<br>
              5. Flashcards<br>
              6. Peer Challenge
            </div>
            <div style="background:rgba(46,196,182,.05);padding:1rem;border-radius:8px">
              <strong style="color:#2ec4b6">TRACK ðŸ“ˆ</strong><br><br>
              1. Check Dashboard<br>
              2. View Progress Map<br>
              3. See Quiz Scores<br>
              4. Unlock Badges<br>
              5. Review Report<br>
              6. Compare with peers
            </div>
          </div>
        </div>

        <!-- FAQ -->
        <div style="margin-top:2rem;padding-top:2rem;border-top:2px solid var(--border)">
          <h4 style="color:var(--accent);margin-bottom:1rem">â“ Frequently Asked Questions</h4>
          <div style="display:grid;gap:.8rem">
            <details style="background:var(--bg);padding:1rem;border-radius:8px;cursor:pointer">
              <summary style="font-weight:600;color:var(--accent)">How do I gain XP?</summary>
              <div style="margin-top:.5rem;color:var(--muted);font-size:.9rem">
                Complete any learning activity: concepts (+15 XP), quizzes (+varies), challenges (+50 XP), mini projects (+100-250 XP), debug exercises (+20 XP), and more!
              </div>
            </details>
            <details style="background:var(--bg);padding:1rem;border-radius:8px;cursor:pointer">
              <summary style="font-weight:600;color:var(--accent)">What's a Streak?</summary>
              <div style="margin-top:.5rem;color:var(--muted);font-size:.9rem">
                Your current streak is how many days in a row you've studied. Build streaks to unlock themed color schemes for your profile!
              </div>
            </details>
            <details style="background:var(--bg);padding:1rem;border-radius:8px;cursor:pointer">
              <summary style="font-weight:600;color:var(--accent)">Can I compare my progress with friends?</summary>
              <div style="margin-top:.5rem;color:var(--muted);font-size:.9rem">
                Yes! Add more users with the "+ Add Person" button, then view their scores on the Scores & Compare page. See who's leading!
              </div>
            </details>
            <details style="background:var(--bg);padding:1rem;border-radius:8px;cursor:pointer">
              <summary style="font-weight:600;color:var(--accent)">How do I reset my progress?</summary>
              <div style="margin-top:.5rem;color:var(--muted);font-size:.9rem">
                Clear browser LocalStorage (F12 â†’ Application â†’ LocalStorage â†’ Clear), or manually delete the user by switching to them and clicking delete.
              </div>
            </details>
            <details style="background:var(--bg);padding:1rem;border-radius:8px;cursor:pointer">
              <summary style="font-weight:600;color:var(--accent)">What's the best way to learn?</summary>
              <div style="margin-top:.5rem;color:var(--muted);font-size:.9rem">
                1) Master concepts first (10-15 min), 2) Take the quiz (5 min), 3) Do exercises (30-45 min), 4) Build mini projects (2-4 hours each).
              </div>
            </details>
          </div>
        </div>
      </div>
    </div>

    <!-- ======================== COMMUNITY ======================== -->
    <div id="community" class="panel">
      <div class="card">
        <h3>ðŸŒ Community & Help</h3>
        <div class="comm-grid" id="communityGrid"></div>
      </div>
    </div>

    <!-- ======================== VIDEO TUTORIALS PANEL ======================== -->
    <div id="videos" class="panel">
      <div class="card">
        <h3>ðŸŽ¬ Video Tutorials</h3>
        <p style="font-size:.85rem;color:var(--muted);margin-bottom:1rem">Curated video tutorials for Python, SQL, and Golang. Click any video to watch.</p>
        <div class="video-filter-bar">
          <button class="vf-btn active" onclick="filterVideos('all',this)">All</button>
          <button class="vf-btn" onclick="filterVideos('python',this)">ðŸ Python</button>
          <button class="vf-btn" onclick="filterVideos('sql',this)">ðŸ—„ï¸ SQL</button>
          <button class="vf-btn" onclick="filterVideos('golang',this)">ðŸ”· Golang</button>
          <button class="vf-btn" onclick="filterVideos('general',this)">ðŸ“š General</button>
          <button class="vf-btn" onclick="filterVideos('beginner',this)">Beginner</button>
          <button class="vf-btn" onclick="filterVideos('project',this)">Projects</button>
        </div>
        <div class="video-grid" id="videoGrid"></div>
      </div>
    </div>

    <!-- Video Player Modal -->
    <div class="video-modal" id="videoModal" onclick="if(event.target===this)closeVideo()">
      <button class="video-modal-close" onclick="closeVideo()">âœ•</button>
      <div class="video-modal-inner">
        <iframe id="videoFrame" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        <div style="padding:1rem">
          <h3 id="videoModalTitle" style="margin-bottom:.3rem"></h3>
          <p id="videoModalDesc" style="font-size:.85rem;color:var(--muted)"></p>
        </div>
      </div>
    </div>

    <!-- ======================== FLASHCARDS PANEL ======================== -->
    <div id="flashcards" class="panel">
      <div class="card">
        <h3>ðŸƒ Flashcards</h3>
        <div class="fc-container">
          <div class="fc-deck-select" id="fcDeckSelect"></div>
          <div class="fc-progress" id="fcProgress">Card 1 of 15</div>
          <div class="fc-card-wrap" onclick="flipCard()">
            <div class="fc-card" id="fcCard">
              <div class="fc-face fc-front" id="fcFront">Question</div>
              <div class="fc-face fc-back" id="fcBack">Answer</div>
            </div>
          </div>
          <div class="fc-mastery">
            <button class="btn btn-danger btn-sm" onclick="markCard('review')">Need Review</button>
            <button class="btn btn-success btn-sm" onclick="markCard('got')">Got It!</button>
          </div>
          <div class="fc-nav">
            <button class="btn btn-outline btn-sm" onclick="prevCard()">â† Prev</button>
            <button class="btn btn-outline btn-sm" onclick="shuffleCards()">ðŸ”€ Shuffle</button>
            <button class="btn btn-outline btn-sm" onclick="nextCard()">Next â†’</button>
          </div>
          <div style="margin-top:.6rem;font-size:.82rem;color:var(--muted)">Mastery: <strong id="fcMastery">0%</strong> | Reviewed: <strong id="fcReviewed">0</strong></div>
        </div>
      </div>
    </div>

    <!-- ======================== CHALLENGES PANEL ======================== -->
    <div id="challenges" class="panel">
      <div class="card">
        <h3>âš¡ Coding Challenges</h3>
        <p style="font-size:.85rem;color:var(--muted);margin-bottom:1rem">Timed coding challenges. Start the timer, write your solution, and submit before time runs out! Earn XP for completing challenges.</p>
        <div id="challengesList"></div>
      </div>
    </div>

    <!-- ======================== MINI PROJECTS PANEL ======================== -->
    <div id="miniprojects" class="panel">
      <div class="card">
        <h3>ðŸš€ Mini Projects</h3>
        <p style="font-size:.85rem;color:var(--muted);margin-bottom:1rem">Build real projects with clear objectives, starter code, and step-by-step guidance. Perfect for portfolio building!</p>
        <div style="display:flex;gap:.5rem;margin-bottom:1.2rem">
          <button class="btn btn-sm btn-primary" onclick="filterMiniProjects('all')">All Projects</button>
          <button class="btn btn-sm btn-outline" onclick="filterMiniProjects('python')">ðŸ Python</button>
          <button class="btn btn-sm btn-outline" onclick="filterMiniProjects('sql')">ðŸ—„ï¸ SQL</button>
          <button class="btn btn-sm btn-outline" onclick="filterMiniProjects('golang')">ðŸ”· Golang</button>
        </div>
        <div class="project-grid" id="miniProjectsGrid"></div>
      </div>
    </div>

    <!-- Mini Project Detail Modal -->
    <div class="project-modal" id="projectModal" onclick="if(event.target===this)closeProjectModal()">
      <div class="project-modal-content">
        <button class="project-modal-close" onclick="closeProjectModal()">âœ•</button>
        <h3 id="projectModalTitle"></h3>
        <p id="projectModalDesc" style="font-size:.9rem;color:var(--muted);line-height:1.6"></p>
        
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:.8rem;margin:1rem 0;padding:1rem;background:var(--bg);border-radius:8px">
          <div style="text-align:center">
            <div style="font-size:1.5rem;font-weight:800;color:var(--accent)" id="projectModalDiff"></div>
            <div style="font-size:.75rem;color:var(--muted);text-transform:uppercase">Difficulty</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:1.5rem;font-weight:800;color:var(--accent)" id="projectModalXP"></div>
            <div style="font-size:.75rem;color:var(--muted);text-transform:uppercase">XP Reward</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:1.5rem;font-weight:800;color:var(--accent)" id="projectModalTime"></div>
            <div style="font-size:.75rem;color:var(--muted);text-transform:uppercase">Est. Time</div>
          </div>
        </div>

        <h4 style="margin-top:1.2rem;margin-bottom:.6rem">ðŸ“‹ Tasks</h4>
        <div class="project-tasks" id="projectModalTasks"></div>

        <h4 style="margin-top:1.2rem;margin-bottom:.6rem">ðŸ’¡ Learning Objectives</h4>
        <div id="projectModalObjectives" style="background:var(--bg);padding:1rem;border-radius:8px;font-size:.9rem;line-height:1.6"></div>

        <h4 style="margin-top:1.2rem;margin-bottom:.6rem">ðŸŽ¯ Starter Code</h4>
        <div id="projectModalStarterCode" class="project-starter-code"></div>

        <h4 style="margin-top:1.2rem;margin-bottom:.6rem">ðŸ“ Expected Output</h4>
        <div id="projectModalOutput" class="project-starter-code" style="background:#f5f7fa;color:#0f172a"></div>

        <h4 style="margin-top:1.2rem;margin-bottom:.6rem">ðŸ’¬ Tips & Hints</h4>
        <div id="projectModalHints" style="background:rgba(46,196,182,.08);padding:1rem;border-radius:8px;font-size:.9rem;line-height:1.6;color:var(--success)"></div>

        <div class="project-modal-buttons">
          <button class="btn btn-primary" onclick="startMiniProject()" style="flex:1">Start Project</button>
          <button class="btn btn-outline" onclick="downloadMiniProject()" style="flex:1">Download Starter</button>
          <button class="btn btn-outline" onclick="closeProjectModal()" style="flex:1">Close</button>
        </div>
      </div>
    </div>

    <!-- ======================== CODE GAME PANEL ======================== -->
    <div id="codegame" class="panel">
      <div class="card">
        <h3>ðŸŽ® Guess the Output</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">Read the code snippet and guess what it prints. Earn XP for correct answers!</p>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <div>
            <span style="font-weight:700;font-size:1.2rem" id="gameScore">0</span>
            <span style="color:var(--muted);font-size:.85rem"> correct</span>
            <span style="margin-left:1rem;font-weight:700;font-size:1.2rem" id="gameStreak">0</span>
            <span style="color:var(--muted);font-size:.85rem"> streak</span>
          </div>
          <select id="gameLang" onchange="loadGameQuestion()" style="width:auto;padding:.3rem .6rem">
            <option value="all">All Languages</option>
            <option value="python">Python</option>
            <option value="sql">SQL</option>
            <option value="golang">Golang</option>
          </select>
        </div>
        <div class="card" style="background:#0f172a;border-radius:12px;padding:1.2rem">
          <pre style="color:#e2e8f0;font-size:.9rem;line-height:1.6;margin:0;white-space:pre-wrap" id="gameCode">Loading...</pre>
        </div>
        <div id="gameOptions" style="display:grid;grid-template-columns:1fr 1fr;gap:.6rem;margin-top:1rem"></div>
        <div id="gameFeedback" style="margin-top:1rem;padding:1rem;border-radius:10px;display:none"></div>
        <button class="btn btn-primary btn-lg" onclick="loadGameQuestion()" id="gameNextBtn" style="margin-top:1rem;display:none;width:100%">Next Question</button>
      </div>
    </div>

    <!-- ======================== SCORES PANEL ======================== -->
    <div id="scores" class="panel">
      <div class="card">
        <h3>Add Quiz Score</h3>
        <div class="add-score-form">
          <div class="form-group"><label>Subject</label>
            <select id="scoreSubject"><option value="python">Python</option><option value="sql">SQL</option><option value="golang">Golang</option></select>
          </div>
          <div class="form-group"><label>Score (out of 15)</label>
            <input type="number" id="scoreValue" min="0" max="15" placeholder="0">
          </div>
          <div class="form-group"><label>&nbsp;</label>
            <button class="btn btn-primary" onclick="addScore()">Add Score</button>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>Score Comparison</h3>
        <div id="compareSection"></div>
      </div>

      <div class="scores-grid" id="scoresGrid"></div>
    </div>

    <!-- ======================== NOTES PANEL ======================== -->
    <div id="notes" class="panel">
      <div class="tabs">
        <button class="tab active" onclick="switchTab(this,'notes')">My Notes</button>
        <button class="tab" onclick="switchTab(this,'notes')">Books & References</button>
      </div>

      <div class="tab-panel active" data-module="notes" data-tab="My Notes">
        <div class="notes-grid">
          <div class="notes-list">
            <div class="notes-list-header"><span>Notes</span><button class="btn btn-sm btn-primary" onclick="addNote()">+ New</button></div>
            <div id="notesList"></div>
          </div>
          <div class="notes-editor-area">
            <input type="text" id="noteTitle" placeholder="Note title..." style="font-weight:600;font-size:1.05rem">
            <textarea id="noteContent" placeholder="Start writing your notes here..."></textarea>
            <div style="display:flex;gap:.5rem;align-items:center">
              <button class="btn btn-primary" onclick="saveCurrentNote()">Save Note</button>
              <span class="notes-status" id="noteStatus"></span>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-panel" data-module="notes" data-tab="Books & References">
        <div id="booksSection"></div>
      </div>
    </div>

    <!-- ======================== PROGRESS MAP PANEL ======================== -->
    <div id="progressmap" class="panel">
      <div class="card">
        <h3>ðŸ—ºï¸ Learning Progress Map</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">Track your journey through each language. Mark concepts as learned to see your progress!</p>
        <div class="pm-lang-tabs">
          <button class="btn btn-sm btn-primary" onclick="switchProgressMap('python', this)">ðŸ Python</button>
          <button class="btn btn-sm btn-outline" onclick="switchProgressMap('sql', this)">ðŸ—„ï¸ SQL</button>
          <button class="btn btn-sm btn-outline" onclick="switchProgressMap('golang', this)">ðŸ”· Golang</button>
        </div>
        <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem">
          <div style="font-size:.85rem;color:var(--muted)">Completion: <strong id="pmPercent">0%</strong></div>
          <div class="progress-bg" style="flex:1"><div class="progress-fill" id="pmBar" style="width:0%"></div></div>
        </div>
        <div class="progress-map" id="progressMapContainer"></div>
      </div>
    </div>

    <!-- ======================== DEBUG EXERCISES PANEL ======================== -->
    <div id="debugex" class="panel">
      <div class="card">
        <h3>ðŸž Debug Challenge</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">Find and fix the bug in each code snippet. Type the corrected line!</p>
        <div style="display:flex;gap:.5rem;margin-bottom:1rem">
          <button class="btn btn-sm btn-primary" onclick="switchDebugLang('python')">ðŸ Python</button>
          <button class="btn btn-sm btn-outline" onclick="switchDebugLang('sql')">ðŸ—„ï¸ SQL</button>
          <button class="btn btn-sm btn-outline" onclick="switchDebugLang('golang')">ðŸ”· Golang</button>
        </div>
        <div style="margin-bottom:.8rem;font-size:.85rem">Score: <strong id="debugScore">0</strong> / <span id="debugTotal">0</span></div>
        <div id="debugList"></div>
      </div>
    </div>

    <!-- ======================== FILL IN BLANK PANEL ======================== -->
    <div id="fillblank" class="panel">
      <div class="card">
        <h3>ðŸ“ Fill in the Blank</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">Complete the code by filling in the missing keywords!</p>
        <div style="display:flex;gap:.5rem;margin-bottom:1rem">
          <button class="btn btn-sm btn-primary" onclick="switchFITBLang('python')">ðŸ Python</button>
          <button class="btn btn-sm btn-outline" onclick="switchFITBLang('sql')">ðŸ—„ï¸ SQL</button>
          <button class="btn btn-sm btn-outline" onclick="switchFITBLang('golang')">ðŸ”· Golang</button>
        </div>
        <div style="margin-bottom:.8rem;font-size:.85rem">Score: <strong id="fitbScore">0</strong> / <span id="fitbTotal">0</span></div>
        <div id="fitbList"></div>
      </div>
    </div>

    <!-- ======================== CODE ORDER PANEL ======================== -->
    <div id="codeorder" class="panel">
      <div class="card">
        <h3>ðŸ”€ Code Order Challenge</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">Drag the lines of code into the correct order!</p>
        <div style="display:flex;gap:.5rem;margin-bottom:1rem">
          <button class="btn btn-sm btn-primary" onclick="switchDnDLang('python')">ðŸ Python</button>
          <button class="btn btn-sm btn-outline" onclick="switchDnDLang('sql')">ðŸ—„ï¸ SQL</button>
          <button class="btn btn-sm btn-outline" onclick="switchDnDLang('golang')">ðŸ”· Golang</button>
        </div>
        <div id="dndList"></div>
      </div>
    </div>

    <!-- ======================== PEER CHALLENGE PANEL ======================== -->
    <div id="peerchallenge" class="panel">
      <div class="card">
        <h3>ðŸ¤ Peer Challenge</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">Challenge a friend! Both solve the same problem, then compare results.</p>
        <div class="peer-card">
          <div style="margin-bottom:1rem">
            <label style="font-size:.85rem;font-weight:600;display:block;margin-bottom:.3rem">Player 1:</label>
            <select id="peer1" style="width:auto;padding:.3rem .6rem"></select>
            <span class="peer-vs">VS</span>
            <label style="font-size:.85rem;font-weight:600;display:block;margin-bottom:.3rem">Player 2:</label>
            <select id="peer2" style="width:auto;padding:.3rem .6rem"></select>
          </div>
          <button class="btn btn-primary btn-lg" onclick="startPeerChallenge()">Start Challenge!</button>
          <div id="peerProblem" style="display:none;margin-top:1.5rem;text-align:left">
            <h4 id="peerProblemTitle" style="margin-bottom:.5rem"></h4>
            <p id="peerProblemDesc" style="font-size:.88rem;margin-bottom:1rem"></p>
            <div class="peer-result-grid">
              <div class="peer-col">
                <div class="name" id="peerName1"></div>
                <textarea id="peerAns1" class="ch-textarea" rows="6" placeholder="Player 1's answer..."></textarea>
              </div>
              <div style="font-size:2rem;color:var(--accent2);font-weight:800">VS</div>
              <div class="peer-col">
                <div class="name" id="peerName2"></div>
                <textarea id="peerAns2" class="ch-textarea" rows="6" placeholder="Player 2's answer..."></textarea>
              </div>
            </div>
            <div style="text-align:center;margin-top:1rem">
              <button class="btn btn-success" onclick="submitPeerChallenge()">Submit Both Answers</button>
            </div>
            <div id="peerResult" style="display:none;margin-top:1rem"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- ======================== PROGRESS REPORT PANEL ======================== -->
    <div id="report" class="panel">
      <div class="card">
        <h3>ðŸ“Š Progress Report</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">View and export a complete summary of your learning journey.</p>
        <button class="btn btn-primary" onclick="generateReport()" style="margin-bottom:1rem">Generate Report</button>
        <button class="btn btn-success" onclick="downloadReport()">Download as HTML</button>
        <div class="report-preview" id="reportPreview" style="margin-top:1rem">
          <p style="color:var(--muted);text-align:center;padding:2rem">Click "Generate Report" to see your progress summary.</p>
        </div>
      </div>
    </div>

    <!-- ======================== STREAK TRACKER PANEL ======================== -->
    <div id="streaktracker" class="panel">
      <div class="card">
        <h3>ðŸ”¥ Daily Streak Tracker</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1.5rem">
          <div style="background:var(--card-hover);padding:1rem;border-radius:12px;text-align:center">
            <div style="font-size:2.5rem;font-weight:800;color:var(--warn)" id="streakTrackerCount">0</div>
            <div style="font-size:.85rem;color:var(--muted);margin-top:.3rem">Day Streak</div>
          </div>
          <div style="background:var(--card-hover);padding:1rem;border-radius:12px;text-align:center">
            <div style="font-size:2.5rem;font-weight:800;color:var(--accent)" id="longestStreak">0</div>
            <div style="font-size:.85rem;color:var(--muted);margin-top:.3rem">Longest Streak</div>
          </div>
        </div>
        <div style="margin-bottom:1.5rem">
          <h4 style="margin-bottom:.8rem">ðŸ“… Activity Calendar (Last 30 Days)</h4>
          <div class="streak-cal" id="streakCalTracker"></div>
        </div>
        <div style="margin-bottom:1.5rem">
          <h4 style="margin-bottom:.8rem">â­ Streak Milestones Unlocked</h4>
          <div class="streak-milestones" id="streakMilestones"></div>
        </div>
        <div id="streakWarning" style="display:none;background:rgba(220,38,38,.1);border:1.5px solid var(--warn);border-radius:8px;padding:.8rem;margin-bottom:1rem" class="streak-warning-box">
          <div style="color:var(--warn);font-weight:600;font-size:.9rem">âš ï¸ Streak at Risk!</div>
          <div style="color:var(--muted);font-size:.82rem;margin-top:.3rem" id="streakWarningMsg"></div>
        </div>
        <div style="background:var(--card-hover);padding:1rem;border-radius:8px;margin-bottom:1rem">
          <div style="font-size:.85rem;font-weight:600;color:var(--muted);margin-bottom:.5rem">ðŸ“Š Streak Statistics</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem;font-size:.82rem">
            <div><span style="color:var(--muted)">Total days coded:</span> <span id="totalDaysCoded" style="font-weight:600">0</span></div>
            <div><span style="color:var(--muted)">Current month:</span> <span id="currentMonthDays" style="font-weight:600">0</span> days</div>
            <div><span style="color:var(--muted)">This week:</span> <span id="thisWeekDays" style="font-weight:600">0</span> days</div>
            <div><span style="color:var(--muted)">Streak start:</span> <span id="streakStartDateDisplay" style="font-weight:600">-</span></div>
          </div>
        </div>
      </div>
    </div>

    <!-- ======================== LEADERBOARDS PANEL ======================== -->
    <div id="leaderboards" class="panel">
      <div class="card">
        <h3>ðŸ… Leaderboards</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:.5rem;margin-bottom:1.5rem">
          <div>
            <label style="font-size:.78rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.3rem">Language</label>
            <select id="lbLangFilter" onchange="renderLeaderboardsFiltered()" style="width:100%;padding:.4rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
              <option value="all">All Languages</option>
              <option value="python">ðŸ Python</option>
              <option value="sql">ðŸ—„ï¸ SQL</option>
              <option value="golang">ðŸ”· Go</option>
            </select>
          </div>
          <div>
            <label style="font-size:.78rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.3rem">Time Period</label>
            <select id="lbTimeFilter" onchange="renderLeaderboardsFiltered()" style="width:100%;padding:.4rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
              <option value="all">All Time</option>
              <option value="month">This Month</option>
              <option value="week">This Week</option>
              <option value="today">Today</option>
            </select>
          </div>
          <div>
            <label style="font-size:.78rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.3rem">Metric</label>
            <select id="lbMetricFilter" onchange="renderLeaderboardsFiltered()" style="width:100%;padding:.4rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
              <option value="xp">ðŸ”¥ XP Points</option>
              <option value="quizzes">âœ… Quiz Score</option>
              <option value="projects">ðŸš€ Projects</option>
              <option value="badges">ðŸ† Badges</option>
            </select>
          </div>
          <div>
            <label style="font-size:.78rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.3rem">Scope</label>
            <select id="lbScopeFilter" onchange="renderLeaderboardsFiltered()" style="width:100%;padding:.4rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
              <option value="all">Global</option>
              <option value="friends">Friends Only</option>
            </select>
          </div>
        </div>
        <div id="leaderboardsOutput"></div>
      </div>
    </div>

    <!-- ======================== LIVE CODE PLAYGROUND ======================== -->
    <div id="codeplayground" class="panel">
      <div class="card">
        <h3>ðŸ’» Live Code Playground</h3>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;margin-bottom:1rem">
          <button class="btn" id="pgPyBtn" onclick="setPGLanguage('python')" style="background:var(--card-hover)">ðŸ Python</button>
          <button class="btn" id="pgSqlBtn" onclick="setPGLanguage('sql')" style="background:var(--card-hover)">ðŸ—„ï¸ SQL</button>
          <button class="btn" id="pgGoBtn" onclick="setPGLanguage('golang')" style="background:var(--card-hover)">ðŸ”· Go</button>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem">
          <div>
            <label style="font-size:.85rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.5rem">Code Editor</label>
            <textarea id="livePgCode" placeholder="Write your code here..." style="width:100%;height:300px;padding:.8rem;font-family:monospace;font-size:.85rem;border:1.5px solid var(--border);border-radius:8px;background:var(--card);color:var(--text);resize:vertical"></textarea>
          </div>
          <div>
            <label style="font-size:.85rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.5rem">Output</label>
            <div id="livePgOutput" style="width:100%;height:300px;padding:.8rem;font-family:monospace;font-size:.85rem;background:var(--card-hover);border:1.5px solid var(--border);border-radius:8px;color:var(--muted);overflow-y:auto;white-space:pre-wrap;word-break:break-word"></div>
          </div>
        </div>
        <div style="display:flex;gap:.5rem;margin-bottom:1rem">
          <button class="btn btn-primary" onclick="runPGCode()">â–¶ï¸ Run Code</button>
          <button class="btn btn-outline" onclick="clearPGCode()">Clear</button>
          <button class="btn btn-outline" onclick="loadPGExample()">ðŸ“š Example</button>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
          <button class="btn btn-outline btn-sm" onclick="addPGSnippet('variable')">+ Variable</button>
          <button class="btn btn-outline btn-sm" onclick="addPGSnippet('loop')">+ Loop</button>
          <button class="btn btn-outline btn-sm" onclick="addPGSnippet('if')">+ If/Else</button>
          <button class="btn btn-outline btn-sm" onclick="addPGSnippet('function')">+ Function</button>
        </div>
      </div>
    </div>

    <!-- ======================== LEARNING ANALYTICS ======================== -->
    <div id="analytics" class="panel">
      <div class="card">
        <h3>ðŸ“ˆ Learning Analytics & Weak Concepts</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;margin-bottom:1.5rem">
          <div style="background:var(--card-hover);padding:1rem;border-radius:12px;text-align:center">
            <div style="font-size:2rem;font-weight:800;color:var(--accent)" id="analyticsAvgScore">0%</div>
            <div style="font-size:.85rem;color:var(--muted);margin-top:.3rem">Overall Score</div>
          </div>
          <div style="background:var(--card-hover);padding:1rem;border-radius:12px;text-align:center">
            <div style="font-size:2rem;font-weight:800;color:var(--success)" id="analyticsConceptsMastered">0/0</div>
            <div style="font-size:.85rem;color:var(--muted);margin-top:.3rem">Concepts Mastered</div>
          </div>
          <div style="background:var(--card-hover);padding:1rem;border-radius:12px;text-align:center">
            <div style="font-size:2rem;font-weight:800;color:var(--warn)" id="analyticsWeakAreas">0</div>
            <div style="font-size:.85rem;color:var(--muted);margin-top:.3rem">Weak Areas Identified</div>
          </div>
        </div>
        <div style="margin-bottom:1.5rem">
          <h4 style="margin-bottom:.8rem">ðŸŽ¯ Concept Mastery by Language</h4>
          <div id="analyticsMasteryChart"></div>
        </div>
        <div style="margin-bottom:1.5rem">
          <h4 style="margin-bottom:.8rem">âš ï¸ Weak Concepts to Focus On</h4>
          <div id="analyticsWeakConcepts"></div>
        </div>
        <div style="margin-bottom:1.5rem">
          <h4 style="margin-bottom:.8rem">ðŸ“Š Quiz Performance by Topic</h4>
          <div id="analyticsQuizPerformance"></div>
        </div>
        <div style="background:rgba(59,130,246,.1);border:1.5px solid var(--accent);border-radius:8px;padding:1rem">
          <div style="font-weight:600;color:var(--accent);margin-bottom:.5rem">ðŸ’¡ Personalized Recommendations</div>
          <div id="analyticsRecommendations" style="color:var(--text);font-size:.85rem;line-height:1.6"></div>
        </div>
      </div>
    </div>

    <!-- ======================== AI LEARNING PATH ======================== -->
    <div id="learningpath" class="panel">
      <div class="card">
        <h3>ðŸ§  AI-Powered Learning Path</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1.5rem">Get a personalized learning roadmap based on your performance and goals.</p>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1.5rem">
          <div>
            <label style="font-size:.85rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.5rem">Your Level</label>
            <div style="background:var(--card-hover);padding:.8rem;border-radius:8px;font-weight:600" id="lpYourLevel">Beginner</div>
          </div>
          <div>
            <label style="font-size:.85rem;font-weight:600;color:var(--muted);display:block;margin-bottom:.5rem">Goal</label>
            <select id="lpGoal" onchange="updateLearningPath()" style="width:100%;padding:.5rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
              <option value="basics">Master the Basics</option>
              <option value="intermediate">Get Intermediate Skills</option>
              <option value="advanced">Advanced Mastery</option>
              <option value="interview">Interview Ready</option>
              <option value="project">Build Real Projects</option>
            </select>
          </div>
        </div>
        <div style="margin-bottom:1.5rem">
          <h4 style="margin-bottom:1rem">ðŸ“š Recommended Learning Sequence</h4>
          <div id="lpSequence"></div>
        </div>
        <div style="margin-bottom:1.5rem">
          <h4 style="margin-bottom:1rem">â±ï¸ Estimated Time to Complete</h4>
          <div id="lpTimeline" style="background:var(--card-hover);padding:1rem;border-radius:8px"></div>
        </div>
        <div style="background:rgba(34,197,94,.1);border:1.5px solid var(--success);border-radius:8px;padding:1rem">
          <div style="font-weight:600;color:var(--success);margin-bottom:.5rem">ðŸŽ¯ Your Progress</div>
          <div id="lpProgress" style="color:var(--text);font-size:.85rem"></div>
        </div>
      </div>
    </div>

    <!-- ======================== INTERVIEW QUESTIONS ======================== -->
    <div id="interviewquestions" class="panel">
      <div class="card">
        <h3>ðŸ’¡ Interview Question Bank</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.5rem;margin-bottom:1.5rem">
          <select id="iqLangFilter" onchange="renderInterviewQuestions()" style="padding:.5rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
            <option value="all">All Languages</option>
            <option value="python">ðŸ Python</option>
            <option value="sql">ðŸ—„ï¸ SQL</option>
            <option value="golang">ðŸ”· Go</option>
          </select>
          <select id="iqDiffFilter" onchange="renderInterviewQuestions()" style="padding:.5rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
            <option value="all">All Levels</option>
            <option value="easy">Easy</option>
            <option value="medium">Medium</option>
            <option value="hard">Hard</option>
          </select>
          <select id="iqCategoryFilter" onchange="renderInterviewQuestions()" style="padding:.5rem;border:1.5px solid var(--border);background:var(--card);color:var(--text);border-radius:6px;font-size:.82rem">
            <option value="all">All Categories</option>
            <option value="fundamentals">Fundamentals</option>
            <option value="datastructures">Data Structures</option>
            <option value="algorithms">Algorithms</option>
            <option value="databases">Databases</option>
          </select>
        </div>
        <div id="iqQuestions" style="display:grid;gap:1rem"></div>
      </div>
    </div>

    <!-- ======================== CHEAT SHEETS PANEL ======================== -->
    <div id="cheatsheets" class="panel">
      <div class="card">
        <h3>ðŸ“‹ Quick Reference Cheat Sheets</h3>
        <p style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">All syntax references in one place. Switch languages and search for any topic!</p>
        <div class="cs-lang-tabs">
          <button class="cs-lang-tab active" onclick="switchCheatSheetLang('python', this)">ðŸ Python</button>
          <button class="cs-lang-tab" onclick="switchCheatSheetLang('sql', this)">ðŸ—„ï¸ SQL</button>
          <button class="cs-lang-tab" onclick="switchCheatSheetLang('golang', this)">ðŸ”· Golang</button>
        </div>
        <div class="cs-search">
          <input type="text" id="csSearchInput" placeholder="Search cheat sheet..." oninput="filterCheatSheet()">
          <button class="download-btn" id="csDownloadBtn" onclick="downloadCheatSheet(csCurrentLang)">â¬‡ Download</button>
        </div>
        <div class="cs-content" id="csContent"></div>
      </div>
    </div>

    <!-- ======================== AI CHATBOT ======================== -->
    <div id="chatbot" class="panel">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
          <h3 style="margin:0">ðŸ’¬ AI Learning Assistant</h3>
          <button class="btn btn-sm" onclick="showModal('apiKeyModal')" title="Backend status & connection test" style="background:var(--success);color:white;font-size:.8rem">ðŸ”— Backend Info</button>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.5rem;margin-bottom:1rem">
          <button class="btn" id="cbModeLearn" onclick="setChatMode('learn')" style="background:var(--accent);color:white">ðŸ“š Learn</button>
          <button class="btn" id="cbModeDebug" onclick="setChatMode('debug')" style="background:var(--card-hover)">ðŸž Debug</button>
          <button class="btn" id="cbModeInterview" onclick="setChatMode('interview')" style="background:var(--card-hover)">ðŸŽ¤ Interview</button>
        </div>
        <div style="background:var(--card-hover);border-radius:8px;height:350px;overflow-y:auto;margin-bottom:1rem;padding:1rem" id="chatMessages"></div>
        <div style="display:flex;gap:.5rem;margin-bottom:1rem">
          <input type="text" id="chatInput" placeholder="Ask me anything..." onkeypress="if(event.key==='Enter') sendChatMessage()" style="flex:1;padding:.7rem;border:1.5px solid var(--border);border-radius:8px;font-size:.85rem;background:var(--card);color:var(--text)">
          <button class="btn btn-primary" onclick="sendChatMessage()">Send</button>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
          <button class="btn btn-outline btn-sm" onclick="quickQuestion('What is a list in Python?')">Q: Lists?</button>
          <button class="btn btn-outline btn-sm" onclick="quickQuestion('Explain SQL JOINs')">Q: JOINs?</button>
          <button class="btn btn-outline btn-sm" onclick="quickQuestion('Debug: undefined is not a function')">Debug Error</button>
          <button class="btn btn-outline btn-sm" onclick="quickQuestion('Difference between Python and Go?')">Compare</button>
        </div>
      </div>
    </div>

    <!-- ======================== TYPING SPEED TEST ======================== -->
    <div id="typingtest" class="panel">
      <div class="card typing-test-container">
        <h3>âŒ¨ï¸ Typing Speed Test</h3>
        <p style="font-size:.85rem;color:var(--muted);margin-bottom:1rem">Test your coding speed! Choose a language, then type the snippet as fast and accurately as you can.</p>
        <div class="typing-test-controls">
          <select id="ttLang" style="width:auto;padding:.4rem .7rem">
            <option value="python">Python</option>
            <option value="sql">SQL</option>
            <option value="golang">Go</option>
          </select>
          <button class="btn btn-primary" id="ttStartBtn" onclick="startTypingTest()">â–¶ Start Test</button>
          <button class="btn btn-outline" onclick="resetTypingTest()">â†» Reset</button>
        </div>
        <div class="typing-stats">
          <div class="typing-stat"><div class="num" id="ttTimer">0</div><div class="lbl">Seconds</div></div>
          <div class="typing-stat"><div class="num" id="ttWPM">0</div><div class="lbl">WPM</div></div>
          <div class="typing-stat"><div class="num" id="ttAccuracy">100%</div><div class="lbl">Accuracy</div></div>
          <div class="typing-stat"><div class="num" id="ttErrors">0</div><div class="lbl">Errors</div></div>
        </div>
        <div class="typing-test-display" id="ttDisplay">Press <strong style="color:var(--accent)">Start Test</strong> to begin...</div>
        <textarea class="typing-textarea" id="ttInput" placeholder="Start typing here once the test begins..." disabled></textarea>
        <div id="ttResult" style="display:none"></div>
        <div class="typing-history" id="ttHistory"></div>
      </div>
    </div>

  </div>
</div>

<!-- Toast notification -->
<div class="toast" id="toast"><span class="toast-icon" id="toastIcon"></span><span id="toastMsg"></span></div>

<!-- Floating Chatbot Widget -->
<button class="chatbot-button" id="chatbotButton" onclick="toggleChatbot()">ðŸ’¬<span class="ring"></span></button>
<div class="chatbot-modal" id="chatbotModal">
  <div class="chatbot-header">
    <h4>Code Assistant ðŸ¤–</h4>
    <button onclick="toggleChatbot()" title="Close">âœ•</button>
  </div>
  <div class="chatbot-messages" id="chatbotMessages"></div>
  <div class="chatbot-quick-prompts">
    <button onclick="quickFloatingChat('What is a list in Python?')">Q: Lists?</button>
    <button onclick="quickFloatingChat('Explain SQL JOINs')">Q: JOINs?</button>
    <button onclick="quickFloatingChat('Debug: undefined is not a function')">Debug Error</button>
    <button onclick="quickFloatingChat('Difference between Python and Go?')">Compare</button>
    <button onclick="quickFloatingChat('Explain goroutines in Go')">Go Routines</button>
    <button onclick="quickFloatingChat('What are Python decorators?')">Decorators</button>
  </div>
  <div class="chatbot-input">
    <input type="text" id="chatbotInput" placeholder="Ask about Python, SQL, Go..." onkeypress="if(event.key==='Enter') sendFloatingChatMessage()">
    <button onclick="sendFloatingChatMessage()">âž¤</button>
  </div>
</div>

<!-- API Key Setup Modal (Backend Status) -->
<div class="modal-overlay" id="apiKeyModal">
  <div class="modal">
    <h3>AI Assistant Settings</h3>
    <div class="chatbot-setup">
      <p style="color:var(--success);font-weight:600;margin-bottom:.5rem">Built-in Smart Assistant is always available!</p>
      <p style="color:var(--text);margin-bottom:1rem;font-size:.82rem">The assistant works offline with 50+ programming topics. For more advanced AI responses, you can optionally add a free Google Gemini API key below.</p>
      <label style="font-size:.82rem;font-weight:600;color:var(--muted)">Google Gemini API Key (optional)</label>
      <input type="password" id="geminiKeyInput" placeholder="Paste your Gemini API key..." style="margin-bottom:.5rem">
      <p style="font-size:.75rem;color:var(--muted)">Get a free key at <a href="https://aistudio.google.com/app/apikey" target="_blank" style="color:var(--accent)">aistudio.google.com</a></p>
      <div style="display:flex;gap:.5rem;margin-top:.5rem">
        <button class="btn btn-primary" onclick="saveApiKey()">Save Key</button>
        <button class="btn btn-outline" onclick="clearApiKey()">Clear Key</button>
        <button class="btn btn-outline" onclick="closeModal('apiKeyModal')">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Add User Modal -->
<div class="modal-overlay" id="addUserModal">
  <div class="modal">
    <h3>Add New Person</h3>
    <div class="form-group">
      <label>Name</label>
      <input type="text" id="newUserName" placeholder="Enter name...">
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('addUserModal')">Cancel</button>
      <button class="btn btn-primary" onclick="addUser()">Add Person</button>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HELPERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadRaw(k,d){try{return JSON.parse(localStorage.getItem(k))||d}catch{return d}}
function saveRaw(k,v){localStorage.setItem(k,JSON.stringify(v))}
function switchAuthTab(tab){
  document.querySelectorAll('.auth-tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.auth-form').forEach(f=>f.classList.remove('active'));
  document.getElementById(tab+'Form').classList.add('active');
  const tabs=document.querySelectorAll('.auth-tab');
  tabs[tab==='login'?0:1].classList.add('active');
  document.querySelectorAll('.auth-error,.auth-success').forEach(e=>e.style.display='none');
}

function doLogin(){
  const email=document.getElementById('loginEmail').value.trim();
  const pw=document.getElementById('loginPassword').value;
  const errEl=document.getElementById('loginError');
  errEl.style.display='none';
  if(!email||!pw){errEl.textContent='Please fill in all fields.';errEl.style.display='block';return;}
  const accts=loadRaw('dm_accounts',[]);
  const acct=accts.find(a=>a.email===email && a.password===pw);
  if(!acct){errEl.textContent='Invalid email or password.';errEl.style.display='block';return;}
  saveRaw('dm_logged_in',{email:acct.email,name:acct.name});
  if(!users.includes(acct.name)){users.push(acct.name);save('dm_users',users);}
  currentUserIdx=users.indexOf(acct.name);
  save('dm_currentUser',currentUserIdx);
  document.getElementById('authOverlay').classList.add('hidden');
  renderUserSelect();
  fullInit();
}

function doRegister(){
  const name=document.getElementById('regName').value.trim();
  const email=document.getElementById('regEmail').value.trim();
  const pw=document.getElementById('regPassword').value;
  const pw2=document.getElementById('regConfirm').value;
  const errEl=document.getElementById('regError');
  const succEl=document.getElementById('regSuccess');
  errEl.style.display='none';succEl.style.display='none';
  if(!name||!email||!pw){errEl.textContent='Please fill in all fields.';errEl.style.display='block';return;}
  if(pw.length<4){errEl.textContent='Password must be at least 4 characters.';errEl.style.display='block';return;}
  if(pw!==pw2){errEl.textContent='Passwords do not match.';errEl.style.display='block';return;}
  let accts=loadRaw('dm_accounts',[]);
  if(accts.find(a=>a.email===email)){errEl.textContent='An account with this email already exists.';errEl.style.display='block';return;}
  accts.push({email:email,password:pw,name:name});
  saveRaw('dm_accounts',accts);
  // Auto-login after registration
  saveRaw('dm_logged_in',{email:email,name:name});
  if(!users.includes(name)){users.push(name);save('dm_users',users);}
  currentUserIdx=users.indexOf(name);
  save('dm_currentUser',currentUserIdx);
  document.getElementById('authOverlay').classList.add('hidden');
  renderUserSelect();
  fullInit();
}

function doLogout(){
  saveRaw('dm_logged_in',null);
  document.getElementById('authOverlay').classList.remove('hidden');
  document.getElementById('loginEmail').value='';
  document.getElementById('loginPassword').value='';
}

function checkAuth(){
  const session=loadRaw('dm_logged_in',null);
  if(session && session.email){
    const accts=loadRaw('dm_accounts',[]);
    const acct=accts.find(a=>a.email===session.email);
    if(!acct) return false;
    if(!users.includes(acct.name)){users.push(acct.name);save('dm_users',users);}
    currentUserIdx=users.indexOf(acct.name);
    save('dm_currentUser',currentUserIdx);
    document.getElementById('authOverlay').classList.add('hidden');
    return true;
  }
  return false;
}

document.addEventListener('DOMContentLoaded',function(){
  document.getElementById('loginPassword').addEventListener('keydown',e=>{if(e.key==='Enter')doLogin();});
  document.getElementById('regConfirm').addEventListener('keydown',e=>{if(e.key==='Enter')doRegister();});
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function load(k,d){try{return JSON.parse(localStorage.getItem(k))||d}catch{return d}}
function save(k,v){localStorage.setItem(k,JSON.stringify(v))}
function loadRaw(k,d){try{const v=localStorage.getItem(k);return v?JSON.parse(v):d}catch{return d}}
function saveRaw(k,v){if(v===null)localStorage.removeItem(k);else localStorage.setItem(k,JSON.stringify(v))}

let users = load('dm_users', ['Amrutha']);
let currentUserIdx = load('dm_currentUser', 0);
let allScores = load('dm_scores', {});
let allNotes = load('dm_notes', {});
let quizAnswers = load('dm_quizAnswers', {});
let activeNoteId = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONCEPTS DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const CONCEPTS = {
python: [
  {title:'1. Variables & Data Types', content:`<p>Variables are containers that store data. Python figures out the type automatically.</p>
<pre>name = "Amrutha"     # str (text)
age = 25               # int (whole number)
gpa = 3.8              # float (decimal)
is_student = True      # bool (True/False)

print(type(name))   # &lt;class 'str'&gt;</pre>
<p><strong>Key types:</strong> <code>str</code> (text), <code>int</code> (whole numbers), <code>float</code> (decimals), <code>bool</code> (True/False), <code>list</code> (collections), <code>dict</code> (key-value pairs)</p>
<p><strong>Type conversion:</strong> <code>int("5")</code> turns text "5" into number 5. <code>str(25)</code> turns number into text.</p>`},
  {title:'2. Input & Output', content:`<p><code>print()</code> shows output. <code>input()</code> gets text from the user.</p>
<pre># Output with f-strings (formatted)
name = "Amrutha"
age = 25
print(f"Hello {name}, you are {age} years old!")

# Getting input
user_name = input("What is your name? ")
user_age = int(input("What is your age? "))   # Convert to number
print(f"Welcome {user_name}, age {user_age}!")</pre>
<p><strong>Important:</strong> <code>input()</code> always returns a string. Use <code>int()</code> or <code>float()</code> to convert to numbers.</p>`},
  {title:'3. If / Elif / Else (Decisions)', content:`<p>Make your program choose different paths based on conditions.</p>
<pre>marks = 85

if marks >= 90:
    print("Grade A - Excellent!")
elif marks >= 80:
    print("Grade B - Good!")       # This runs
elif marks >= 70:
    print("Grade C - Average")
else:
    print("Need improvement")

# Comparison operators: == != > < >= <=
# Logical operators: and, or, not</pre>
<p><strong>Indentation matters!</strong> Python uses 4 spaces to group code inside if/else blocks.</p>`},
  {title:'4. For & While Loops', content:`<p>Repeat actions multiple times without writing the same code over and over.</p>
<pre># FOR loop - repeat a known number of times
for i in range(5):          # 0,1,2,3,4
    print(i)

for fruit in ["apple", "banana", "cherry"]:
    print(fruit)

# WHILE loop - repeat until condition is false
count = 5
while count > 0:
    print(count)
    count -= 1              # subtract 1
print("Go!")

# break = exit loop early, continue = skip to next</pre>`},
  {title:'5. Lists', content:`<p>Lists store multiple items in order. They can grow and shrink.</p>
<pre>fruits = ["apple", "banana", "cherry"]

fruits.append("mango")        # Add to end
fruits.insert(1, "grape")     # Add at position 1
fruits.remove("banana")       # Remove by value
last = fruits.pop()           # Remove & return last item

print(len(fruits))            # Count items
print(fruits[0])              # First item
print(fruits[-1])             # Last item
print(fruits[1:3])            # Slice: items 1 and 2

# List comprehension (shortcut)
squares = [x**2 for x in range(6)]  # [0,1,4,9,16,25]</pre>`},
  {title:'6. Functions', content:`<p>Functions are reusable blocks of code. Define once, call many times.</p>
<pre>def greet(name):
    """This function greets someone"""
    return f"Hello, {name}!"

message = greet("Amrutha")
print(message)  # Hello, Amrutha!

# Default parameters
def power(base, exp=2):
    return base ** exp

print(power(5))      # 25 (uses default exp=2)
print(power(5, 3))   # 125

# Functions can return multiple values
def min_max(numbers):
    return min(numbers), max(numbers)

lo, hi = min_max([3,1,4,1,5,9])  # lo=1, hi=9</pre>`},
  {title:'7. Dictionaries', content:`<p>Dictionaries store key-value pairs. Like a real dictionary: word â†’ definition.</p>
<pre>student = {
    "name": "Amrutha",
    "age": 25,
    "subjects": ["Python", "SQL"]
}

print(student["name"])          # Access by key
student["grade"] = "A"          # Add new key
del student["age"]              # Delete a key

# Loop through
for key, value in student.items():
    print(f"{key}: {value}")

# Check if key exists
if "name" in student:
    print("Name exists!")</pre>`},
  {title:'8. String Methods', content:`<p>Strings have many built-in methods to manipulate text.</p>
<pre>text = "  Hello, Python World!  "

text.strip()           # Remove whitespace from sides
text.lower()           # "  hello, python world!  "
text.upper()           # "  HELLO, PYTHON WORLD!  "
text.replace("Python","Go")   # Replace text
text.split(",")        # Split into list: ["  Hello", " Python World!  "]
"Python" in text       # True (check if contains)
text.startswith("  He")  # True
text.count("l")        # 3

# f-strings for formatting
name, age = "Amrutha", 25
print(f"{name} is {age} years old")
print(f"Pi is {3.14159:.2f}")     # Pi is 3.14</pre>`},
  {title:'9. File Handling', content:`<p>Read and write files on your computer.</p>
<pre># Writing to a file
with open("notes.txt", "w") as f:
    f.write("Hello!\\n")
    f.write("This is my file.\\n")

# Reading a file
with open("notes.txt", "r") as f:
    content = f.read()       # Read entire file
    print(content)

# Reading line by line
with open("notes.txt", "r") as f:
    for line in f:
        print(line.strip())

# Appending (add to end)
with open("notes.txt", "a") as f:
    f.write("New line added!\\n")</pre>
<p>The <code>with</code> statement automatically closes the file when done.</p>`},
  {title:'10. Error Handling (try/except)', content:`<p>Handle errors gracefully instead of crashing.</p>
<pre>try:
    num = int(input("Enter a number: "))
    result = 100 / num
    print(f"Result: {result}")
except ValueError:
    print("That's not a valid number!")
except ZeroDivisionError:
    print("Cannot divide by zero!")
except Exception as e:
    print(f"Something went wrong: {e}")
finally:
    print("This always runs")</pre>
<p>Common errors: <code>ValueError</code>, <code>TypeError</code>, <code>KeyError</code>, <code>IndexError</code>, <code>FileNotFoundError</code></p>`}
],

sql: [
  {title:'1. What is SQL & Databases', content:`<p>SQL (Structured Query Language) is used to communicate with databases. A database is like a collection of spreadsheets (tables).</p>
<p><strong>Key terms:</strong></p>
<p><code>Table</code> = A spreadsheet with rows and columns<br>
<code>Row</code> = One record (one student, one order)<br>
<code>Column</code> = One field (name, age, grade)<br>
<code>Primary Key</code> = Unique ID for each row<br>
<code>Query</code> = A question you ask the database</p>
<pre>-- SQL is NOT case sensitive, but conventions use UPPERCASE for keywords
SELECT name FROM students WHERE age > 20;</pre>`},
  {title:'2. CREATE TABLE & Data Types', content:`<p>Create a new table to store data.</p>
<pre>CREATE TABLE students (
    id INTEGER PRIMARY KEY,    -- Unique ID, auto-numbers
    name TEXT NOT NULL,        -- Text, cannot be empty
    age INTEGER,               -- Whole numbers
    gpa REAL,                  -- Decimal numbers
    city TEXT DEFAULT 'Unknown' -- Default value
);

-- Common data types:
-- INTEGER  = whole numbers (1, 42, -5)
-- REAL     = decimals (3.14, 99.9)
-- TEXT     = text/strings ("hello")
-- BLOB     = binary data (images)
-- NULL     = empty/no value</pre>`},
  {title:'3. INSERT - Adding Data', content:`<p>Insert new rows into a table.</p>
<pre>-- Insert one row with all columns
INSERT INTO students (name, age, gpa, city)
VALUES ('Amrutha', 25, 3.8, 'Hyderabad');

-- Insert multiple rows at once
INSERT INTO students (name, age, gpa, city) VALUES
    ('Rahul', 22, 3.5, 'Mumbai'),
    ('Priya', 23, 3.9, 'Delhi'),
    ('Amit', 24, 3.2, 'Bangalore'),
    ('Sara', 21, 3.7, 'Chennai');</pre>
<p><strong>Tip:</strong> Text values use single quotes <code>'text'</code>, numbers don't need quotes.</p>`},
  {title:'4. SELECT - Reading Data', content:`<p>SELECT retrieves data from tables. It's the most used SQL command.</p>
<pre>-- Get everything
SELECT * FROM students;

-- Get specific columns
SELECT name, gpa FROM students;

-- Filter with WHERE
SELECT * FROM students WHERE age > 22;
SELECT * FROM students WHERE city = 'Mumbai';
SELECT * FROM students WHERE gpa >= 3.5 AND age < 25;

-- Sort results
SELECT * FROM students ORDER BY gpa DESC;     -- Highest first
SELECT * FROM students ORDER BY name ASC;      -- A to Z

-- Limit results
SELECT * FROM students LIMIT 3;               -- Only first 3

-- Get unique values
SELECT DISTINCT city FROM students;</pre>`},
  {title:'5. UPDATE & DELETE', content:`<p>Modify or remove existing data.</p>
<pre>-- UPDATE: Change existing data
UPDATE students SET gpa = 3.9 WHERE name = 'Amit';
UPDATE students SET city = 'Pune', age = 26 WHERE id = 3;

-- DELETE: Remove rows
DELETE FROM students WHERE name = 'Sara';
DELETE FROM students WHERE gpa < 2.0;

-- âš ï¸ CAREFUL! Without WHERE, it affects ALL rows:
-- UPDATE students SET city = 'Unknown';  -- Changes ALL
-- DELETE FROM students;                  -- Deletes ALL</pre>
<p><strong>Always use WHERE</strong> with UPDATE and DELETE unless you want to affect every row.</p>`},
  {title:'6. Aggregate Functions', content:`<p>Functions that calculate a single result from multiple rows.</p>
<pre>-- COUNT: How many rows?
SELECT COUNT(*) FROM students;                 -- Total students
SELECT COUNT(*) FROM students WHERE gpa > 3.5; -- Count with filter

-- SUM: Add up values
SELECT SUM(gpa) FROM students;

-- AVG: Average
SELECT AVG(gpa) AS average_gpa FROM students;

-- MIN / MAX
SELECT MIN(age) AS youngest, MAX(age) AS oldest FROM students;

-- Use AS to rename output columns (aliases)
SELECT
    COUNT(*) AS total_students,
    AVG(gpa) AS avg_gpa,
    MAX(gpa) AS top_gpa
FROM students;</pre>`},
  {title:'7. GROUP BY & HAVING', content:`<p>Group rows together and calculate per group.</p>
<pre>-- How many students per city?
SELECT city, COUNT(*) AS student_count
FROM students
GROUP BY city;

-- Average GPA per city
SELECT city, AVG(gpa) AS avg_gpa
FROM students
GROUP BY city;

-- HAVING: Filter groups (WHERE filters rows, HAVING filters groups)
SELECT city, COUNT(*) AS cnt
FROM students
GROUP BY city
HAVING cnt > 1;     -- Only cities with more than 1 student

-- Order of clauses:
-- SELECT â†’ FROM â†’ WHERE â†’ GROUP BY â†’ HAVING â†’ ORDER BY â†’ LIMIT</pre>`},
  {title:'8. JOINs - Combining Tables', content:`<p>Combine data from two or more tables using shared columns.</p>
<pre>-- Two tables
-- students: id, name, age
-- enrollments: student_id, course_name

-- INNER JOIN: Only matching rows from both tables
SELECT students.name, enrollments.course_name
FROM students
INNER JOIN enrollments ON students.id = enrollments.student_id;

-- LEFT JOIN: All from left table + matching from right
SELECT students.name, enrollments.course_name
FROM students
LEFT JOIN enrollments ON students.id = enrollments.student_id;
-- Shows ALL students, even those not enrolled (NULL for course)

-- Table aliases make it shorter
SELECT s.name, e.course_name
FROM students s
JOIN enrollments e ON s.id = e.student_id;</pre>`},
  {title:'9. LIKE & Pattern Matching', content:`<p>Search for patterns in text data.</p>
<pre>-- % matches any number of characters
SELECT * FROM students WHERE name LIKE 'N%';    -- Starts with N
SELECT * FROM students WHERE name LIKE '%a';     -- Ends with a
SELECT * FROM students WHERE city LIKE '%bad%';  -- Contains "bad"

-- _ matches exactly one character
SELECT * FROM students WHERE name LIKE '_ik%';   -- 2nd & 3rd letters "ik"

-- IN: Match any value in a list
SELECT * FROM students WHERE city IN ('Mumbai', 'Delhi', 'Chennai');

-- BETWEEN: Range of values
SELECT * FROM students WHERE age BETWEEN 20 AND 25;

-- IS NULL / IS NOT NULL
SELECT * FROM students WHERE city IS NULL;
SELECT * FROM students WHERE city IS NOT NULL;</pre>`},
  {title:'10. Subqueries & Advanced', content:`<p>Queries inside queries for complex questions.</p>
<pre>-- Subquery: Find students with above-average GPA
SELECT name, gpa FROM students
WHERE gpa > (SELECT AVG(gpa) FROM students);

-- Subquery in FROM
SELECT city, avg_gpa FROM (
    SELECT city, AVG(gpa) AS avg_gpa
    FROM students GROUP BY city
) WHERE avg_gpa > 3.5;

-- CREATE INDEX (makes searches faster)
CREATE INDEX idx_student_name ON students(name);

-- VIEWS (saved queries)
CREATE VIEW top_students AS
SELECT name, gpa FROM students WHERE gpa > 3.5;

-- Now use it like a table
SELECT * FROM top_students;</pre>`}
],

golang: [
  {title:'1. Go Basics & Program Structure', content:`<p>Every Go program starts with <code>package main</code> and a <code>main()</code> function.</p>
<pre>package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
    fmt.Println("Go is fun!")
}</pre>
<p><strong>Key points:</strong></p>
<p>â€¢ Save as <code>.go</code> file, run with <code>go run filename.go</code><br>
â€¢ <code>package main</code> = this is a runnable program<br>
â€¢ <code>import "fmt"</code> = brings in the formatting/print package<br>
â€¢ <code>func main()</code> = the starting point of the program<br>
â€¢ Go uses curly braces <code>{}</code> not indentation like Python</p>`},
  {title:'2. Variables & Data Types', content:`<p>Go is statically typed - every variable has a fixed type.</p>
<pre>package main
import "fmt"

func main() {
    // Method 1: var keyword
    var name string = "Amrutha"
    var age int = 25
    var gpa float64 = 3.8
    var isStudent bool = true

    // Method 2: Short declaration (Go infers type)
    city := "Hyderabad"    // string
    count := 42            // int
    pi := 3.14             // float64

    // Constants (cannot be changed)
    const maxScore = 100

    fmt.Println(name, age, gpa, isStudent, city, count, pi)
}</pre>
<p><strong>Types:</strong> <code>string</code>, <code>int</code>, <code>float64</code>, <code>bool</code>, <code>byte</code>, <code>rune</code></p>`},
  {title:'3. If / Else / Switch', content:`<p>Decision making in Go. Note: no parentheses needed around conditions.</p>
<pre>marks := 85

// If/Else
if marks >= 90 {
    fmt.Println("Grade A")
} else if marks >= 80 {
    fmt.Println("Grade B")
} else {
    fmt.Println("Needs work")
}

// If with short statement
if score := calculateScore(); score > 50 {
    fmt.Println("Passed!")
}

// Switch (cleaner than many if/else)
day := "Monday"
switch day {
case "Monday", "Tuesday", "Wednesday", "Thursday", "Friday":
    fmt.Println("Weekday")
case "Saturday", "Sunday":
    fmt.Println("Weekend!")
default:
    fmt.Println("Unknown day")
}</pre>`},
  {title:'4. Loops (for is the only loop!)', content:`<p>Go only has <code>for</code> - but it can work as for, while, and for-each.</p>
<pre>// Traditional for loop
for i := 0; i < 5; i++ {
    fmt.Println(i)
}

// While-style loop
count := 10
for count > 0 {
    fmt.Println(count)
    count--
}

// Infinite loop (use break to exit)
for {
    fmt.Println("Running...")
    break  // exit the loop
}

// Range loop (for-each)
fruits := []string{"apple", "banana", "cherry"}
for index, fruit := range fruits {
    fmt.Printf("%d: %s\\n", index, fruit)
}

// Skip index with _
for _, fruit := range fruits {
    fmt.Println(fruit)
}</pre>`},
  {title:'5. Functions', content:`<p>Functions in Go can return multiple values - a unique feature!</p>
<pre>package main
import "fmt"

// Simple function
func greet(name string) string {
    return "Hello, " + name + "!"
}

// Multiple return values
func divide(a, b float64) (float64, error) {
    if b == 0 {
        return 0, fmt.Errorf("cannot divide by zero")
    }
    return a / b, nil
}

// Named return values
func minMax(numbers []int) (min, max int) {
    min, max = numbers[0], numbers[0]
    for _, n := range numbers {
        if n < min { min = n }
        if n > max { max = n }
    }
    return  // returns named values
}

func main() {
    fmt.Println(greet("Amrutha"))

    result, err := divide(10, 3)
    if err != nil {
        fmt.Println("Error:", err)
    } else {
        fmt.Printf("Result: %.2f\\n", result)
    }
}</pre>`},
  {title:'6. Arrays & Slices', content:`<p>Arrays have fixed size. Slices are flexible - use slices most of the time.</p>
<pre>// Array (fixed size)
var arr [3]int = [3]int{1, 2, 3}

// Slice (dynamic size) - used much more often
fruits := []string{"apple", "banana", "cherry"}

// Append
fruits = append(fruits, "mango", "grape")

// Length and access
fmt.Println(len(fruits))     // 5
fmt.Println(fruits[0])       // apple
fmt.Println(fruits[1:3])     // [banana cherry]

// Make a slice with specific capacity
numbers := make([]int, 0, 10)  // length 0, capacity 10
numbers = append(numbers, 1, 2, 3)

// Loop through
for i, v := range fruits {
    fmt.Printf("%d: %s\\n", i, v)
}</pre>`},
  {title:'7. Maps (Key-Value Pairs)', content:`<p>Maps are like Python dictionaries or JavaScript objects.</p>
<pre>// Create a map
scores := map[string]int{
    "Math":    95,
    "Science": 88,
    "English": 92,
}

// Access
fmt.Println(scores["Math"])  // 95

// Add / Update
scores["History"] = 85

// Delete
delete(scores, "English")

// Check if key exists
score, exists := scores["Art"]
if exists {
    fmt.Println("Art:", score)
} else {
    fmt.Println("Art not found")
}

// Loop through
for subject, score := range scores {
    fmt.Printf("%s: %d\\n", subject, score)
}</pre>`},
  {title:'8. Structs (Custom Types)', content:`<p>Structs group related data together - like a blueprint for objects.</p>
<pre>type Student struct {
    Name   string
    Age    int
    Grade  string
    Marks  []int
}

// Method on struct
func (s Student) Average() float64 {
    total := 0
    for _, m := range s.Marks {
        total += m
    }
    return float64(total) / float64(len(s.Marks))
}

func (s Student) String() string {
    return fmt.Sprintf("%s (Age %d, Grade %s)", s.Name, s.Age, s.Grade)
}

func main() {
    student := Student{
        Name:  "Amrutha",
        Age:   25,
        Grade: "A",
        Marks: []int{90, 85, 92, 88},
    }

    fmt.Println(student)
    fmt.Printf("Average: %.1f\\n", student.Average())
}</pre>`},
  {title:'9. Error Handling', content:`<p>Go handles errors explicitly - no try/catch. Functions return errors as values.</p>
<pre>import (
    "errors"
    "fmt"
    "strconv"
)

func parseAge(input string) (int, error) {
    age, err := strconv.Atoi(input)
    if err != nil {
        return 0, fmt.Errorf("invalid age: %s", input)
    }
    if age < 0 || age > 150 {
        return 0, errors.New("age out of range")
    }
    return age, nil
}

func main() {
    age, err := parseAge("25")
    if err != nil {
        fmt.Println("Error:", err)
        return
    }
    fmt.Println("Age:", age)
}</pre>
<p><strong>Go rule:</strong> Always check <code>err != nil</code> after calling functions that return errors.</p>`},
  {title:'10. Goroutines & Concurrency (Preview)', content:`<p>Go's superpower: run multiple things at the same time easily.</p>
<pre>import (
    "fmt"
    "time"
)

func printNumbers(label string) {
    for i := 1; i <= 3; i++ {
        fmt.Printf("%s: %d\\n", label, i)
        time.Sleep(100 * time.Millisecond)
    }
}

func main() {
    // Run concurrently with 'go' keyword
    go printNumbers("Goroutine 1")
    go printNumbers("Goroutine 2")

    // Main function must wait, otherwise program exits
    time.Sleep(500 * time.Millisecond)
    fmt.Println("Done!")
}</pre>
<p>This is an advanced topic. Learn the basics first, then explore goroutines and channels.</p>`}
]
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RESOURCES DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const RESOURCES = {
python: [
  {title:'Python Official Tutorial',desc:'The official beginner guide from python.org',url:'https://docs.python.org/3/tutorial/',tags:['docs']},
  {title:'W3Schools Python',desc:'Interactive tutorial with try-it-yourself examples',url:'https://www.w3schools.com/python/',tags:['tutorial']},
  {title:'Programiz Python',desc:'Step-by-step lessons with simple explanations',url:'https://www.programiz.com/python-programming',tags:['tutorial']},
  {title:'Python for Beginners - Full Course (YouTube)',desc:'freeCodeCamp 4.5 hour complete Python course',url:'https://www.youtube.com/watch?v=rfscVS0vtbw',tags:['video']},
  {title:'Corey Schafer Python Tutorials',desc:'Excellent YouTube playlist covering all Python basics',url:'https://www.youtube.com/playlist?list=PL-osiE80TeTt2d9bfVyTiXJA-UTHn6WwU',tags:['video']},
  {title:'CS Dojo Python for Beginners',desc:'Simple explanations with practical examples on YouTube',url:'https://www.youtube.com/playlist?list=PLBZBJbE_rGRWeh5mIBhD-hhDwSEDxogDg',tags:['video']},
  {title:'HackerRank Python Practice',desc:'Solve Python challenges and earn badges',url:'https://www.hackerrank.com/domains/python',tags:['practice']},
  {title:'LeetCode Easy Problems',desc:'Practice coding problems sorted by difficulty',url:'https://leetcode.com/problemset/?difficulty=EASY&topicSlugs=array&page=1',tags:['practice']},
  {title:'Real Python Tutorials',desc:'In-depth articles on every Python topic',url:'https://realpython.com/',tags:['tutorial']},
  {title:'Automate the Boring Stuff',desc:'Free online book - learn Python by automating tasks',url:'https://automatetheboringstuff.com/',tags:['book']},
  {title:'Python Crash Course (Book)',desc:'Best-selling physical book for Python beginners',url:'https://nostarch.com/python-crash-course-3rd-edition',tags:['book']},
  {title:'Google Python Class',desc:'Free class from Google for people with some programming experience',url:'https://developers.google.com/edu/python',tags:['tutorial']}
],
sql: [
  {title:'SQLBolt - Interactive Lessons',desc:'Best interactive SQL tutorial for beginners',url:'https://sqlbolt.com/',tags:['tutorial']},
  {title:'W3Schools SQL Tutorial',desc:'Comprehensive tutorial with online SQL editor',url:'https://www.w3schools.com/sql/',tags:['tutorial']},
  {title:'Khan Academy - Intro to SQL',desc:'Video lessons with interactive practice',url:'https://www.khanacademy.org/computing/computer-programming/sql',tags:['video']},
  {title:'SQL for Beginners - Full Course (YouTube)',desc:'freeCodeCamp complete SQL course',url:'https://www.youtube.com/watch?v=HXV3zeQKqGY',tags:['video']},
  {title:'Programming with Mosh - SQL',desc:'Clear, concise 3-hour SQL tutorial on YouTube',url:'https://www.youtube.com/watch?v=7S_tz1z_5bA',tags:['video']},
  {title:'SQLite Online',desc:'Practice SQL directly in browser, no installation needed',url:'https://sqliteonline.com/',tags:['practice']},
  {title:'SQL Fiddle',desc:'Online SQL playground to test queries',url:'http://sqlfiddle.com/',tags:['practice']},
  {title:'HackerRank SQL Practice',desc:'SQL challenges sorted by difficulty',url:'https://www.hackerrank.com/domains/sql',tags:['practice']},
  {title:'Mode SQL Tutorial',desc:'Step-by-step SQL analytics tutorial',url:'https://mode.com/sql-tutorial/',tags:['tutorial']},
  {title:'PostgreSQL Official Docs',desc:'Official documentation for PostgreSQL',url:'https://www.postgresql.org/docs/current/tutorial.html',tags:['docs']},
  {title:'Select Star SQL (Free Book)',desc:'Interactive book to learn SQL through real datasets',url:'https://selectstarsql.com/',tags:['book']},
  {title:'SQL Zoo',desc:'Interactive SQL exercises with grading',url:'https://sqlzoo.net/wiki/SQL_Tutorial',tags:['practice']}
],
golang: [
  {title:'A Tour of Go (Official)',desc:'The best starting point - interactive Go tutorial from Google',url:'https://go.dev/tour/',tags:['tutorial']},
  {title:'Go by Example',desc:'Learn Go through annotated example programs',url:'https://gobyexample.com/',tags:['tutorial']},
  {title:'W3Schools Go Tutorial',desc:'Simple beginner-friendly Go lessons',url:'https://www.w3schools.com/go/',tags:['tutorial']},
  {title:'Learn Go in 12 Minutes (YouTube)',desc:'Quick intro to Go for complete beginners',url:'https://www.youtube.com/watch?v=C8LgvuEBraI',tags:['video']},
  {title:'Go Full Course - freeCodeCamp',desc:'Comprehensive Go course on YouTube',url:'https://www.youtube.com/watch?v=un6ZyFkqFKo',tags:['video']},
  {title:'TechWorld with Nana - Go Tutorial',desc:'Golang for beginners, clear explanations',url:'https://www.youtube.com/watch?v=yyUHQIec83I',tags:['video']},
  {title:'Go Official Documentation',desc:'Official docs and spec from go.dev',url:'https://go.dev/doc/',tags:['docs']},
  {title:'Go Playground',desc:'Write and run Go code directly in the browser',url:'https://go.dev/play/',tags:['practice']},
  {title:'Exercism Go Track',desc:'Free coding exercises with mentor feedback',url:'https://exercism.org/tracks/go',tags:['practice']},
  {title:'Go 101 (Free Book)',desc:'Comprehensive online book about Go programming',url:'https://go101.org/',tags:['book']},
  {title:'The Go Programming Language (Book)',desc:'The definitive Go book by Donovan & Kernighan',url:'https://www.gopl.io/',tags:['book']},
  {title:'Effective Go',desc:'Official guide on writing clean, idiomatic Go code',url:'https://go.dev/doc/effective_go',tags:['docs']}
]
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• QUIZ DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const QUIZZES = {
python: [
  {q:'What does print("Hello") do in Python?',opts:['Saves "Hello" to a file','Displays "Hello" on screen','Creates a variable','Deletes the text'],ans:1,explain:'print() outputs text to the console/screen.'},
  {q:'Which symbol is used for assignment in Python?',opts:['==','=',':=','<-'],ans:1,explain:'Single = assigns a value. Double == compares values.'},
  {q:'What is the output of: x = "5" + "3"?',opts:['8','53','Error','None'],ans:1,explain:'When concatenating strings, "5"+"3" = "53". They are strings, not numbers.'},
  {q:'Which data type is True or False?',opts:['str','int','bool','float'],ans:2,explain:'bool (boolean) stores True or False values.'},
  {q:'How do you get user input in Python?',opts:['scan()','read()','input()','get()'],ans:2,explain:'input() reads text from the user, always returning a string.'},
  {q:'What does range(5) produce?',opts:['1,2,3,4,5','0,1,2,3,4','0,1,2,3,4,5','5,4,3,2,1'],ans:1,explain:'range(5) generates 0,1,2,3,4 â€” starts at 0, stops before 5.'},
  {q:'How do you add "mango" to a list called fruits?',opts:['fruits.add("mango")','fruits.append("mango")','fruits.push("mango")','fruits + "mango"'],ans:1,explain:'append() adds an item to the end of a list.'},
  {q:'What keyword defines a function in Python?',opts:['function','func','def','define'],ans:2,explain:'def is used to define functions: def my_function():'},
  {q:'What does len([1,2,3]) return?',opts:['2','3','4','[1,2,3]'],ans:1,explain:'len() returns the number of items in a list, string, or collection.'},
  {q:'How do you write a comment in Python?',opts:['// comment','/* comment */','# comment','-- comment'],ans:2,explain:'Python uses # for single-line comments.'},
  {q:'What is a Python dictionary?',opts:['A list of words','Key-value pairs','A type of loop','A module'],ans:1,explain:'Dictionaries store data as key:value pairs like {"name": "Alice"}.'},
  {q:'What does "elif" mean?',opts:['Else if','Elephant if','End loop if','Error level if'],ans:0,explain:'elif is short for "else if" â€” checks another condition.'},
  {q:'Which method removes whitespace from a string?',opts:['.clean()','.trim()','.strip()','.remove()'],ans:2,explain:'.strip() removes whitespace from both ends of a string.'},
  {q:'What is the output of: print(type(3.14))?',opts:['<class int>','<class float>','<class str>','<class num>'],ans:1,explain:'3.14 is a decimal number, so its type is float.'},
  {q:'How do you handle errors in Python?',opts:['if/else','try/except','catch/throw','error/handle'],ans:1,explain:'try/except blocks catch and handle errors gracefully.'}
],
sql: [
  {q:'What does SQL stand for?',opts:['Simple Question Language','Structured Query Language','Standard Query Logic','System Query Language'],ans:1,explain:'SQL = Structured Query Language, used to manage databases.'},
  {q:'Which command retrieves data from a table?',opts:['GET','FETCH','SELECT','RETRIEVE'],ans:2,explain:'SELECT is the SQL command to read/retrieve data.'},
  {q:'What does SELECT * mean?',opts:['Select the first column','Select all columns','Delete everything','Count all rows'],ans:1,explain:'* is a wildcard meaning "all columns".'},
  {q:'Which keyword filters rows in a query?',opts:['FILTER','IF','WHERE','HAVING'],ans:2,explain:'WHERE filters individual rows based on conditions.'},
  {q:'How do you sort results alphabetically by name?',opts:['SORT BY name','ORDER BY name','GROUP BY name','ARRANGE BY name'],ans:1,explain:'ORDER BY sorts results. ASC (default) = A to Z, DESC = Z to A.'},
  {q:'What does INSERT INTO do?',opts:['Creates a new table','Adds new rows to a table','Updates existing rows','Deletes rows'],ans:1,explain:'INSERT INTO adds new records/rows to existing tables.'},
  {q:'Which function counts the number of rows?',opts:['SUM()','TOTAL()','COUNT()','NUM()'],ans:2,explain:'COUNT(*) counts how many rows match your query.'},
  {q:'What does JOIN do?',opts:['Combines two databases','Combines rows from two tables','Adds columns','Merges cells'],ans:1,explain:'JOIN combines rows from two or more tables based on related columns.'},
  {q:"What does LIKE 'A%' match?",opts:['Exactly "A"','Ending with A','Starting with A','Containing A'],ans:2,explain:"A% means 'starts with A'. % is a wildcard for any characters."},
  {q:'How do you delete a row where id = 5?',opts:['REMOVE FROM t WHERE id=5','DELETE FROM t WHERE id=5','DROP t WHERE id=5','ERASE FROM t WHERE id=5'],ans:1,explain:'DELETE FROM table WHERE condition removes matching rows.'},
  {q:'What is a PRIMARY KEY?',opts:['The first column','A unique identifier for each row','The table name','A password'],ans:1,explain:'Primary key uniquely identifies each row. No duplicates allowed.'},
  {q:'What does GROUP BY do?',opts:['Groups tables together','Groups rows with same values for aggregation','Sorts results','Filters groups'],ans:1,explain:'GROUP BY groups rows with identical values for use with aggregate functions.'},
  {q:'What is the difference between WHERE and HAVING?',opts:['No difference','WHERE filters rows, HAVING filters groups','WHERE is for numbers only','HAVING is faster'],ans:1,explain:'WHERE filters before grouping, HAVING filters after GROUP BY.'},
  {q:'Which command changes existing data?',opts:['CHANGE','MODIFY','ALTER','UPDATE'],ans:3,explain:'UPDATE table SET column = value WHERE condition changes existing data.'},
  {q:'What does NULL mean in SQL?',opts:['Zero','Empty string','No value / unknown','False'],ans:2,explain:'NULL means the value is missing or unknown. It is not 0 or empty string.'}
],
golang: [
  {q:'Who created the Go programming language?',opts:['Microsoft','Apple','Google','Amazon'],ans:2,explain:'Go was created at Google in 2009 by Griesemer, Pike, and Thompson.'},
  {q:'What is the short variable declaration in Go?',opts:['let x = 5','var x = 5','x := 5','x -> 5'],ans:2,explain:':= declares and assigns a variable with automatic type inference.'},
  {q:'How many loop types does Go have?',opts:['3 (for, while, do-while)','2 (for, while)','1 (for only)','4'],ans:2,explain:'Go only has "for" but it can act as for, while, and for-each.'},
  {q:'What does fmt.Println() do?',opts:['Reads input','Prints text with newline','Formats a string','Creates a file'],ans:1,explain:'fmt.Println() prints output followed by a newline character.'},
  {q:'What is special about Go functions?',opts:['Cannot take parameters','Can return multiple values','Run automatically','No return type needed'],ans:1,explain:'Go functions can return multiple values (commonly result, error).'},
  {q:'What is a Go slice?',opts:['A fixed-size array','A dynamic-size list','A string operation','A type of loop'],ans:1,explain:'Slices are flexible, dynamically-sized views into arrays.'},
  {q:'How do you add to a slice in Go?',opts:['slice.add(item)','slice.push(item)','slice = append(slice, item)','slice += item'],ans:2,explain:'append() returns a new slice; reassign it to preserve changes.'},
  {q:'Every Go program starts from which function?',opts:['func start()','func init()','func main()','func run()'],ans:2,explain:'func main() in package main is the entry point of any Go program.'},
  {q:'What is a struct in Go?',opts:['A type of function','A custom type with named fields','A loop structure','A package'],ans:1,explain:'Structs group related fields together, like a data blueprint.'},
  {q:'How does Go handle errors?',opts:['try/catch blocks','Functions return error values','throw/catch','Error classes'],ans:1,explain:'Go returns errors as values. Check if err != nil after function calls.'},
  {q:'What is a goroutine?',opts:['A type of variable','A lightweight concurrent thread','An error handler','A data structure'],ans:1,explain:'Goroutines are lightweight threads managed by Go runtime, started with "go".'},
  {q:"What does the blank identifier _ do?",opts:['Creates a null variable','Ignores a value','Declares an empty string','Starts a comment'],ans:1,explain:"_ ignores values you don't need, often used with multiple return values."},
  {q:'What is a defer statement?',opts:['Delays program execution','Runs a function when surrounding function exits','Prevents a function from running','Repeats a function'],ans:1,explain:'defer postpones function execution until the surrounding function exits.'},
  {q:'What is an interface in Go?',opts:['A graphical display','A set of method signatures','A data type','A package'],ans:1,explain:'Interfaces define method signatures; types that satisfy them implement them implicitly.'},
  {q:'What keyword creates a constant in Go?',opts:['static','final','const','immutable'],ans:2,explain:'const declares a constant whose value cannot be changed after assignment.'}
]
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXERCISES DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const EXERCISES = {
python: [
  {day:1,title:'Hello & Variables',diff:'easy',task:'Create variables for your name, age, favorite color, and a boolean for whether you like coding. Print them all in a nice formatted sentence using f-strings.',hint:'Use f"My name is {name}" syntax'},
  {day:2,title:'Temperature Converter',diff:'easy',task:'Write a program that asks the user for a temperature in Celsius and converts it to Fahrenheit. Formula: F = (C Ã— 9/5) + 32',hint:'Remember to convert input to float: float(input(...))'},
  {day:3,title:'Even or Odd Checker',diff:'easy',task:'Write a program that takes a number from the user and prints whether it is even or odd. Bonus: also check if it is positive, negative, or zero.',hint:'Use the modulo operator: number % 2 == 0 means even'},
  {day:4,title:'Multiplication Table',diff:'easy',task:'Ask the user for a number and print its multiplication table from 1 to 10 using a for loop.',hint:'for i in range(1, 11): print(f"{num} x {i} = {num*i}")'},
  {day:5,title:'Sum of Numbers',diff:'easy',task:'Write a program that calculates the sum of all numbers from 1 to N, where N is entered by the user.',hint:'Use a for loop with range, or the formula: N*(N+1)//2'},
  {day:6,title:'Guess the Number Game',diff:'medium',task:'Create a number guessing game. The program picks a random number 1-100, and the user guesses until they get it right. Show "too high" or "too low" hints and count attempts.',hint:'import random; secret = random.randint(1, 100)'},
  {day:7,title:'List Operations',diff:'medium',task:'Create a list of 5 student names. Then: (1) Add 2 more names, (2) Remove one, (3) Sort alphabetically, (4) Print the total count and all names.',hint:'Use append(), remove(), sort(), and len()'},
  {day:8,title:'Simple Calculator Function',diff:'medium',task:'Write a function called calculate(a, b, operation) that performs +, -, *, / and returns the result. Handle division by zero. Test with different inputs.',hint:'Use if/elif to check the operation string'},
  {day:9,title:'Word Counter',diff:'medium',task:'Ask the user for a sentence. Count and display: total words, total characters (no spaces), and how many times each word appears.',hint:'Use split() for words, replace(" ","") for char count, and a dictionary for word counts'},
  {day:10,title:'Student Grade Book',diff:'medium',task:'Create a dictionary with 5 student names as keys and a list of 3 marks as values. Calculate and display each student\'s average and the class topper.',hint:'Use a for loop over dict.items()'},
  {day:11,title:'Password Validator',diff:'medium',task:'Write a function that checks if a password is strong: at least 8 chars, has uppercase, lowercase, digit, and special character. Test with 5 passwords.',hint:'Use .isupper(), .islower(), .isdigit() and check for special chars'},
  {day:12,title:'File Reader/Writer',diff:'hard',task:'Create a program that: (1) Writes 5 to-do items to a file, (2) Reads and displays them, (3) Lets user add a new item, (4) Shows updated list.',hint:'Use open() with "w", "r", and "a" modes'},
  {day:13,title:'Mini Contact Book',diff:'hard',task:'Build a contact book using a dictionary of dictionaries. Support: add contact, search by name, list all contacts, and delete a contact.',hint:'contacts = {"name": {"phone": "123", "email": "a@b.com"}}'},
  {day:14,title:'Shopping Cart',diff:'hard',task:'Build a simple shopping cart: add items with prices, remove items, show total, and apply a 10% discount if total > 1000.',hint:'Use a list of dictionaries: [{"item": "Laptop", "price": 50000}]'}
],
sql: [
  {day:1,title:'Create & Insert',diff:'easy',task:'Create a "products" table with columns: id, name, price, category, in_stock (boolean). Insert 8 products across 3 categories.',hint:'Use CREATE TABLE products (id INTEGER PRIMARY KEY, ...)'},
  {day:2,title:'Basic SELECT',diff:'easy',task:'Using your products table: (1) Select all products, (2) Select only names and prices, (3) Select products under price 500, (4) Select products in a specific category.',hint:'SELECT column FROM table WHERE condition'},
  {day:3,title:'Sorting & Limiting',diff:'easy',task:'Sort products by price (highest first), get the top 3 most expensive products, and find the cheapest product.',hint:'ORDER BY price DESC LIMIT 3'},
  {day:4,title:'UPDATE & DELETE',diff:'easy',task:'Update the price of 2 products, change the category of 1 product, and delete all products that are out of stock.',hint:'UPDATE products SET price = 999 WHERE name = "..."'},
  {day:5,title:'Aggregate Functions',diff:'medium',task:'Find: total number of products, average price, most expensive product, cheapest product, total value of all products (sum of prices).',hint:'Use COUNT(), AVG(), MAX(), MIN(), SUM()'},
  {day:6,title:'GROUP BY Practice',diff:'medium',task:'Find: count of products per category, average price per category, category with highest average price.',hint:'SELECT category, COUNT(*) FROM products GROUP BY category'},
  {day:7,title:'Multi-Table Setup',diff:'medium',task:'Create "customers" and "orders" tables. Insert 5 customers and 10 orders (each order linked to a customer_id).',hint:'orders table needs a customer_id column that references customers(id)'},
  {day:8,title:'JOIN Queries',diff:'medium',task:'Write JOINs to: show customer names with their orders, count orders per customer, find customers who ordered more than 2 times.',hint:'SELECT c.name, o.product FROM customers c JOIN orders o ON c.id = o.customer_id'},
  {day:9,title:'LIKE & IN Patterns',diff:'medium',task:'Find: products starting with "S", products containing "pro", products in categories ("Electronics","Books"), products with price between 100-500.',hint:'WHERE name LIKE "S%" / WHERE category IN (...)'},
  {day:10,title:'Subqueries',diff:'hard',task:'Find products priced above average, find the customer who spent the most, find categories where all products are in stock.',hint:'WHERE price > (SELECT AVG(price) FROM products)'},
  {day:11,title:'Create a View',diff:'hard',task:'Create a view called "expensive_products" showing products over 1000. Create another view showing customer order summaries. Query both views.',hint:'CREATE VIEW name AS SELECT ...'},
  {day:12,title:'Library Database',diff:'hard',task:'Build a complete library system: authors, books, members, borrowings tables. Write 10 different queries to answer business questions.',hint:'Think about what a librarian would need to know'},
  {day:13,title:'E-Commerce Schema',diff:'hard',task:'Design tables for: users, products, orders, order_items, reviews. Insert sample data and write queries for: bestsellers, top reviewers, revenue per category.',hint:'order_items links orders to products (many-to-many)'},
  {day:14,title:'Data Analysis',diff:'hard',task:'Using any of your tables, write queries to generate a report: totals, averages, trends, top performers, and formatted output with aliases.',hint:'Combine GROUP BY, ORDER BY, JOIN, and aggregate functions'}
],
golang: [
  {day:1,title:'Hello & Variables',diff:'easy',task:'Create a Go program with variables for your name (string), age (int), GPA (float64), and isStudent (bool). Print them all using fmt.Printf with formatting.',hint:'Use %s for string, %d for int, %f for float, %t for bool'},
  {day:2,title:'Temperature Converter',diff:'easy',task:'Write a Go program that converts Celsius to Fahrenheit. Get input using fmt.Scan. Formula: F = (C Ã— 9/5) + 32',hint:'var celsius float64; fmt.Scan(&celsius)'},
  {day:3,title:'Grade Calculator',diff:'easy',task:'Write a program using if/else that takes marks (0-100) and prints the grade: A(90+), B(80+), C(70+), D(60+), F(below 60).',hint:'if marks >= 90 { ... } else if marks >= 80 { ... }'},
  {day:4,title:'FizzBuzz',diff:'easy',task:'Print numbers 1-50. For multiples of 3 print "Fizz", multiples of 5 print "Buzz", multiples of both print "FizzBuzz".',hint:'Use % (modulo) operator and for loop'},
  {day:5,title:'Slice Operations',diff:'easy',task:'Create a slice of 5 fruits. Append 3 more, print the length, loop through with index, and create a sub-slice of items 2-4.',hint:'fruits := []string{"apple",...}; fruits = append(fruits, "mango")'},
  {day:6,title:'Function Practice',diff:'medium',task:'Write 3 functions: (1) isPrime(n) returns bool, (2) factorial(n) returns int, (3) fibonacci(n) returns a slice of n numbers.',hint:'A prime number is only divisible by 1 and itself'},
  {day:7,title:'Map Word Counter',diff:'medium',task:'Write a program that takes a sentence and counts how many times each word appears using a map[string]int.',hint:'Use strings.Fields() to split words, then loop and increment map values'},
  {day:8,title:'Struct - Student Record',diff:'medium',task:'Create a Student struct with Name, Age, Marks (slice). Add methods: Average(), Grade(), and String(). Create 3 students and display their info.',hint:'func (s Student) Average() float64 { ... }'},
  {day:9,title:'Error Handling',diff:'medium',task:'Write a divide function that returns (float64, error). Handle division by zero. Write a parsePositiveInt function that validates input.',hint:'return 0, fmt.Errorf("cannot divide by zero")'},
  {day:10,title:'CLI Menu App',diff:'medium',task:'Build a command-line menu: (1) Add item, (2) List items, (3) Delete item, (4) Quit. Use a slice to store items and a for loop for the menu.',hint:'Use fmt.Scan for input, switch for menu choices'},
  {day:11,title:'Sorting a Slice',diff:'hard',task:'Implement bubble sort on a slice of integers without using the sort package. Then compare with sort.Ints().',hint:'Nested for loops, swap if arr[j] > arr[j+1]'},
  {day:12,title:'Struct with Methods',diff:'hard',task:'Create a BankAccount struct with Owner, Balance. Methods: Deposit(), Withdraw() (with error if insufficient), Statement(). Use pointer receivers.',hint:'func (a *BankAccount) Deposit(amount float64) { a.Balance += amount }'},
  {day:13,title:'Concurrent Counter',diff:'hard',task:'Create a program that launches 3 goroutines, each counting to 5. Use time.Sleep to see interleaved output.',hint:'go func() { for i := 1; i <= 5; i++ { ... } }()'},
  {day:14,title:'Mini Calculator',diff:'hard',task:'Build a calculator that reads "5 + 3" style input, supports +,-,*,/, handles errors, and loops until user types "quit".',hint:'Use fmt.Scan to read number, operator, number separately'}
]
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BOOKS DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const BOOKS = [
  {title:'Automate the Boring Stuff with Python',author:'Al Sweigart',desc:'Perfect first Python book. Learn by automating everyday tasks. Free online!',tags:['python','book','free'],url:'https://automatetheboringstuff.com/'},
  {title:'Python Crash Course, 3rd Edition',author:'Eric Matthes',desc:'Best-selling intro to Python. Covers basics + 3 projects (game, data viz, web app).',tags:['python','book'],url:'https://nostarch.com/python-crash-course-3rd-edition'},
  {title:'Learn Python the Hard Way',author:'Zed A. Shaw',desc:'Exercise-based approach. Type every example by hand to build muscle memory.',tags:['python','book'],url:'https://learnpythonthehardway.org/'},
  {title:'Head First Python',author:"Paul Barry",desc:'Visual, brain-friendly format. Great if you prefer pictures and diagrams.',tags:['python','book'],url:'https://www.oreilly.com/library/view/head-first-python/9781492051282/'},
  {title:'Learning SQL, 3rd Edition',author:'Alan Beaulieu',desc:'The classic SQL textbook. Covers everything from basics to advanced queries.',tags:['sql','book'],url:'https://www.oreilly.com/library/view/learning-sql-3rd/9781492057604/'},
  {title:'SQL in 10 Minutes a Day',author:'Ben Forta',desc:'Quick, practical lessons. Perfect for beginners who want fast results.',tags:['sql','book'],url:'https://forta.com/books/0135182794/'},
  {title:'Select Star SQL',author:'Zi Chong Kao',desc:'Free interactive online book. Learn SQL using real-world Texas death row data.',tags:['sql','book','free'],url:'https://selectstarsql.com/'},
  {title:'Head First SQL',author:'Lynn Beighley',desc:'Visual learning approach to SQL. Makes database concepts fun and memorable.',tags:['sql','book'],url:'https://www.oreilly.com/library/view/head-first-sql/9780596526849/'},
  {title:'The Go Programming Language',author:'Donovan & Kernighan',desc:'The definitive Go book. Written by a co-creator of C. Thorough and well-written.',tags:['golang','book'],url:'https://www.gopl.io/'},
  {title:'Go 101',author:'Tapir Liu',desc:'Free comprehensive online book covering Go in great detail.',tags:['golang','book','free'],url:'https://go101.org/'},
  {title:'Learning Go, 2nd Edition',author:"Jon Bodner",desc:'Modern Go book focusing on idiomatic patterns and best practices.',tags:['golang','book'],url:'https://www.oreilly.com/library/view/learning-go-2nd/9781098139285/'},
  {title:'Head First Go',author:'Jay McGavren',desc:'Visual, beginner-friendly introduction to Go programming.',tags:['golang','book'],url:'https://headfirstgo.com/'},
  {title:'Clean Code',author:'Robert C. Martin',desc:'Essential reading for any programmer. Learn to write readable, maintainable code.',tags:['python','golang','general'],url:'https://www.oreilly.com/library/view/clean-code-a/9780136083238/'},
  {title:'The Pragmatic Programmer',author:'Hunt & Thomas',desc:'Timeless advice for becoming a better developer. Language-agnostic wisdom.',tags:['general'],url:'https://pragprog.com/titles/tpp20/the-pragmatic-programmer-20th-anniversary-edition/'}
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INIT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function init() {
  renderUserSelect();
  renderAllConcepts();
  renderAllResources();
  renderAllQuizzes();
  renderAllExercises();
  renderBooks();
  renderNotesList();
  renderScores();
  if (localStorage.getItem('dm_dark')==='true') document.body.classList.add('dark');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• USER MANAGEMENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderUserSelect() {
  const sel = document.getElementById('currentUser');
  sel.innerHTML = users.map((u,i) => `<option value="${i}" ${i===currentUserIdx?'selected':''}>${esc(u)}</option>`).join('');
}

function onUserSwitch() {
  currentUserIdx = parseInt(document.getElementById('currentUser').value);
  save('dm_currentUser', currentUserIdx);
  renderScores();
  renderNotesList();
}

function openAddUserModal() { document.getElementById('addUserModal').classList.add('show'); document.getElementById('newUserName').value=''; document.getElementById('newUserName').focus(); }
function showModal(id) { document.getElementById(id).classList.add('show'); }
function closeModal(id) { document.getElementById(id).classList.remove('show'); }

document.getElementById('newUserName').addEventListener('keydown', e => { if(e.key==='Enter') addUser(); if(e.key==='Escape') closeModal('addUserModal'); });

function addUser() {
  const name = document.getElementById('newUserName').value.trim();
  if (!name) return;
  users.push(name);
  save('dm_users', users);
  currentUserIdx = users.length - 1;
  save('dm_currentUser', currentUserIdx);
  closeModal('addUserModal');
  renderUserSelect();
  renderScores();
  renderNotesList();
}

function deleteCurrentUser() {
  if(users.length <= 1){showToast('âš ï¸','Cannot delete the only user.');return;}
  const name = users[currentUserIdx];
  if(!confirm(`Remove "${name}" from comparison? Their data will be kept.`)) return;
  users.splice(currentUserIdx, 1);
  save('dm_users', users);
  currentUserIdx = 0;
  save('dm_currentUser', 0);
  renderUserSelect();
  renderScores();
  renderDashboard();
  showToast('ðŸ—‘ï¸', `${name} removed from comparison.`);
}

function userKey(suffix) { return `${users[currentUserIdx]}_${suffix}`; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAVIGATION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function switchPanel(el) {
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  const panelId = el.dataset.panel;
  document.getElementById(panelId).classList.add('active');
  const titles = {dashboard:'Dashboard',schedule:'30-Day Plan',progressmap:'Progress Map',cheatsheets:'Cheat Sheets',python:'Python',sql:'SQL',golang:'Golang',playground:'Code Playground',typing:'Typing Practice',typingtest:'Typing Speed Test',videos:'Video Tutorials',flashcards:'Flashcards',challenges:'Challenges',miniprojects:'Mini Projects',codeplayground:'Live Playground',codegame:'Code Game',debugex:'Debug Challenge',fillblank:'Fill the Blank',codeorder:'Code Order',peerchallenge:'Peer Challenge',interview:'Interview Prep',interviewquestions:'Interview Questions',learningpath:'Learning Path',errors:'Error Dictionary',compare:'Compare Languages',glossary:'Glossary',prompts:'AI Prompts',chatbot:'AI Chatbot',pomodoro:'Pomodoro Timer',goals:'Weekly Goals',streaktracker:'Streak Tracker',leaderboards:'Leaderboards',analytics:'Analytics',scores:'Scores & Compare',certificate:'Certificate',notes:'Notes & Books',userguide:'User Guide',community:'Community',report:'Progress Report'};
  document.getElementById('topbarTitle').textContent = titles[panelId] || panelId;
  document.querySelector('.sidebar').classList.remove('open');
  if (panelId === 'scores') renderScores();
  if (panelId === 'dashboard') renderDashboard();
  if (panelId === 'schedule') renderSchedule();
  if (panelId === 'playground') loadPgTemplate();
  if (panelId === 'typing') initTyping();
  if (panelId === 'videos') renderVideos();
  if (panelId === 'interview') renderInterviews();
  if (panelId === 'errors') renderErrors();
  if (panelId === 'compare') renderCompareTable();
  if (panelId === 'glossary') renderGlossary();
  if (panelId === 'prompts') renderPrompts();
  if (panelId === 'pomodoro') updatePomoDisplay();
  if (panelId === 'goals') renderGoals();
  if (panelId === 'streaktracker') renderStreakTracker();
  if (panelId === 'leaderboards') renderLeaderboardsFiltered();
  if (panelId === 'codeplayground') renderCodePlayground();
  if (panelId === 'analytics') renderAnalytics();
  if (panelId === 'learningpath') renderLearningPath();
  if (panelId === 'interviewquestions') renderInterviewQuestions();
  if (panelId === 'chatbot') renderChatbot();
  if (panelId === 'certificate') renderCertificate();
  if (panelId === 'community') renderCommunity();
  if (panelId === 'codegame') loadGameQuestion();
  if (panelId === 'flashcards') renderFlashcards();
  if (panelId === 'challenges') renderChallenges();
  if (panelId === 'miniprojects') renderMiniProjects();
  if (panelId === 'progressmap') renderProgressMap();
  if (panelId === 'cheatsheets') renderCheatSheetPanel();
  if (panelId === 'debugex') renderDebugExercises();
  if (panelId === 'fillblank') renderFITB();
  if (panelId === 'codeorder') renderDnD();
  if (panelId === 'peerchallenge') initPeerChallenge();
  if (panelId === 'typingtest') renderTypingTestHistory();
  if (panelId === 'report') {}
  // Re-render cheatsheets and concepts when visiting language panels
  if (['python','sql','golang'].includes(panelId)) { renderAllCheatSheets(); renderAllConcepts(); }
  // Study timer tracking
  trackStudyTime(panelId);
  // Track visited modules for badge
  if (['python','sql','golang'].includes(panelId)) {
    let visited = load('dm_visited_'+users[currentUserIdx],[]);
    if (!visited.includes(panelId)) { visited.push(panelId); save('dm_visited_'+users[currentUserIdx], visited); }
  }
}

function switchTab(btn, module) {
  const parent = btn.closest('.panel');
  parent.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  const tabName = btn.textContent;
  parent.querySelectorAll('.tab-panel').forEach(tp => {
    tp.classList.toggle('active', tp.dataset.module === module && tp.dataset.tab === tabName);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONCEPTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function getConceptDone(mod) { return load('dm_concept_done_'+users[currentUserIdx]+'_'+mod, []); }
function setConceptDone(mod, arr) { save('dm_concept_done_'+users[currentUserIdx]+'_'+mod, arr); }

function toggleConceptDone(mod, idx, ev) {
  ev.stopPropagation();
  let done = getConceptDone(mod);
  if (done.includes(idx)) done = done.filter(x=>x!==idx);
  else { done.push(idx); addXP(15, 'Concept learned'); showToast('ðŸ“š','Concept marked learned! +15 XP'); }
  setConceptDone(mod, done);
  renderAllConcepts();
  renderProgressMap();
}

function renderAllConcepts() {
  for (const mod of ['python','sql','golang']) {
    const el = document.getElementById(mod + 'Concepts');
    const done = getConceptDone(mod);
    const miniQs = CONCEPT_MINI_QUIZZES[mod] || {};
    el.innerHTML = CONCEPTS[mod].map((c,i) => {
      const isDone = done.includes(i);
      const mq = miniQs[i];
      const mqHtml = mq ? `<div class="concept-mini-quiz" onclick="event.stopPropagation()">
        <h5>Quick Check</h5>
        <p style="font-size:.82rem;margin-bottom:.4rem">${esc(mq.q)}</p>
        ${mq.opts.map((o,oi) => `<div class="cmq-option" onclick="checkConceptMiniQuiz(this,'${mod}',${i},${oi},${mq.ans})">${esc(o)}</div>`).join('')}
      </div>` : '';
      return `<div class="concept-card ${isDone?'open':''}">
        <div class="concept-header" onclick="this.parentElement.classList.toggle('open')">
          <span style="display:flex;align-items:center;gap:.5rem">
            <span onclick="toggleConceptDone('${mod}',${i},event)" style="cursor:pointer;font-size:1.1rem">${isDone?'âœ…':'â¬œ'}</span>
            <span>${c.title}</span>
          </span>
          <span class="arrow">â–¶</span>
        </div>
        <div class="concept-body">${c.content}${mqHtml}</div>
      </div>`;
    }).join('');
  }
}

function checkConceptMiniQuiz(el, mod, cIdx, chosen, correct) {
  const parent = el.closest('.concept-mini-quiz');
  if (parent.dataset.answered) return;
  parent.dataset.answered = '1';
  const opts = parent.querySelectorAll('.cmq-option');
  opts.forEach((o,i) => {
    if (i === correct) o.classList.add('cmq-correct');
    else if (i === chosen) o.classList.add('cmq-wrong');
  });
  if (chosen === correct) { addXP(10, 'Concept quiz correct'); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RESOURCES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderAllResources() {
  for (const mod of ['python','sql','golang']) {
    const el = document.getElementById(mod + 'Resources');
    el.innerHTML = RESOURCES[mod].map(r => {
      const tagHtml = r.tags.map(t => `<span class="link-tag tag-${t}">${t}</span>`).join('');
      return `<div class="link-card">
        <div style="margin-bottom:.4rem">${tagHtml}</div>
        <h4>${esc(r.title)}</h4>
        <p>${esc(r.desc)}</p>
        <a href="${r.url}" target="_blank" rel="noopener">Open Resource â†’</a>
      </div>`;
    }).join('');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• QUIZZES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function getQuizState(mod) {
  return load(`dm_quiz_${mod}_${users[currentUserIdx]}`, {});
}
function saveQuizState(mod, state) {
  save(`dm_quiz_${mod}_${users[currentUserIdx]}`, state);
}

function renderAllQuizzes() {
  for (const mod of ['python','sql','golang']) renderQuiz(mod);
}

function renderQuiz(mod) {
  const container = document.getElementById(mod + 'Quiz');
  const state = getQuizState(mod);
  const qs = QUIZZES[mod];
  let score = 0, answered = 0;

  container.innerHTML = qs.map((q,qi) => {
    const key = `q${qi}`;
    const userAns = state[key];
    const isAnswered = userAns !== undefined;
    if (isAnswered) { answered++; if (userAns === q.ans) score++; }

    const optsHtml = q.opts.map((opt, oi) => {
      let cls = 'quiz-option';
      if (isAnswered) {
        if (oi === q.ans) cls += ' correct';
        else if (oi === userAns && userAns !== q.ans) cls += ' wrong';
      } else if (userAns === oi) cls += ' selected';
      return `<div class="${cls}" onclick="answerQuiz('${mod}',${qi},${oi})">
        <div class="quiz-radio"></div><span>${esc(opt)}</span>
      </div>`;
    }).join('');

    return `<div class="quiz-question ${isAnswered?'answered':''}" id="${mod}Q${qi}">
      <h4>Q${qi+1}. ${esc(q.q)}</h4>
      <div class="quiz-options">${optsHtml}</div>
      <div class="quiz-explanation">${esc(q.explain)}</div>
    </div>`;
  }).join('');

  document.getElementById(mod + 'QuizScore').textContent = score;
  document.getElementById(mod + 'QuizProgress').textContent = `${answered} / ${qs.length} answered`;
}

function answerQuiz(mod, qi, oi) {
  const state = getQuizState(mod);
  if (state[`q${qi}`] !== undefined) return;
  state[`q${qi}`] = oi;
  saveQuizState(mod, state);
  renderQuiz(mod);
  // Save score for comparison
  const qs = QUIZZES[mod];
  let score = 0;
  for (let i = 0; i < qs.length; i++) {
    if (state[`q${i}`] === qs[i].ans) score++;
  }
  updateQuizScore(mod, score);
}

function resetQuiz(mod) {
  saveQuizState(mod, {});
  renderQuiz(mod);
}

function updateQuizScore(mod, score) {
  const key = users[currentUserIdx];
  if (!allScores[key]) allScores[key] = {};
  allScores[key][mod + '_quiz'] = score;
  save('dm_scores', allScores);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXERCISES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderAllExercises() {
  for (const mod of ['python','sql','golang']) {
    const el = document.getElementById(mod + 'Exercises');
    const progHints = PROGRESSIVE_HINTS[mod] || {};
    el.innerHTML = EXERCISES[mod].map((ex,ei) => {
      const ph = progHints[ei];
      const hintsHtml = ph ? `
        <details><summary style="cursor:pointer;font-size:.82rem;color:var(--success);font-weight:500">Hint 1 - Gentle Nudge</summary>
        <p style="font-size:.85rem;color:var(--muted);margin-top:.3rem;padding:.5rem;background:rgba(46,196,182,.04);border-radius:6px">${esc(ph[0])}</p></details>
        <details><summary style="cursor:pointer;font-size:.82rem;color:var(--warn);font-weight:500">Hint 2 - Approach</summary>
        <p style="font-size:.85rem;color:var(--muted);margin-top:.3rem;padding:.5rem;background:rgba(255,159,28,.04);border-radius:6px">${esc(ph[1])}</p></details>
        <details><summary style="cursor:pointer;font-size:.82rem;color:var(--danger);font-weight:500">Hint 3 - Near Solution</summary>
        <p style="font-size:.85rem;color:var(--muted);margin-top:.3rem;padding:.5rem;background:rgba(230,57,70,.04);border-radius:6px"><code>${esc(ph[2])}</code></p></details>
      ` : `<details><summary style="cursor:pointer;font-size:.82rem;color:var(--accent);font-weight:500">Show Hint</summary>
        <p style="font-size:.85rem;color:var(--muted);margin-top:.3rem;padding:.5rem;background:rgba(13,148,136,.04);border-radius:6px"><code>${esc(ex.hint)}</code></p></details>`;
      return `<div class="exercise-card">
        <h4><span>Day ${ex.day}: ${esc(ex.title)}</span><span class="diff-badge diff-${ex.diff}">${ex.diff}</span></h4>
        <p style="font-size:.9rem;margin-bottom:.5rem">${esc(ex.task)}</p>
        ${hintsHtml}
      </div>`;
    }).join('');
  }
}

function downloadExercises(mod) {
  const names = {python:'Python',sql:'SQL',golang:'Golang'};
  let text = `${names[mod]} - Daily Practice Exercise Sheet\n${'='.repeat(50)}\n\n`;
  text += `Name: _________________________  Date: ____________\n\n`;
  EXERCISES[mod].forEach(ex => {
    text += `${'â”€'.repeat(50)}\n`;
    text += `DAY ${ex.day}: ${ex.title} [${ex.diff.toUpperCase()}]\n${'â”€'.repeat(50)}\n`;
    text += `Task: ${ex.task}\n\nHint: ${ex.hint}\n\nYour Solution:\n\n\n\n\n`;
  });
  text += `\n${'='.repeat(50)}\nCompleted: ___ / ${EXERCISES[mod].length} exercises\nNotes:\n\n`;
  const blob = new Blob([text], {type: 'text/plain'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `${mod}-exercises.txt`;
  a.click();
  URL.revokeObjectURL(a.href);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCORES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function addScore() {
  const subj = document.getElementById('scoreSubject').value;
  const val = parseInt(document.getElementById('scoreValue').value);
  if (isNaN(val) || val < 0 || val > 15) return;
  const key = users[currentUserIdx];
  if (!allScores[key]) allScores[key] = {};
  if (!allScores[key][subj]) allScores[key][subj] = [];
  allScores[key][subj].push({score: val, date: new Date().toLocaleDateString()});
  save('dm_scores', allScores);
  document.getElementById('scoreValue').value = '';
  renderScores();
}

function renderScores() {
  // Per-user score cards
  const grid = document.getElementById('scoresGrid');
  grid.innerHTML = users.map((user, idx) => {
    const data = allScores[user] || {};
    const subjects = ['python','sql','golang'];
    let totalScore = 0, totalMax = 0;

    const rows = subjects.map(subj => {
      const attempts = data[subj] || [];
      const quizScore = data[subj + '_quiz'] || 0;
      const avgAttempt = attempts.length > 0 ? (attempts.reduce((s,a) => s+a.score, 0) / attempts.length) : 0;
      const combined = attempts.length > 0 ? Math.round((quizScore + avgAttempt) / 2) : quizScore;
      totalScore += combined;
      totalMax += 15;
      return `<div class="score-entry">
        <span>${subj.charAt(0).toUpperCase()+subj.slice(1)}</span>
        <span>Quiz: ${quizScore}/15 | Practice: ${attempts.length > 0 ? avgAttempt.toFixed(1) : '-'}/15</span>
      </div>
      <div class="progress-bg"><div class="progress-fill" style="width:${Math.round(combined/15*100)}%"></div></div>`;
    }).join('');

    const borderColor = idx === currentUserIdx ? 'var(--accent)' : 'var(--border)';
    return `<div class="score-column" style="border-color:${borderColor}">
      <h3 style="color:${idx===0?'var(--accent)':'var(--accent2)'}">${esc(user)} ${idx===currentUserIdx?'(You)':''}</h3>
      ${rows}
      <div class="score-total">${totalScore} / ${totalMax}</div>
    </div>`;
  }).join('');

  // Comparison
  renderComparison();
}

function renderComparison() {
  const section = document.getElementById('compareSection');
  if (users.length < 2) { section.innerHTML = '<p style="color:var(--muted)">Add a second person to compare scores.</p>'; return; }

  const subjects = ['python','sql','golang'];
  let html = '';
  const labels = ['python','sql','golang'];

  labels.forEach(subj => {
    const scores = users.map(user => {
      const data = allScores[user] || {};
      const attempts = data[subj] || [];
      const quizScore = data[subj + '_quiz'] || 0;
      const avgAttempt = attempts.length > 0 ? (attempts.reduce((s,a) => s+a.score, 0) / attempts.length) : 0;
      return Math.round(attempts.length > 0 ? (quizScore + avgAttempt) / 2 : quizScore);
    });

    const total = Math.max(scores[0] + scores[1], 1);
    const pct0 = Math.round(scores[0] / total * 100);
    const pct1 = 100 - pct0;

    html += `<div style="margin-bottom:.8rem">
      <div style="display:flex;justify-content:space-between;font-size:.85rem;margin-bottom:.2rem">
        <span><strong>${esc(users[0])}</strong>: ${scores[0]}</span>
        <span style="text-transform:capitalize;font-weight:600">${subj}</span>
        <span><strong>${esc(users[1])}</strong>: ${scores[1]}</span>
      </div>
      <div class="compare-bar">
        <div class="compare-fill-1" style="width:${pct0}%">${scores[0]>0?scores[0]:''}</div>
        <div class="compare-fill-2" style="width:${pct1}%">${scores[1]>0?scores[1]:''}</div>
      </div>
    </div>`;
  });

  // Overall
  const totals = users.slice(0,2).map(user => {
    const data = allScores[user] || {};
    let t = 0;
    subjects.forEach(subj => {
      const attempts = data[subj] || [];
      const quizScore = data[subj + '_quiz'] || 0;
      const avgAttempt = attempts.length > 0 ? (attempts.reduce((s,a) => s+a.score, 0) / attempts.length) : 0;
      t += Math.round(attempts.length > 0 ? (quizScore + avgAttempt) / 2 : quizScore);
    });
    return t;
  });

  const overallTotal = Math.max(totals[0] + totals[1], 1);
  html += `<div style="margin-top:1rem;padding-top:.8rem;border-top:2px solid var(--border)">
    <div style="display:flex;justify-content:space-between;font-size:.9rem;font-weight:600;margin-bottom:.3rem">
      <span>${esc(users[0])}: ${totals[0]}/45</span>
      <span>OVERALL</span>
      <span>${esc(users[1])}: ${totals[1]}/45</span>
    </div>
    <div class="compare-bar" style="height:36px">
      <div class="compare-fill-1" style="width:${Math.round(totals[0]/overallTotal*100)}%">${totals[0]}</div>
      <div class="compare-fill-2" style="width:${Math.round(totals[1]/overallTotal*100)}%">${totals[1]}</div>
    </div>
    <p style="text-align:center;margin-top:.5rem;font-size:.9rem;font-weight:600;color:${totals[0]>=totals[1]?'var(--accent)':'var(--accent2)'}">
      ${totals[0]===totals[1]?'It\'s a tie!':`${esc(users[totals[0]>totals[1]?0:1])} is leading!`}
    </p>
  </div>`;

  section.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NOTES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function getUserNotes() { return load(`dm_notes_${users[currentUserIdx]}`, []); }
function saveUserNotes(n) { save(`dm_notes_${users[currentUserIdx]}`, n); }

function addNote() {
  const notes = getUserNotes();
  const note = {id: Date.now(), title: 'New Note', content: '', created: new Date().toLocaleDateString()};
  notes.unshift(note);
  saveUserNotes(notes);
  activeNoteId = note.id;
  renderNotesList();
  document.getElementById('noteTitle').focus();
}

function renderNotesList() {
  const notes = getUserNotes();
  const list = document.getElementById('notesList');
  if (notes.length === 0) {
    list.innerHTML = '<div style="padding:1rem;text-align:center;color:var(--muted);font-size:.85rem">No notes yet. Click "+ New" to create one.</div>';
    document.getElementById('noteTitle').value = '';
    document.getElementById('noteContent').value = '';
    activeNoteId = null;
    return;
  }
  if (!activeNoteId || !notes.find(n => n.id === activeNoteId)) activeNoteId = notes[0].id;

  list.innerHTML = notes.map(n => `
    <div class="note-item ${n.id===activeNoteId?'active':''}" onclick="selectNote(${n.id})">
      <span>${esc(n.title || 'Untitled')}</span>
      <button class="note-delete" onclick="event.stopPropagation();deleteNote(${n.id})">âœ•</button>
    </div>`).join('');

  const active = notes.find(n => n.id === activeNoteId);
  if (active) {
    document.getElementById('noteTitle').value = active.title;
    document.getElementById('noteContent').value = active.content;
  }
}

function selectNote(id) {
  saveCurrentNote();
  activeNoteId = id;
  renderNotesList();
}

function saveCurrentNote() {
  if (!activeNoteId) return;
  const notes = getUserNotes();
  const note = notes.find(n => n.id === activeNoteId);
  if (note) {
    note.title = document.getElementById('noteTitle').value;
    note.content = document.getElementById('noteContent').value;
    saveUserNotes(notes);
    const status = document.getElementById('noteStatus');
    status.textContent = 'Saved!';
    setTimeout(() => status.textContent = '', 2000);
  }
  renderNotesList();
}

function deleteNote(id) {
  let notes = getUserNotes();
  notes = notes.filter(n => n.id !== id);
  saveUserNotes(notes);
  if (activeNoteId === id) activeNoteId = null;
  renderNotesList();
}

// Auto-save notes
let noteSaveTimer;
document.getElementById('noteContent').addEventListener('input', () => { clearTimeout(noteSaveTimer); noteSaveTimer = setTimeout(saveCurrentNote, 1500); });
document.getElementById('noteTitle').addEventListener('input', () => { clearTimeout(noteSaveTimer); noteSaveTimer = setTimeout(saveCurrentNote, 1500); });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BOOKS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderBooks() {
  const section = document.getElementById('booksSection');
  const groups = {python:[], sql:[], golang:[], general:[]};
  BOOKS.forEach(b => {
    let placed = false;
    for (const g of ['python','sql','golang','general']) {
      if (b.tags.includes(g)) { groups[g].push(b); placed = true; break; }
    }
    if (!placed) groups.general.push(b);
  });

  const titles = {python:'Python Books',sql:'SQL Books',golang:'Golang Books',general:'General Programming'};
  let html = '';
  for (const [key, books] of Object.entries(groups)) {
    if (books.length === 0) continue;
    html += `<h3 style="margin:1.2rem 0 .8rem;font-size:1rem">${titles[key]}</h3>`;
    html += books.map(b => {
      const tagHtml = b.tags.map(t => `<span class="link-tag tag-${t==='free'?'practice':t==='book'?'book':t}">${t}</span>`).join('');
      return `<div class="book-card">
        <div class="book-icon">ðŸ“–</div>
        <div class="book-info">
          <h4>${esc(b.title)}</h4>
          <p style="font-size:.78rem;color:var(--muted)">by ${esc(b.author)}</p>
          <p>${esc(b.desc)}</p>
          <div class="book-tags">${tagHtml}
            <a href="${b.url}" target="_blank" rel="noopener" style="margin-left:.5rem;font-size:.8rem;color:var(--accent);text-decoration:none">View â†’</a>
          </div>
        </div>
      </div>`;
    }).join('');
  }
  section.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• THEME & EXPORT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function toggleDark() {
  document.body.classList.toggle('dark');
  localStorage.setItem('dm_dark', document.body.classList.contains('dark'));
  updateThemeDots();
}

function setTheme(theme) {
  document.body.classList.remove('theme-purple','theme-sunset','theme-ocean','theme-forest');
  if (theme) document.body.classList.add(theme);
  localStorage.setItem('dm_theme', theme);
  updateThemeDots();
}

function updateThemeDots() {
  var dots = document.querySelectorAll('.theme-dot');
  var themes = ['','theme-purple','theme-sunset','theme-ocean','theme-forest'];
  var current = '';
  for (var i = 0; i < themes.length; i++) {
    if (themes[i] && document.body.classList.contains(themes[i])) { current = themes[i]; break; }
  }
  dots.forEach(function(dot, idx) {
    dot.style.border = (themes[idx] === current) ? '2px solid #fff' : '2px solid transparent';
    dot.style.transform = (themes[idx] === current) ? 'scale(1.2)' : 'scale(1)';
  });
}

function loadSavedTheme() {
  var theme = localStorage.getItem('dm_theme');
  if (theme) { document.body.classList.add(theme); }
  if (localStorage.getItem('dm_dark') === 'true') { document.body.classList.add('dark'); }
  updateThemeDots();
}

function exportAllData() {
  const data = { users, allScores, notes: {} };
  users.forEach(u => { data.notes[u] = load(`dm_notes_${u}`, []); });
  ['python','sql','golang'].forEach(mod => {
    users.forEach(u => {
      if (!data['quizzes']) data.quizzes = {};
      data.quizzes[`${u}_${mod}`] = load(`dm_quiz_${mod}_${u}`, {});
    });
  });
  const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'devmaster-hub-backup.json';
  a.click();
  URL.revokeObjectURL(a.href);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SOUND EFFECTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const sfx = {
  _ctx: null,
  _getCtx() { if (!this._ctx) this._ctx = new (window.AudioContext || window.webkitAudioContext)(); return this._ctx; },
  _play(freq, dur, type='sine', vol=0.15) {
    try { const c=this._getCtx(),o=c.createOscillator(),g=c.createGain(); o.type=type; o.frequency.value=freq; g.gain.value=vol; g.gain.exponentialRampToValueAtTime(0.001,c.currentTime+dur); o.connect(g); g.connect(c.destination); o.start(); o.stop(c.currentTime+dur); } catch(e){}
  },
  correct() { this._play(523,.1); setTimeout(()=>this._play(659,.15),100); setTimeout(()=>this._play(784,.2),200); },
  wrong() { this._play(200,.25,'square',0.1); },
  levelUp() { this._play(523,.12); setTimeout(()=>this._play(659,.12),120); setTimeout(()=>this._play(784,.12),240); setTimeout(()=>this._play(1047,.3),360); },
  badge() { this._play(784,.1); setTimeout(()=>this._play(988,.1),80); setTimeout(()=>this._play(1175,.2),160); },
  click() { this._play(800,.05,'sine',0.05); }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TOAST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(icon, msg) {
  const t = document.getElementById('toast');
  document.getElementById('toastIcon').textContent = icon;
  document.getElementById('toastMsg').textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• XP SYSTEM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getUserXP() { return load('dm_xp_'+users[currentUserIdx], 0); }
function setUserXP(xp) { save('dm_xp_'+users[currentUserIdx], xp); }

function addXP(amount, reason) {
  let xp = getUserXP();
  const oldLevel = getLevel(xp);
  xp += amount;
  setUserXP(xp);
  const newLevel = getLevel(xp);
  if (newLevel > oldLevel) {
    sfx.levelUp();
    showToast('ðŸŽ‰', `Level Up! You reached Level ${newLevel}!`);
    fireConfetti();
  }
  checkBadges();
}

function getLevel(xp) { let lvl=1; while (xp >= lvl*100) { xp -= lvl*100; lvl++; } return lvl; }
function getXPForLevel(lvl) { return lvl * 100; }
function getXPInCurrentLevel(xp) { let lvl=1; while (xp >= lvl*100) { xp -= lvl*100; lvl++; } return xp; }
function getLevelTitle(lvl) {
  if (lvl >= 20) return 'Master';
  if (lvl >= 15) return 'Expert';
  if (lvl >= 10) return 'Advanced';
  if (lvl >= 7) return 'Intermediate';
  if (lvl >= 4) return 'Apprentice';
  return 'Beginner';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STREAK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function recordLogin() {
  const today = new Date().toISOString().slice(0,10);
  let dates = load('dm_streak_dates_'+users[currentUserIdx], []);
  if (!dates.includes(today)) {
    dates.push(today);
    save('dm_streak_dates_'+users[currentUserIdx], dates);
    addXP(50, 'Daily login');
    showToast('ðŸ”¥', 'Daily login! +50 XP');
  }
  // Auto-set streak start to first login date if not set
  if (!load('dm_streak_start_'+users[currentUserIdx], null)) {
    dates.sort();
    save('dm_streak_start_'+users[currentUserIdx], dates[0]);
  }
}

function getStreakStart() {
  return load('dm_streak_start_'+users[currentUserIdx], null);
}

function setStreakStart(dateStr) {
  if (!dateStr) return;
  save('dm_streak_start_'+users[currentUserIdx], dateStr);
  // Re-record today so login dates stay intact
  renderStreakCal();
  renderDashboard();
  showToast('ðŸ”¥', 'Streak start set to ' + dateStr);
}

function resetStreakStart() {
  let dates = load('dm_streak_dates_'+users[currentUserIdx], []);
  if (dates.length > 0) {
    dates.sort();
    save('dm_streak_start_'+users[currentUserIdx], dates[0]);
  } else {
    save('dm_streak_start_'+users[currentUserIdx], new Date().toISOString().slice(0,10));
  }
  renderStreakCal();
  renderDashboard();
  showToast('ðŸ”¥', 'Streak start reset to first login date');
}

function getStreak() {
  const startStr = getStreakStart();
  if (!startStr) return 0;
  const start = new Date(startStr + 'T00:00:00');
  const today = new Date();
  today.setHours(0,0,0,0);
  if (start > today) return 0;
  const diffMs = today - start;
  const diffDays = Math.floor(diffMs / (1000*60*60*24)) + 1;
  return diffDays;
}

function renderStreakCal() {
  const cal = document.getElementById('streakCal');
  if (!cal) return;
  let dates = load('dm_streak_dates_'+users[currentUserIdx], []);
  const startStr = getStreakStart();
  const today = new Date();
  // Update the date picker
  const picker = document.getElementById('streakStartDate');
  if (picker && startStr) picker.value = startStr;
  let html = '';
  for (let i=29; i>=0; i--) {
    const d = new Date(today); d.setDate(d.getDate()-i);
    const ds = d.toISOString().slice(0,10);
    const active = dates.includes(ds);
    const isToday = i === 0;
    const isStart = ds === startStr;
    html += `<div class="streak-day ${active?'active':''} ${isToday?'today':''} ${isStart?'start':''}" title="${ds}${isStart?' (Day 1)':''}"><span class="streak-tip">${ds}${isStart?' Day 1':''}${active?' âœ“':''}</span></div>`;
  }
  cal.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BADGES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const BADGES = [
  {id:'first_steps',icon:'ðŸŽ¯',name:'First Steps',desc:'Answer 1 quiz question'},
  {id:'quiz_whiz',icon:'ðŸ§ ',name:'Quiz Whiz',desc:'Score 10+ on any quiz'},
  {id:'perfect',icon:'ðŸ’¯',name:'Perfect Score',desc:'Get 15/15 on any quiz'},
  {id:'streak_7',icon:'ðŸ”¥',name:'Streak Master',desc:'7-day streak'},
  {id:'streak_14',icon:'ðŸ’ª',name:'Dedicated',desc:'14-day streak'},
  {id:'streak_30',icon:'ðŸ†',name:'Month Master',desc:'30-day streak'},
  {id:'triple',icon:'ðŸŒŸ',name:'Triple Threat',desc:'Try all 3 language quizzes'},
  {id:'fc_50',icon:'ðŸƒ',name:'Flashcard Fan',desc:'Review 50 flashcards'},
  {id:'speed',icon:'âš¡',name:'Speed Demon',desc:'Complete a challenge'},
  {id:'bookworm',icon:'ðŸ“š',name:'Bookworm',desc:'Create 10 notes'},
  {id:'lvl5',icon:'ðŸ…',name:'Level 5',desc:'Reach level 5'},
  {id:'lvl10',icon:'ðŸ‘‘',name:'Level 10',desc:'Reach level 10'},
  {id:'explorer',icon:'ðŸ—ºï¸',name:'Explorer',desc:'Visit all 3 modules'}
];

function getUserBadges() { return load('dm_badges_'+users[currentUserIdx], []); }
function unlockBadge(id) {
  let badges = getUserBadges();
  if (!badges.includes(id)) {
    badges.push(id);
    save('dm_badges_'+users[currentUserIdx], badges);
    const b = BADGES.find(x=>x.id===id);
    sfx.badge();
    showToast(b.icon, `Badge Unlocked: ${b.name}!`);
    fireConfetti();
  }
}

function checkBadges() {
  const u = users[currentUserIdx];
  const xp = getUserXP();
  const lvl = getLevel(xp);
  const streak = getStreak();
  const badges = getUserBadges();
  const notes = load('dm_notes_'+u, []);
  const visited = load('dm_visited_'+u, []);
  const fcReviewed = load('dm_fc_reviewed_'+u, 0);
  const chCompleted = load('dm_ch_completed_'+u, 0);

  // Check quiz-related badges
  let totalAnswered = 0, hasTriple = true;
  for (const mod of ['python','sql','golang']) {
    const state = load(`dm_quiz_${mod}_${u}`, {});
    const answered = Object.keys(state).length;
    totalAnswered += answered;
    if (answered === 0) hasTriple = false;
    let score = 0;
    const qs = QUIZZES[mod];
    for (let i=0; i<qs.length; i++) { if (state[`q${i}`] === qs[i].ans) score++; }
    if (score >= 10) unlockBadge('quiz_whiz');
    if (score >= 15) unlockBadge('perfect');
  }
  if (totalAnswered >= 1) unlockBadge('first_steps');
  if (hasTriple) unlockBadge('triple');
  if (streak >= 7) unlockBadge('streak_7');
  if (streak >= 14) unlockBadge('streak_14');
  if (streak >= 30) unlockBadge('streak_30');
  if (lvl >= 5) unlockBadge('lvl5');
  if (lvl >= 10) unlockBadge('lvl10');
  if (notes.length >= 10) unlockBadge('bookworm');
  if (visited.length >= 3) unlockBadge('explorer');
  if (fcReviewed >= 50) unlockBadge('fc_50');
  if (chCompleted >= 1) unlockBadge('speed');
}

function renderBadges() {
  const grid = document.getElementById('badgeGrid');
  if (!grid) return;
  const unlocked = getUserBadges();
  grid.innerHTML = BADGES.map(b => `<div class="badge-card ${unlocked.includes(b.id)?'unlocked':''}">
    <div class="badge-icon">${b.icon}</div>
    <div class="badge-name">${b.name}</div>
    <div class="badge-desc">${b.desc}</div>
  </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEADERBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderLeaderboard() {
  const lb = document.getElementById('leaderboard');
  if (!lb) return;
  const data = users.map(u => ({name: u, xp: load('dm_xp_'+u, 0)})).sort((a,b) => b.xp - a.xp);
  const medals = ['ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰'];
  lb.innerHTML = data.map((d,i) => `<div class="lb-row rank-${i+1}">
    <div class="lb-rank">${medals[i]||i+1}</div>
    <div class="lb-name">${esc(d.name)}</div>
    <div class="lb-xp">${d.xp} XP â€” Lvl ${getLevel(d.xp)}</div>
  </div>`).join('') || '<p style="color:var(--muted)">No users yet.</p>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DASHBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDashboard() {
  const xp = getUserXP();
  const lvl = getLevel(xp);
  const xpInLvl = getXPInCurrentLevel(xp);
  const xpNeeded = getXPForLevel(lvl);
  const streak = getStreak();
  const badges = getUserBadges();

  let totalQuizScore = 0;
  for (const mod of ['python','sql','golang']) {
    const state = load(`dm_quiz_${mod}_${users[currentUserIdx]}`, {});
    const qs = QUIZZES[mod];
    for (let i=0; i<qs.length; i++) { if (state[`q${i}`] === qs[i].ans) totalQuizScore++; }
  }

  document.getElementById('dashXP').textContent = xp;
  document.getElementById('dashStreak').textContent = streak;
  document.getElementById('dashQuizzes').textContent = totalQuizScore + '/45';
  document.getElementById('dashBadges').textContent = badges.length + '/' + BADGES.length;
  document.getElementById('dashLevel').textContent = lvl;
  document.getElementById('dashLevelText').textContent = lvl;
  document.getElementById('dashLevelTitle').textContent = getLevelTitle(lvl);
  document.getElementById('dashXPBar').style.width = Math.round(xpInLvl/xpNeeded*100) + '%';
  document.getElementById('dashXPBarText').textContent = `${xpInLvl} / ${xpNeeded} XP`;
  document.getElementById('streakCount').textContent = streak;
  document.getElementById('dashConceptPct').textContent = getConceptCompletionPct() + '%';

  renderStreakCal();
  renderBadges();
  renderLeaderboard();
  renderDailyTip();
  renderStudyTimerBar();
  renderStreakMilestones();
  renderQuoteBanner();
  renderProgressRings();
  renderWelcomeBanner();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• 30-DAY SCHEDULE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PLAN_START_DATE = '2026-02-13';
const SCHEDULE = [
  {day:1,lang:'python',icon:'ðŸ',title:'Variables & Data Types',morning:'Read Python.org Variables tutorial, W3Schools Python Syntax',afternoon:'Exercise: Hello World, variable types, temperature converter',evening:'Quiz Q1-Q3, Review flashcards'},
  {day:2,lang:'python',icon:'ðŸ',title:'Input & If/Else',morning:'Read W3Schools: Python Input, Python If...Else',afternoon:'Exercise: Grade calculator, age checker, simple calculator',evening:'Quiz Q4-Q6, Flashcard review'},
  {day:3,lang:'python',icon:'ðŸ',title:'Loops',morning:'Read Programiz: Python for Loop, while Loop',afternoon:'Exercise: Multiplication table, FizzBuzz, guessing game',evening:'Quiz Q7-Q9, Review Day 1-2 concepts'},
  {day:4,lang:'python',icon:'ðŸ',title:'Lists & Functions',morning:'Read W3Schools: Python Lists, Python Functions',afternoon:'Exercise: List operations, function practice, average calculator',evening:'Quiz Q10-Q12, Flashcard review'},
  {day:5,lang:'python',icon:'ðŸ',title:'Dictionaries & Strings',morning:'Read Real Python: Dictionaries, String Methods guide',afternoon:'Exercise: Student report card, word counter, contact book',evening:'Quiz Q13-Q15, Python review'},
  {day:6,lang:'python',icon:'ðŸ',title:'File Handling & Exceptions',morning:'Read W3Schools: Python File Handling, Try/Except',afternoon:'Exercise: Read/write files, error handling, log parser',evening:'Review flashcards, practice exercises'},
  {day:7,lang:'python',icon:'ðŸ',title:'Python Review & Mini Project',morning:'Review all Python concepts from Days 1-6',afternoon:'Mini Project: Build a To-Do List CLI app',evening:'Self-assessment, identify weak areas'},
  {day:8,lang:'sql',icon:'ðŸ—„ï¸',title:'SQL Intro, CREATE & INSERT',morning:'Complete SQLBolt Lessons 1-4, Read W3Schools SQL Intro',afternoon:'Exercise: Create tables, insert data, basic SELECT practice',evening:'Quiz Q1-Q3, SQL flashcards'},
  {day:9,lang:'sql',icon:'ðŸ—„ï¸',title:'SELECT, WHERE & ORDER BY',morning:'SQLBolt Lessons 5-8, W3Schools WHERE, ORDER BY',afternoon:'Exercise: Filter data, sort results, use LIKE patterns',evening:'Quiz Q4-Q6, Review Day 8'},
  {day:10,lang:'sql',icon:'ðŸ—„ï¸',title:'UPDATE, DELETE & Aggregates',morning:'W3Schools UPDATE, DELETE, SQL Functions (COUNT, AVG, SUM)',afternoon:'Exercise: Modify data, aggregate queries, GROUP BY practice',evening:'Quiz Q7-Q9, SQL flashcards'},
  {day:11,lang:'sql',icon:'ðŸ—„ï¸',title:'GROUP BY & JOINs',morning:'SQLBolt Lessons 9-12, W3Schools JOIN tutorial',afternoon:'Exercise: Multi-table queries, JOIN practice, subqueries',evening:'Quiz Q10-Q12, Review all SQL'},
  {day:12,lang:'sql',icon:'ðŸ—„ï¸',title:'Advanced SQL & Subqueries',morning:'Read about Views, Indexes, Subqueries on Mode Analytics',afternoon:'Exercise: Build a Library Database, write 10 complex queries',evening:'Quiz Q13-Q15, Full SQL review'},
  {day:13,lang:'sql',icon:'ðŸ—„ï¸',title:'SQL Window Functions & CTEs',morning:'Read about WINDOW functions, ROW_NUMBER, RANK, CTE syntax',afternoon:'Exercise: Running totals, ranking queries, recursive CTEs',evening:'Practice problems, flashcard review'},
  {day:14,lang:'sql',icon:'ðŸ—„ï¸',title:'SQL Review & Mini Project',morning:'Review all SQL concepts from Days 8-13',afternoon:'Mini Project: Build an Expense Tracker database with reports',evening:'Self-assessment, identify weak areas'},
  {day:15,lang:'golang',icon:'ðŸ”·',title:'Go Basics & Variables',morning:'Complete Go Tour sections 1-5, Read Go by Example: Hello World',afternoon:'Exercise: Hello Go, variables, types, basic math program',evening:'Quiz Q1-Q3, Go flashcards'},
  {day:16,lang:'golang',icon:'ðŸ”·',title:'If/Else, Loops & Switch',morning:'Go Tour sections 6-10, Go by Example: For, If/Else, Switch',afternoon:'Exercise: FizzBuzz, grade calculator, countdown timer',evening:'Quiz Q4-Q6, Review Day 15'},
  {day:17,lang:'golang',icon:'ðŸ”·',title:'Functions & Error Handling',morning:'Go Tour sections 11-16, Go by Example: Functions, Errors',afternoon:'Exercise: Calculator functions, error handling patterns',evening:'Quiz Q7-Q9, Go flashcards'},
  {day:18,lang:'golang',icon:'ðŸ”·',title:'Slices & Arrays',morning:'Go by Example: Arrays, Slices, Range',afternoon:'Exercise: Slice operations, sorting algorithms, filtering',evening:'Practice problems, flashcard review'},
  {day:19,lang:'golang',icon:'ðŸ”·',title:'Maps & Structs',morning:'Go by Example: Maps, Structs, Methods',afternoon:'Exercise: Student struct, word counter map, contact book',evening:'Quiz Q10-Q12, Review Days 15-18'},
  {day:20,lang:'golang',icon:'ðŸ”·',title:'Interfaces & Goroutines',morning:'Go Tour: Interfaces, Concurrency basics',afternoon:'Exercise: Interface practice, simple goroutine programs',evening:'Quiz Q13-Q15, Go review'},
  {day:21,lang:'golang',icon:'ðŸ”·',title:'Go Review & Mini Project',morning:'Review all Go concepts from Days 15-20',afternoon:'Mini Project: Build a CLI Calculator with error handling',evening:'Self-assessment, identify weak areas'},
  {day:22,lang:'python',icon:'ðŸ',title:'Python OOP Basics',morning:'Read W3Schools: Python Classes, Objects, Inheritance',afternoon:'Exercise: Create classes for Bank Account, Student, Library',evening:'Review flashcards, practice exercises'},
  {day:23,lang:'python',icon:'ðŸ',title:'Python Modules & Packages',morning:'Read about importing modules, pip, virtual environments',afternoon:'Exercise: Use datetime, random, json modules in projects',evening:'Practice problems, review'},
  {day:24,lang:'sql',icon:'ðŸ—„ï¸',title:'Database Design & Normalization',morning:'Read about 1NF, 2NF, 3NF, ER diagrams',afternoon:'Exercise: Design a school/hospital database from scratch',evening:'Review, practice schema design'},
  {day:25,lang:'golang',icon:'ðŸ”·',title:'Go Packages & Testing',morning:'Read about Go packages, go test, testing package',afternoon:'Exercise: Write unit tests, create a utility package',evening:'Practice problems, review'},
  {day:26,lang:'python',icon:'ðŸ',title:'Cross-Language Day: Python + SQL',morning:'Read about Python sqlite3 module, connecting to databases',afternoon:'Exercise: Build a Python app that reads/writes SQL database',evening:'Review integration concepts'},
  {day:27,lang:'golang',icon:'ðŸ”·',title:'Cross-Language Day: Go + SQL',morning:'Read about database/sql package in Go',afternoon:'Exercise: Build a Go app that queries a database',evening:'Compare Python vs Go database access'},
  {day:28,lang:'python',icon:'ðŸ',title:'Final Projects Day 1',morning:'Plan your capstone project using all 3 languages',afternoon:'Start building: Python backend + SQL database',evening:'Review progress, plan next steps'},
  {day:29,lang:'golang',icon:'ðŸ”·',title:'Final Projects Day 2',morning:'Continue capstone: Add Go components or alternative implementation',afternoon:'Testing, debugging, polishing your projects',evening:'Prepare presentation of what you built'},
  {day:30,lang:'python',icon:'ðŸŒŸ',title:'Grand Review & Celebration!',morning:'Review ALL concepts across Python, SQL, and Go',afternoon:'Complete any remaining quizzes and challenges',evening:'Generate certificate, celebrate your achievement! ðŸŽ‰'}
];

function renderSchedule() {
  const sel = document.getElementById('currentDaySelect');
  const currentDay = load('dm_schedule_day_'+users[currentUserIdx], 1);
  if (sel) {
    sel.innerHTML = SCHEDULE.map(s => `<option value="${s.day}" ${s.day===currentDay?'selected':''}>Day ${s.day}</option>`).join('');
  }
  const completed = load('dm_schedule_done_'+users[currentUserIdx], []);
  const list = document.getElementById('scheduleList');
  if (!list) return;
  list.innerHTML = SCHEDULE.map(s => {
    const isDone = completed.includes(s.day);
    const isToday = s.day === currentDay;
    return `<div class="sched-day-card ${isDone?'completed':''} ${isToday?'today-card':''}">
      <div class="sched-day-num"><div class="num">${s.day}</div><div class="lang-icon">${s.icon}</div></div>
      <div>
        <div style="font-weight:700;margin-bottom:.3rem">${s.title} ${isDone?'âœ…':''}</div>
        <div style="margin-bottom:.4rem">
          <span class="sched-time-block sched-morning">Morning</span>
          <span style="font-size:.82rem">${esc(s.morning)}</span>
        </div>
        <div style="margin-bottom:.4rem">
          <span class="sched-time-block sched-afternoon">Afternoon</span>
          <span style="font-size:.82rem">${esc(s.afternoon)}</span>
        </div>
        <div style="margin-bottom:.4rem">
          <span class="sched-time-block sched-evening">Evening</span>
          <span style="font-size:.82rem">${esc(s.evening)}</span>
        </div>
        ${!isDone ? `<button class="btn btn-sm btn-success" onclick="completeDay(${s.day})" style="margin-top:.3rem">Mark Complete</button>` : ''}
      </div>
    </div>`;
  }).join('');

  // Today timetable
  const today = SCHEDULE.find(s => s.day === currentDay) || SCHEDULE[0];
  const tt = document.getElementById('todayTimetable');
  if (tt) {
    tt.innerHTML = `
      <div style="display:grid;grid-template-columns:100px 1fr;gap:.5rem;font-size:.88rem">
        <div style="font-weight:600;color:var(--accent)">9:00 - 12:00</div><div><strong>Theory & Reading</strong><br>${esc(today.morning)}</div>
        <div style="font-weight:600;color:var(--warn)">2:00 - 4:00</div><div><strong>Practice & Exercises</strong><br>${esc(today.afternoon)}</div>
        <div style="font-weight:600;color:var(--accent2)">7:00 - 9:00</div><div><strong>Quiz & Review</strong><br>${esc(today.evening)}</div>
      </div>`;
  }
}

function completeDay(day) {
  let done = load('dm_schedule_done_'+users[currentUserIdx], []);
  if (!done.includes(day)) { done.push(day); save('dm_schedule_done_'+users[currentUserIdx], done); }
  let cd = load('dm_schedule_day_'+users[currentUserIdx], 1);
  if (day >= cd && day < 30) { save('dm_schedule_day_'+users[currentUserIdx], day+1); }
  addXP(30, 'Completed day '+day);
  showToast('ðŸ“…', `Day ${day} completed! +30 XP`);
  renderSchedule();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHEAT SHEETS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CHEATSHEETS = {
python: `
<div class="cheat-section"><h4>Data Types</h4>
<table class="cheat-table"><tr><th>Type</th><th>Example</th><th>Description</th></tr>
<tr><td>str</td><td>"hello"</td><td>Text</td></tr>
<tr><td>int</td><td>42</td><td>Whole number</td></tr>
<tr><td>float</td><td>3.14</td><td>Decimal</td></tr>
<tr><td>bool</td><td>True / False</td><td>Boolean</td></tr>
<tr><td>list</td><td>[1, 2, 3]</td><td>Ordered, mutable</td></tr>
<tr><td>dict</td><td>{"a": 1}</td><td>Key-value pairs</td></tr>
<tr><td>tuple</td><td>(1, 2)</td><td>Ordered, immutable</td></tr>
<tr><td>set</td><td>{1, 2, 3}</td><td>Unique items</td></tr>
</table></div>
<div class="cheat-section"><h4>Operators</h4>
<table class="cheat-table"><tr><th>Operator</th><th>Example</th><th>Meaning</th></tr>
<tr><td>+  -  *  /</td><td>5 + 3</td><td>Math operations</td></tr>
<tr><td>//</td><td>7 // 2 = 3</td><td>Floor division</td></tr>
<tr><td>%</td><td>7 % 2 = 1</td><td>Remainder</td></tr>
<tr><td>**</td><td>2 ** 3 = 8</td><td>Power</td></tr>
<tr><td>==  !=</td><td>x == 5</td><td>Equal / Not equal</td></tr>
<tr><td>>  <  >=  <=</td><td>x > 3</td><td>Comparisons</td></tr>
<tr><td>and  or  not</td><td>x > 0 and x < 10</td><td>Logical</td></tr>
</table></div>
<div class="cheat-section"><h4>String Methods</h4>
<table class="cheat-table"><tr><th>Method</th><th>Example</th><th>Result</th></tr>
<tr><td>.upper()</td><td>"hi".upper()</td><td>"HI"</td></tr>
<tr><td>.lower()</td><td>"HI".lower()</td><td>"hi"</td></tr>
<tr><td>.strip()</td><td>" hi ".strip()</td><td>"hi"</td></tr>
<tr><td>.split()</td><td>"a,b".split(",")</td><td>["a","b"]</td></tr>
<tr><td>.replace()</td><td>"hi".replace("h","b")</td><td>"bi"</td></tr>
<tr><td>.find()</td><td>"hello".find("ll")</td><td>2</td></tr>
<tr><td>.count()</td><td>"hello".count("l")</td><td>2</td></tr>
<tr><td>.startswith()</td><td>"hi".startswith("h")</td><td>True</td></tr>
<tr><td>f-strings</td><td>f"Hi {name}"</td><td>Formatted text</td></tr>
</table></div>
<div class="cheat-section"><h4>List Methods</h4>
<table class="cheat-table"><tr><th>Method</th><th>What It Does</th></tr>
<tr><td>.append(x)</td><td>Add x to end</td></tr>
<tr><td>.insert(i, x)</td><td>Insert x at position i</td></tr>
<tr><td>.remove(x)</td><td>Remove first x</td></tr>
<tr><td>.pop()</td><td>Remove & return last item</td></tr>
<tr><td>.sort()</td><td>Sort in place</td></tr>
<tr><td>.reverse()</td><td>Reverse in place</td></tr>
<tr><td>len(list)</td><td>Number of items</td></tr>
<tr><td>list[0]</td><td>First item</td></tr>
<tr><td>list[-1]</td><td>Last item</td></tr>
<tr><td>list[1:3]</td><td>Slice (items 1,2)</td></tr>
</table></div>
<div class="cheat-section"><h4>Control Flow</h4>
<pre>if condition:
    code
elif other:
    code
else:
    code

for item in list:
    code

for i in range(start, stop):
    code

while condition:
    code

def func_name(param):
    return value</pre></div>
<div class="cheat-section"><h4>Common Built-in Functions</h4>
<table class="cheat-table"><tr><th>Function</th><th>Purpose</th></tr>
<tr><td>print()</td><td>Display output</td></tr>
<tr><td>input()</td><td>Get user input</td></tr>
<tr><td>len()</td><td>Length of object</td></tr>
<tr><td>type()</td><td>Check data type</td></tr>
<tr><td>int() float() str()</td><td>Type conversion</td></tr>
<tr><td>range()</td><td>Number sequence</td></tr>
<tr><td>min() max() sum()</td><td>Math on iterables</td></tr>
<tr><td>sorted()</td><td>Return sorted copy</td></tr>
<tr><td>enumerate()</td><td>Index + value loop</td></tr>
<tr><td>zip()</td><td>Pair two lists</td></tr>
</table></div>`,

sql: `
<div class="cheat-section"><h4>Data Definition (DDL)</h4>
<table class="cheat-table"><tr><th>Command</th><th>Syntax</th></tr>
<tr><td>CREATE TABLE</td><td>CREATE TABLE t (col TYPE, ...)</td></tr>
<tr><td>ALTER TABLE</td><td>ALTER TABLE t ADD col TYPE</td></tr>
<tr><td>DROP TABLE</td><td>DROP TABLE t</td></tr>
<tr><td>Types</td><td>INTEGER, REAL, TEXT, BLOB, NULL</td></tr>
<tr><td>Constraints</td><td>PRIMARY KEY, NOT NULL, UNIQUE, DEFAULT</td></tr>
</table></div>
<div class="cheat-section"><h4>Data Manipulation (DML)</h4>
<table class="cheat-table"><tr><th>Command</th><th>Syntax</th></tr>
<tr><td>INSERT</td><td>INSERT INTO t (cols) VALUES (vals)</td></tr>
<tr><td>SELECT</td><td>SELECT cols FROM t WHERE condition</td></tr>
<tr><td>UPDATE</td><td>UPDATE t SET col=val WHERE condition</td></tr>
<tr><td>DELETE</td><td>DELETE FROM t WHERE condition</td></tr>
</table></div>
<div class="cheat-section"><h4>SELECT Clauses (Order Matters!)</h4>
<pre>SELECT columns        -- What to show
FROM table            -- Where to look
WHERE condition       -- Filter rows
GROUP BY column       -- Group rows
HAVING condition      -- Filter groups
ORDER BY column       -- Sort results
LIMIT number          -- Max rows</pre></div>
<div class="cheat-section"><h4>WHERE Operators</h4>
<table class="cheat-table"><tr><th>Operator</th><th>Example</th></tr>
<tr><td>=  !=  >  <  >=  <=</td><td>WHERE age > 20</td></tr>
<tr><td>AND / OR</td><td>WHERE age > 20 AND city = 'X'</td></tr>
<tr><td>BETWEEN</td><td>WHERE age BETWEEN 18 AND 25</td></tr>
<tr><td>IN</td><td>WHERE city IN ('A','B','C')</td></tr>
<tr><td>LIKE</td><td>WHERE name LIKE 'A%'</td></tr>
<tr><td>IS NULL / IS NOT NULL</td><td>WHERE email IS NOT NULL</td></tr>
</table></div>
<div class="cheat-section"><h4>Aggregate Functions</h4>
<table class="cheat-table"><tr><th>Function</th><th>Purpose</th></tr>
<tr><td>COUNT(*)</td><td>Count rows</td></tr>
<tr><td>SUM(col)</td><td>Total of values</td></tr>
<tr><td>AVG(col)</td><td>Average</td></tr>
<tr><td>MIN(col)</td><td>Smallest value</td></tr>
<tr><td>MAX(col)</td><td>Largest value</td></tr>
<tr><td>GROUP BY col</td><td>Group for aggregation</td></tr>
<tr><td>HAVING</td><td>Filter after grouping</td></tr>
</table></div>
<div class="cheat-section"><h4>JOINs</h4>
<pre>-- INNER JOIN: matching rows only
SELECT * FROM a JOIN b ON a.id = b.a_id

-- LEFT JOIN: all from left + matching right
SELECT * FROM a LEFT JOIN b ON a.id = b.a_id

-- Table aliases
SELECT s.name, c.title
FROM students s
JOIN courses c ON s.id = c.student_id</pre></div>
<div class="cheat-section"><h4>LIKE Patterns</h4>
<table class="cheat-table"><tr><th>Pattern</th><th>Matches</th></tr>
<tr><td>'A%'</td><td>Starts with A</td></tr>
<tr><td>'%a'</td><td>Ends with a</td></tr>
<tr><td>'%word%'</td><td>Contains word</td></tr>
<tr><td>'_r%'</td><td>r as 2nd character</td></tr>
</table></div>`,

golang: `
<div class="cheat-section"><h4>Program Structure</h4>
<pre>package main

import "fmt"

func main() {
    fmt.Println("Hello!")
}</pre></div>
<div class="cheat-section"><h4>Variables & Types</h4>
<table class="cheat-table"><tr><th>Type</th><th>Example</th></tr>
<tr><td>string</td><td>var s string = "hi" or s := "hi"</td></tr>
<tr><td>int</td><td>var n int = 42 or n := 42</td></tr>
<tr><td>float64</td><td>var f float64 = 3.14 or f := 3.14</td></tr>
<tr><td>bool</td><td>var b bool = true or b := true</td></tr>
<tr><td>const</td><td>const PI = 3.14</td></tr>
<tr><td>:=</td><td>Short declare + assign (infers type)</td></tr>
</table></div>
<div class="cheat-section"><h4>Control Flow</h4>
<pre>// If / Else (no parentheses needed!)
if x > 10 {
    // code
} else if x > 5 {
    // code
} else {
    // code
}

// Switch
switch day {
case "Mon": fmt.Println("Monday")
case "Sat", "Sun": fmt.Println("Weekend")
default: fmt.Println("Other")
}

// For loop (ONLY loop in Go)
for i := 0; i < 10; i++ { }     // traditional
for condition { }                 // while-style
for { break }                     // infinite
for i, v := range slice { }      // for-each</pre></div>
<div class="cheat-section"><h4>Functions</h4>
<pre>func add(a, b int) int {
    return a + b
}

// Multiple return values
func divide(a, b float64) (float64, error) {
    if b == 0 { return 0, fmt.Errorf("zero!") }
    return a / b, nil
}</pre></div>
<div class="cheat-section"><h4>Slices (Dynamic Arrays)</h4>
<table class="cheat-table"><tr><th>Operation</th><th>Syntax</th></tr>
<tr><td>Create</td><td>s := []int{1, 2, 3}</td></tr>
<tr><td>Append</td><td>s = append(s, 4, 5)</td></tr>
<tr><td>Length</td><td>len(s)</td></tr>
<tr><td>Access</td><td>s[0]  s[len(s)-1]</td></tr>
<tr><td>Slice</td><td>s[1:3]</td></tr>
<tr><td>Make</td><td>s := make([]int, 0, 10)</td></tr>
<tr><td>Range</td><td>for i, v := range s { }</td></tr>
</table></div>
<div class="cheat-section"><h4>Maps</h4>
<pre>m := map[string]int{"a": 1, "b": 2}
m["c"] = 3                      // add
delete(m, "a")                   // delete
val, exists := m["key"]          // check exists
for key, val := range m { }     // loop</pre></div>
<div class="cheat-section"><h4>Structs</h4>
<pre>type Student struct {
    Name string
    Age  int
}

// Method
func (s Student) Greet() string {
    return "Hi, " + s.Name
}

s := Student{Name: "Ammu", Age: 25}
fmt.Println(s.Greet())</pre></div>
<div class="cheat-section"><h4>Error Handling</h4>
<pre>result, err := someFunction()
if err != nil {
    fmt.Println("Error:", err)
    return
}
// use result</pre></div>`
};

function renderAllCheatSheets() {
  for (const mod of ['python','sql','golang']) {
    const el = document.getElementById(mod + 'CheatSheet');
    if (el) el.innerHTML = CHEATSHEETS[mod];
  }
}

function downloadCheatSheet(mod) {
  const names = {python:'Python',sql:'SQL',golang:'Golang'};
  const temp = document.createElement('div');
  temp.innerHTML = CHEATSHEETS[mod];
  let text = `${names[mod]} CHEAT SHEET\n${'='.repeat(50)}\n\n`;
  temp.querySelectorAll('.cheat-section').forEach(sec => {
    const h = sec.querySelector('h4');
    if (h) text += `\n--- ${h.textContent} ---\n`;
    const pre = sec.querySelector('pre');
    if (pre) text += pre.textContent + '\n';
    const rows = sec.querySelectorAll('tr');
    rows.forEach(r => {
      const cells = r.querySelectorAll('th, td');
      text += Array.from(cells).map(c => c.textContent.padEnd(25)).join('| ') + '\n';
    });
    text += '\n';
  });
  const blob = new Blob([text], {type:'text/plain'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `${mod}-cheatsheet.txt`;
  a.click();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CODE PLAYGROUND â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PG_TEMPLATES = {
python: `# Python Playground - Try your code here!
name = "Amrutha"
age = 25

print(f"Hello {name}!")
print(f"You are {age} years old")

# Try: loops, lists, functions
for i in range(5):
    print(f"Count: {i}")`,
sql: `-- SQL Playground
-- (Shows expected output - use sqliteonline.com to run)

SELECT 'Hello SQL!' AS greeting;

CREATE TABLE students (
    id INTEGER PRIMARY KEY,
    name TEXT,
    grade TEXT
);

INSERT INTO students VALUES (1, 'Amrutha', 'A');
INSERT INTO students VALUES (2, 'Rahul', 'B');

SELECT * FROM students WHERE grade = 'A';`,
golang: `// Go Playground
// (Shows expected output - use go.dev/play to run)
package main

import "fmt"

func greet(name string) string {
    return "Hello, " + name + "!"
}

func main() {
    message := greet("Amrutha")
    fmt.Println(message)

    for i := 1; i <= 5; i++ {
        fmt.Printf("Count: %d\\n", i)
    }
}`
};

/* â”€â”€ Python-to-JS transpiler (shared by both playgrounds) â”€â”€ */
function pyExpr(e) {
  if (!e) return e;
  e = e.replace(/f"((?:[^"\\]|\\.)*)"/g, function(_,s){ return '`'+s.replace(/\{/g,'${')+'`'; });
  e = e.replace(/f'((?:[^'\\]|\\.)*)'/g, function(_,s){ return '`'+s.replace(/\{/g,'${')+'`'; });
  e = e.replace(/\.upper\(\)/g,'.toUpperCase()');
  e = e.replace(/\.lower\(\)/g,'.toLowerCase()');
  e = e.replace(/\.strip\(\)/g,'.trim()');
  e = e.replace(/\.startswith\(/g,'.startsWith(');
  e = e.replace(/\.endswith\(/g,'.endsWith(');
  e = e.replace(/\.find\(/g,'.indexOf(');
  e = e.replace(/\.append\(/g,'.push(');
  e = e.replace(/\band\b/g,'&&');
  e = e.replace(/\bor\b/g,'||');
  e = e.replace(/\bnot\s+in\b/g,'_NOTIN_');
  e = e.replace(/\bnot\b/g,'!');
  e = e.replace(/_NOTIN_/g,'not_in');
  return e;
}

function pyToJs(code) {
  var lines = code.split('\n');
  var result = [];
  var indents = [0];

  for (var i = 0; i < lines.length; i++) {
    var raw = lines[i];
    var trimmed = raw.trim();
    if (!trimmed) { result.push(''); continue; }
    if (trimmed.startsWith('#')) { result.push('// ' + trimmed.slice(1).trim()); continue; }

    var indent = 0;
    for (var ci = 0; ci < raw.length; ci++) { if (raw[ci] === ' ') indent++; else if (raw[ci] === '\t') indent += 4; else break; }

    var m;

    // elif / else â€” handle BEFORE general dedent
    if ((m = trimmed.match(/^elif\s+(.+)\s*:$/))) {
      while (indents.length > 1 && indents[indents.length-1] > indent) { indents.pop(); result.push('}'); }
      if (indents.length > 1) indents.pop();
      result.push('}else if('+pyExpr(m[1])+'){');
      indents.push(indent);
      continue;
    }
    if (trimmed === 'else:') {
      while (indents.length > 1 && indents[indents.length-1] > indent) { indents.pop(); result.push('}'); }
      if (indents.length > 1) indents.pop();
      result.push('}else{');
      indents.push(indent);
      continue;
    }

    // General dedent â€” close blocks
    while (indents.length > 1 && indent <= indents[indents.length-1]) { indents.pop(); result.push('}'); }

    // for x in range(...):
    if ((m = trimmed.match(/^for\s+(\w+)\s+in\s+range\((.+)\)\s*:$/))) {
      result.push('for(var '+m[1]+' of range('+pyExpr(m[2])+')){');
      indents.push(indent); continue;
    }
    // for x in iterable:
    if ((m = trimmed.match(/^for\s+(\w+)\s+in\s+(.+)\s*:$/))) {
      result.push('for(var '+m[1]+' of '+pyExpr(m[2])+'){');
      indents.push(indent); continue;
    }
    // while cond:
    if ((m = trimmed.match(/^while\s+(.+)\s*:$/))) {
      result.push('while('+pyExpr(m[1])+'){');
      indents.push(indent); continue;
    }
    // if cond:
    if ((m = trimmed.match(/^if\s+(.+)\s*:$/))) {
      result.push('if('+pyExpr(m[1])+'){');
      indents.push(indent); continue;
    }
    // def func(args):
    if ((m = trimmed.match(/^def\s+(\w+)\s*\(([^)]*)\)\s*:$/))) {
      result.push('function '+m[1]+'('+m[2]+'){');
      indents.push(indent); continue;
    }
    // return
    if ((m = trimmed.match(/^return\s+(.+)$/))) { result.push('return '+pyExpr(m[1])+';'); continue; }
    if (trimmed === 'return') { result.push('return;'); continue; }
    // pass / break / continue
    if (trimmed === 'pass') { result.push(''); continue; }
    if (trimmed === 'break' || trimmed === 'continue') { result.push(trimmed+';'); continue; }
    // augmented assignment +=, -=, etc.
    if ((m = trimmed.match(/^(\w+)\s*(\+|-|\*|\/|%)=\s*(.+)$/))) {
      result.push(m[1]+' '+m[2]+'= '+pyExpr(m[3])+';'); continue;
    }
    // indexed assignment x[i] = val
    if ((m = trimmed.match(/^(\w+\[.+?\])\s*=\s*(.+)$/))) {
      result.push(pyExpr(m[1])+' = '+pyExpr(m[2])+';'); continue;
    }
    // simple assignment x = val
    if ((m = trimmed.match(/^(\w+)\s*=\s*(.+)$/)) && !m[2].startsWith('=')) {
      result.push('var '+m[1]+' = '+pyExpr(m[2])+';'); continue;
    }
    // everything else (print, function calls, etc.)
    result.push(pyExpr(trimmed)+';');
  }

  while (indents.length > 1) { indents.pop(); result.push('}'); }
  return result.join('\n');
}

function executePython(code) {
  var output = [];
  function pyStr(v) {
    if (v === true) return 'True';
    if (v === false) return 'False';
    if (v === null || v === undefined) return 'None';
    if (Array.isArray(v)) return '[' + v.map(pyStr).join(', ') + ']';
    return String(v);
  }
  var _print = function() {
    var args = [];
    for (var a = 0; a < arguments.length; a++) args.push(pyStr(arguments[a]));
    output.push(args.join(' '));
  };
  try {
    var js = pyToJs(code);
    var fn = new Function('print','range','len','input','str','int','float','abs','round','type','sorted','reversed','sum','max','min','list','enumerate','isinstance','True','False','None','not_in', js);
    fn(
      _print,
      function(){var a=arguments,s=0,e,st=1;if(a.length===1)e=a[0];else if(a.length===2){s=a[0];e=a[1]}else{s=a[0];e=a[1];st=a[2]}var r=[];if(st>0)for(var i=s;i<e;i+=st)r.push(i);else for(var i=s;i>e;i+=st)r.push(i);return r},
      function(x){return(typeof x==='string'||Array.isArray(x))?x.length:Object.keys(x).length},
      function(){return 'user_input'},
      function(x){return pyStr(x)},
      function(x){return parseInt(x)},
      function(x){return parseFloat(x)},
      function(x){return Math.abs(x)},
      function(){var a=arguments;return a.length===2?Number(Number(a[0]).toFixed(a[1])):Math.round(a[0])},
      function(x){if(x===null||x===undefined)return"<class 'NoneType'>";if(typeof x==='boolean')return"<class 'bool'>";if(typeof x==='number')return Number.isInteger(x)?"<class 'int'>":"<class 'float'>";if(typeof x==='string')return"<class 'str'>";if(Array.isArray(x))return"<class 'list'>";return"<class '"+typeof x+"'>"},
      function(x){return[...x].sort(function(a,b){return typeof a==='string'?a.localeCompare(b):a-b})},
      function(x){return[...x].reverse()},
      function(x){return Array.isArray(x)?x.reduce(function(a,b){return a+b},0):0},
      function(){var a=[].slice.call(arguments);return a.length===1&&Array.isArray(a[0])?Math.max.apply(null,a[0]):Math.max.apply(null,a)},
      function(){var a=[].slice.call(arguments);return a.length===1&&Array.isArray(a[0])?Math.min.apply(null,a[0]):Math.min.apply(null,a)},
      function(x){return Array.isArray(x)?x.slice():typeof x==='string'?x.split(''):Array.from(x)},
      function(x){return x.map(function(v,i){return[i,v]})},
      function(){return true},
      true, false, null,
      function(val,arr){return!arr.includes(val)}
    );
    return {ok:true, text: output.join('\n') || '(No output)'};
  } catch(e) {
    return {ok:false, text: 'Error: ' + e.message};
  }
}

function loadPgTemplate() {
  const lang = document.getElementById('pgLang').value;
  document.getElementById('pgCode').value = PG_TEMPLATES[lang];
  document.getElementById('pgOutput').textContent = 'Output will appear here...';
}

function clearPg() { document.getElementById('pgCode').value = ''; document.getElementById('pgOutput').textContent = ''; }

function runPlayground() {
  const lang = document.getElementById('pgLang').value;
  const code = document.getElementById('pgCode').value;
  const out = document.getElementById('pgOutput');
  if (!code.trim()) { out.textContent = 'Write some code first!'; out.style.color = 'var(--muted)'; return; }
  if (lang === 'python') {
    const res = executePython(code);
    out.textContent = res.text;
    out.style.color = res.ok ? 'var(--success)' : 'var(--danger)';
  } else {
    out.textContent = '[' + lang.toUpperCase() + ' code preview]\n\nTo run this code:\n' + (lang==='sql'?'Go to sqliteonline.com\nPaste your code and click Run':'Go to go.dev/play\nPaste your code and click Run') + '\n\nYour code looks good! Try it online.';
    out.style.color = 'var(--text)';
  }
  sfx.click();
}

document.getElementById('pgCode')?.addEventListener('keydown', e => {
  if (e.key === 'Tab') { e.preventDefault(); const t=e.target,s=t.selectionStart; t.value=t.value.substring(0,s)+'  '+t.value.substring(t.selectionEnd); t.selectionStart=t.selectionEnd=s+2; }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• POMODORO TIMER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let pomoInterval=null, pomoRunning=false, pomoBreak=false, pomoTime=25*60, pomoCount=load('dm_pomo_count',0);

function updatePomoDisplay() {
  const m=Math.floor(pomoTime/60), s=pomoTime%60;
  const d=document.getElementById('pomoDisplay');
  if(d) d.textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
  const dots=document.getElementById('pomoDots');
  if(dots) { const cnt=Math.min(pomoCount,8); dots.innerHTML=Array.from({length:cnt},()=>'<div class="pomo-dot filled"></div>').join('')+Array.from({length:Math.max(0,4-(cnt%4===0&&cnt>0?4:cnt%4))},()=>'<div class="pomo-dot"></div>').join(''); }
  const sess=document.getElementById('pomoSessions');
  if(sess) sess.textContent='Sessions: '+pomoCount;
}

function togglePomo() {
  if(pomoRunning){clearInterval(pomoInterval);pomoRunning=false;document.getElementById('pomoStartBtn').textContent='Start';document.getElementById('pomoStartBtn').classList.replace('btn-success','btn-primary');return;}
  pomoRunning=true;
  document.getElementById('pomoStartBtn').textContent='Pause';
  document.getElementById('pomoStartBtn').classList.replace('btn-primary','btn-success');
  pomoInterval=setInterval(()=>{
    pomoTime--;
    if(pomoTime<=0){
      clearInterval(pomoInterval); pomoRunning=false;
      document.getElementById('pomoStartBtn').textContent='Start';
      document.getElementById('pomoStartBtn').classList.replace('btn-success','btn-primary');
      sfx.levelUp();
      if(!pomoBreak){ pomoCount++; save('dm_pomo_count',pomoCount); addXP(20,'Pomodoro session'); showToast('ðŸ…','Focus session done! +20 XP');
        pomoBreak=true; pomoTime=(pomoCount%4===0?parseInt(document.getElementById('pomoLong').value)||15:parseInt(document.getElementById('pomoBreak').value)||5)*60;
        document.getElementById('pomoLabel').textContent=pomoCount%4===0?'Long Break':'Short Break';
      } else { pomoBreak=false; pomoTime=(parseInt(document.getElementById('pomoFocus').value)||25)*60; document.getElementById('pomoLabel').textContent='Focus Time'; }
    }
    updatePomoDisplay();
  },1000);
}

function resetPomo(){clearInterval(pomoInterval);pomoRunning=false;pomoBreak=false;pomoTime=(parseInt(document.getElementById('pomoFocus')?.value)||25)*60;document.getElementById('pomoLabel').textContent='Focus Time';const b=document.getElementById('pomoStartBtn');if(b){b.textContent='Start';b.classList.replace('btn-success','btn-primary');}updatePomoDisplay();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TYPING PRACTICE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TYPE_SNIPPETS = {
python: [
  'for i in range(10):\n    print(i)',
  'def greet(name):\n    return "Hello, " + name',
  'fruits = ["apple", "banana"]\nfruits.append("cherry")\nprint(fruits)',
  'if age >= 18:\n    print("Adult")\nelse:\n    print("Minor")',
  'total = sum([1, 2, 3, 4, 5])\nprint(f"Total: {total}")',
  'student = {"name": "Ammu", "age": 25}\nfor k, v in student.items():\n    print(k, v)'
],
sql: [
  'SELECT name, age FROM students\nWHERE grade = \'A\'\nORDER BY name;',
  'INSERT INTO users (name, email)\nVALUES (\'Amrutha\', \'ammu@mail.com\');',
  'SELECT city, COUNT(*) AS total\nFROM students\nGROUP BY city\nHAVING total > 2;',
  'SELECT s.name, c.title\nFROM students s\nJOIN courses c ON s.id = c.student_id;'
],
golang: [
  'func main() {\n    fmt.Println("Hello!")\n}',
  'for i := 0; i < 10; i++ {\n    fmt.Println(i)\n}',
  'name := "Amrutha"\nfmt.Printf("Hi %s!\\n", name)',
  'nums := []int{1, 2, 3}\nnums = append(nums, 4)\nfmt.Println(nums)',
  'if score >= 90 {\n    fmt.Println("Grade A")\n} else {\n    fmt.Println("Try harder")\n}'
]
};

let typeTarget='', typePos=0, typeCorrect=0, typeWrong=0, typeStartTime=0, typeActive=false;

function initTyping() {
  const lang = document.getElementById('typeLang')?.value || 'python';
  const snippets = TYPE_SNIPPETS[lang];
  typeTarget = snippets[Math.floor(Math.random()*snippets.length)];
  typePos=0; typeCorrect=0; typeWrong=0; typeStartTime=0; typeActive=false;
  renderTypeArea();
  document.getElementById('typeWPM').textContent='0';
  document.getElementById('typeAcc').textContent='0%';
  document.getElementById('typeTime').textContent='0s';
}

function renderTypeArea() {
  const area = document.getElementById('typeArea');
  if (!area) return;
  let html = '<div class="type-target">';
  for (let i=0; i<typeTarget.length; i++) {
    let cls = '';
    if (i < typePos) cls = i < typeCorrect + typeWrong ? (typeTarget[i]===typeTarget[i]?'type-correct':'type-wrong') : 'type-correct';
    let ch = typeTarget[i];
    if (ch === '\n') ch = 'â†µ\n';
    if (ch === ' ') ch = '&nbsp;';
    if (i === typePos) html += '<span class="type-cursor">';
    html += `<span class="${i<typePos?'type-correct':''}">${ch}</span>`;
    if (i === typePos) html += '</span>';
  }
  html += '</div>';
  area.innerHTML = html;
}

document.addEventListener('keydown', function typeHandler(e) {
  const area = document.getElementById('typeArea');
  if (!area || !area.matches(':focus') || typePos >= typeTarget.length) return;
  if (e.key === 'Shift' || e.key === 'Control' || e.key === 'Alt' || e.key === 'Meta' || e.key === 'Tab') return;
  e.preventDefault();

  if (!typeActive) { typeActive = true; typeStartTime = Date.now(); }

  let expected = typeTarget[typePos];
  let typed = e.key === 'Enter' ? '\n' : e.key;

  if (typed === expected) { typeCorrect++; typePos++; }
  else if (e.key === 'Backspace') { if(typePos>0){typePos--;} return; }
  else { typeWrong++; typePos++; }

  renderTypeArea();

  // Update stats
  const elapsed = (Date.now()-typeStartTime)/1000;
  const words = typeCorrect / 5;
  const wpm = elapsed > 0 ? Math.round(words/(elapsed/60)) : 0;
  const acc = typePos > 0 ? Math.round(typeCorrect/typePos*100) : 0;
  document.getElementById('typeWPM').textContent = wpm;
  document.getElementById('typeAcc').textContent = acc+'%';
  document.getElementById('typeTime').textContent = Math.round(elapsed)+'s';

  if (typePos >= typeTarget.length) {
    sfx.correct();
    addXP(15, 'Typing practice');
    showToast('âŒ¨ï¸', `Done! ${wpm} WPM, ${acc}% accuracy. +15 XP`);
  }
});

function resetTyping() { initTyping(); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INTERVIEW PREP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const INTERVIEWS = {
python: [
  {q:'What is the difference between a list and a tuple?',a:'Lists are mutable (can be changed), tuples are immutable (cannot be changed). Lists use [], tuples use (). Tuples are faster and used for fixed data.'},
  {q:'What is a dictionary in Python?',a:'A collection of key-value pairs. Keys must be unique and immutable. Access values by key: dict["key"]. Useful for storing structured data.'},
  {q:'Explain list comprehension.',a:'A concise way to create lists: [expression for item in iterable if condition]. Example: squares = [x**2 for x in range(10) if x%2==0] gives [0, 4, 16, 36, 64].'},
  {q:'What are *args and **kwargs?',a:'*args collects extra positional arguments as a tuple. **kwargs collects extra keyword arguments as a dictionary. Used to make flexible functions.'},
  {q:'What is the difference between == and is?',a:'== checks if values are equal. "is" checks if they are the same object in memory. Two lists with same values are == but not "is".'},
  {q:'How does Python handle memory management?',a:'Python uses automatic garbage collection with reference counting. When an object has no references, it is freed. The gc module handles circular references.'},
  {q:'What is a decorator in Python?',a:'A function that modifies another function. Uses @decorator syntax. Common use: @staticmethod, @classmethod, @property, logging, timing.'},
  {q:'Explain try/except/finally.',a:'try: code that might fail. except: handles specific errors. finally: always runs (cleanup). Can have multiple except blocks for different errors.'},
  {q:'What is the difference between append() and extend()?',a:'append() adds one item to the end. extend() adds all items from an iterable. [1,2].append([3,4]) â†’ [1,2,[3,4]]. [1,2].extend([3,4]) â†’ [1,2,3,4].'},
  {q:'What are Python generators?',a:'Functions that use yield instead of return. They produce values lazily (one at a time), saving memory. Created with yield keyword or generator expressions.'}
],
sql: [
  {q:'What is the difference between WHERE and HAVING?',a:'WHERE filters individual rows before grouping. HAVING filters groups after GROUP BY. WHERE cannot use aggregate functions, HAVING can.'},
  {q:'Explain different types of JOINs.',a:'INNER JOIN: only matching rows. LEFT JOIN: all left + matching right. RIGHT JOIN: all right + matching left. FULL JOIN: all rows from both tables.'},
  {q:'What is a primary key vs foreign key?',a:'Primary key: unique identifier for each row, cannot be NULL. Foreign key: column that references another table\'s primary key, creates relationships.'},
  {q:'What is normalization?',a:'Organizing data to reduce redundancy. 1NF: no repeating groups. 2NF: no partial dependencies. 3NF: no transitive dependencies. Makes data consistent.'},
  {q:'What is an index and why use it?',a:'An index speeds up searches on a column, like a book index. Downside: slower INSERT/UPDATE. Use on columns frequently searched or joined on.'},
  {q:'Explain UNION vs UNION ALL.',a:'UNION combines results and removes duplicates. UNION ALL combines results keeping duplicates. UNION ALL is faster because it skips deduplication.'},
  {q:'What is a subquery?',a:'A query inside another query. Can be in WHERE, FROM, or SELECT. Example: SELECT * FROM t WHERE salary > (SELECT AVG(salary) FROM t).'},
  {q:'What is the difference between DELETE, DROP, and TRUNCATE?',a:'DELETE: removes rows (can use WHERE, logged). TRUNCATE: removes all rows (faster, no WHERE). DROP: removes entire table structure.'},
  {q:'What are aggregate functions?',a:'Functions that operate on a set of rows: COUNT(), SUM(), AVG(), MIN(), MAX(). Used with GROUP BY to summarize data per group.'},
  {q:'What is a transaction?',a:'A group of SQL operations that succeed or fail together. Uses BEGIN, COMMIT, ROLLBACK. Ensures data integrity (ACID properties).'}
],
golang: [
  {q:'Why does Go only have for loops?',a:'Simplicity. Go\'s for loop handles all cases: traditional (for i:=0;i<n;i++), while-style (for condition{}), infinite (for{}), and range (for i,v := range slice{}).'},
  {q:'What is a goroutine?',a:'A lightweight thread managed by Go runtime. Started with "go" keyword. Much cheaper than OS threads (2KB stack vs 1MB). Go can run millions of goroutines.'},
  {q:'Explain Go error handling.',a:'Go returns errors as values, no exceptions. Functions return (result, error). Caller checks "if err != nil". Forces explicit error handling at every step.'},
  {q:'What is the difference between arrays and slices?',a:'Arrays have fixed size, slices are dynamic. Slices are references to underlying arrays. Use slices 99% of the time. append() grows slices automatically.'},
  {q:'What is an interface in Go?',a:'A set of method signatures. Any type implementing all methods satisfies the interface automatically (no "implements" keyword). Enables polymorphism.'},
  {q:'What is defer?',a:'Defers function execution until the surrounding function returns. Useful for cleanup: defer file.Close(). Multiple defers execute in LIFO order.'},
  {q:'Explain channels in Go.',a:'Channels are typed conduits for goroutine communication. ch := make(chan int). Send: ch <- 5. Receive: val := <-ch. Can be buffered or unbuffered.'},
  {q:'What is the blank identifier _?',a:'Discards a value. Used when a function returns multiple values but you don\'t need all: _, err := doSomething(). Prevents "unused variable" errors.'},
  {q:'What is a pointer in Go?',a:'Holds memory address of a value. & gets address, * dereferences. Used for: modifying values in functions, avoiding copying large structs, nil checks.'},
  {q:'What makes Go good for backend development?',a:'Fast compilation, built-in concurrency (goroutines), small binary size, strong stdlib (net/http), simple syntax, excellent for microservices and APIs.'}
]
};

function renderInterviews() {
  for (const [lang, qs] of Object.entries(INTERVIEWS)) {
    const el = document.getElementById('interview'+lang.charAt(0).toUpperCase()+lang.slice(1));
    if (!el) continue;
    el.innerHTML = qs.map((q,i)=>`<div class="interview-card" onclick="this.classList.toggle('open')">
      <div class="interview-q"><span>Q${i+1}. ${esc(q.q)}</span><span class="iv-arrow">â–¶</span></div>
      <div class="interview-a"><p style="font-size:.9rem;line-height:1.7;color:var(--muted)">${esc(q.a)}</p></div>
    </div>`).join('');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ERROR DICTIONARY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ERRORS = {
python: [
  {err:'SyntaxError: invalid syntax',cause:'Missing colon, bracket, or quote. Typo in keyword.',fix:'Check for missing : after if/for/def, unmatched brackets (), [], {}, and misspelled keywords.'},
  {err:'NameError: name \'x\' is not defined',cause:'Using a variable before creating it, or typo in name.',fix:'Make sure the variable is defined before use. Check spelling. Variable names are case-sensitive.'},
  {err:'TypeError: can only concatenate str to str',cause:'Trying to add a string and number together.',fix:'Convert number to string first: "Age: " + str(25) or use f-strings: f"Age: {25}"'},
  {err:'IndentationError: unexpected indent',cause:'Inconsistent spaces/tabs in code blocks.',fix:'Use exactly 4 spaces per indent level. Don\'t mix tabs and spaces. Configure editor for spaces.'},
  {err:'IndexError: list index out of range',cause:'Accessing a list position that doesn\'t exist.',fix:'Check list length with len(). Remember lists start at index 0. A list of 3 items has indexes 0,1,2.'},
  {err:'KeyError: \'name\'',cause:'Accessing a dictionary key that doesn\'t exist.',fix:'Use dict.get("key", default) instead of dict["key"], or check with "if key in dict:" first.'},
  {err:'ValueError: invalid literal for int()',cause:'Trying to convert non-numeric text to a number.',fix:'Validate input before converting: if user_input.isdigit(): num = int(user_input)'},
  {err:'ZeroDivisionError: division by zero',cause:'Dividing a number by 0.',fix:'Always check denominator: if b != 0: result = a / b'},
  {err:'TypeError: \'NoneType\' not subscriptable',cause:'Trying to index a None value (variable has no value).',fix:'Check if the variable is None before accessing it. Functions without return give None.'},
  {err:'ModuleNotFoundError: No module named \'x\'',cause:'Module not installed or misspelled.',fix:'Install with: pip install module_name. Check spelling. Make sure you\'re in the right environment.'}
],
sql: [
  {err:'ERROR: syntax error at or near "..."',cause:'SQL keyword misspelled or wrong order of clauses.',fix:'Check SQL clause order: SELECT â†’ FROM â†’ WHERE â†’ GROUP BY â†’ HAVING â†’ ORDER BY â†’ LIMIT'},
  {err:'ERROR: column "x" does not exist',cause:'Typo in column name, or column doesn\'t exist in the table.',fix:'Check column names with: DESCRIBE table; or SELECT * FROM table LIMIT 1;'},
  {err:'ERROR: table "x" already exists',cause:'Trying to create a table that already exists.',fix:'Use: CREATE TABLE IF NOT EXISTS table_name (...); or DROP TABLE first.'},
  {err:'ERROR: NOT NULL constraint failed',cause:'Inserting NULL into a column that requires a value.',fix:'Provide a value for all NOT NULL columns, or set a DEFAULT value in the table definition.'},
  {err:'ERROR: UNIQUE constraint failed',cause:'Inserting a duplicate value in a UNIQUE column.',fix:'Check existing values first. Use INSERT OR REPLACE or INSERT ON CONFLICT for upserts.'},
  {err:'ERROR: no such table: x',cause:'Table doesn\'t exist or wrong database selected.',fix:'Check table exists: .tables (SQLite) or SHOW TABLES (MySQL). Check database connection.'},
  {err:'Cartesian product (too many rows)',cause:'JOIN without ON condition.',fix:'Always specify the JOIN condition: JOIN table2 ON table1.id = table2.foreign_id'},
  {err:'Aggregate function error with GROUP BY',cause:'Selecting a column that\'s not in GROUP BY or an aggregate.',fix:'Every column in SELECT must be in GROUP BY or inside an aggregate function (COUNT, SUM, etc).'}
],
golang: [
  {err:'undefined: x',cause:'Variable or function not declared, or typo.',fix:'Declare before use. Check spelling. Go is case-sensitive. Exported names start with uppercase.'},
  {err:'x declared but not used',cause:'Go doesn\'t allow unused variables.',fix:'Use the variable or delete it. Use _ to discard: _ = unusedVar'},
  {err:'cannot use x (type Y) as type Z',cause:'Type mismatch. Go is strictly typed.',fix:'Convert explicitly: int(floatVar), float64(intVar), string(bytes). No implicit conversion.'},
  {err:'missing return at end of function',cause:'Function declares a return type but some paths don\'t return.',fix:'Ensure every code path (if/else/switch) has a return statement.'},
  {err:'imported and not used: "pkg"',cause:'Imported a package but didn\'t use it.',fix:'Remove unused import, or use blank import: _ "package" if needed for side effects only.'},
  {err:'syntax error: unexpected newline',cause:'Go requires opening { on same line as if/for/func.',fix:'Wrong: if true \\n{ ... }  Right: if true { ... } â€” opening brace must be on same line.'},
  {err:'cannot assign to x',cause:'Trying to modify an immutable value.',fix:'Use pointer receiver for methods that modify struct: func (s *Student) SetName() instead of func (s Student).'},
  {err:'index out of range',cause:'Accessing slice/array beyond its length.',fix:'Check with len(slice) before access. Use range loop to iterate safely.'}
]
};

function renderErrors() {
  for (const [lang, errs] of Object.entries(ERRORS)) {
    const el = document.getElementById('errors'+lang.charAt(0).toUpperCase()+lang.slice(1));
    if (!el) continue;
    el.innerHTML = errs.map(e=>`<div class="err-card">
      <h4>${esc(e.err)}</h4>
      <p style="font-size:.85rem;color:var(--muted)"><strong>Cause:</strong> ${esc(e.cause)}</p>
      <div class="err-fix"><strong>Fix:</strong> ${esc(e.fix)}</div>
    </div>`).join('');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• COMPARE LANGUAGES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCompareTable() {
  const el = document.getElementById('compareTable');
  if (!el) return;
  const rows = [
    ['Print text','print("Hi")','SELECT \'Hi\';','fmt.Println("Hi")'],
    ['Variable','x = 5','-- SET @x = 5 (MySQL)','x := 5'],
    ['String','name = "Ammu"','\'Ammu\'','name := "Ammu"'],
    ['If/Else','if x > 5:\n  print("yes")','CASE WHEN x>5 THEN \'yes\' END','if x > 5 {\n  fmt.Println("yes")\n}'],
    ['For Loop','for i in range(5):\n  print(i)','(Not a loop language)','for i := 0; i < 5; i++ {\n  fmt.Println(i)\n}'],
    ['Array/List','nums = [1,2,3]','(Stored in table rows)','nums := []int{1,2,3}'],
    ['Dictionary/Map','d = {"a": 1}','(Table columns)','m := map[string]int{"a": 1}'],
    ['Function','def add(a,b):\n  return a+b','CREATE FUNCTION (varies)','func add(a,b int) int {\n  return a+b\n}'],
    ['Comment','# comment','-- comment','// comment'],
    ['Get length','len(mylist)','COUNT(*)','len(mySlice)'],
    ['Type check','type(x)','typeof (varies)','fmt.Sprintf("%T", x)'],
    ['Error handling','try/except','(Transaction rollback)','if err != nil { }'],
    ['Null / None','None','NULL','nil'],
    ['String format','f"Hi {name}"','CONCAT (varies)','fmt.Sprintf("Hi %s", name)'],
    ['File type','.py','.sql','.go'],
    ['Run command','python file.py','(Database client)','go run file.go']
  ];
  el.innerHTML = `<table class="cmp-table">
    <tr><th>Concept</th><th>ðŸ Python</th><th>ðŸ—„ï¸ SQL</th><th>ðŸ”· Golang</th></tr>
    ${rows.map(r=>`<tr><td style="font-family:inherit;font-weight:600">${esc(r[0])}</td><td><pre style="margin:0;background:none;padding:0;color:inherit;font-size:inherit">${esc(r[1])}</pre></td><td><pre style="margin:0;background:none;padding:0;color:inherit;font-size:inherit">${esc(r[2])}</pre></td><td><pre style="margin:0;background:none;padding:0;color:inherit;font-size:inherit">${esc(r[3])}</pre></td></tr>`).join('')}
  </table>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GLOSSARY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const GLOSSARY = [
  ['Algorithm','A step-by-step set of instructions to solve a problem'],
  ['API','Application Programming Interface â€” a way for programs to talk to each other'],
  ['Array','A collection of items stored at contiguous memory positions'],
  ['Boolean','A data type with only two values: true or false'],
  ['Bug','An error or flaw in code that causes unexpected behavior'],
  ['Class','A blueprint for creating objects (OOP concept)'],
  ['Compiler','A program that translates source code into machine code'],
  ['Concatenation','Joining two strings together: "hello" + " world"'],
  ['Condition','An expression that evaluates to true or false (used in if statements)'],
  ['Constant','A variable whose value cannot be changed after assignment'],
  ['Database','An organized collection of structured data'],
  ['Debug','The process of finding and fixing bugs in code'],
  ['Dictionary','A collection of key-value pairs (Python) / Map (Go)'],
  ['Float','A number with a decimal point: 3.14'],
  ['Function','A reusable block of code that performs a specific task'],
  ['Git','A version control system for tracking code changes'],
  ['IDE','Integrated Development Environment â€” a code editor with tools'],
  ['Index','The position of an element in a sequence (starts at 0)'],
  ['Integer','A whole number without decimals: 42, -5, 0'],
  ['Iteration','Repeating a process â€” each pass through a loop is one iteration'],
  ['JSON','JavaScript Object Notation â€” a data format: {"key": "value"}'],
  ['Key','The identifier in a key-value pair in a dictionary/map'],
  ['Library','A collection of pre-written code you can use in your programs'],
  ['Loop','Code that repeats: for loop, while loop'],
  ['Method','A function that belongs to an object or class'],
  ['Module','A file containing Python code that can be imported'],
  ['NULL / None / nil','Represents the absence of a value'],
  ['Object','An instance of a class containing data and methods'],
  ['Operator','A symbol that performs an operation: +, -, *, /, ==, !='],
  ['Package','A collection of related modules/files (Go packages, Python packages)'],
  ['Parameter','A variable in a function definition: def func(param)'],
  ['Query','A request for data from a database (SQL query)'],
  ['Recursion','A function that calls itself to solve smaller subproblems'],
  ['Return','Sends a value back from a function to the caller'],
  ['Runtime','The period when a program is executing'],
  ['Scope','Where a variable is accessible in code (local vs global)'],
  ['Slice','A flexible view into an array (Go) / substring operation (Python)'],
  ['SQL','Structured Query Language for managing databases'],
  ['Stack','A data structure: last in, first out (LIFO)'],
  ['String','A sequence of characters: "Hello, World!"'],
  ['Struct','A custom data type grouping related fields (Go)'],
  ['Syntax','The rules for writing valid code in a language'],
  ['Terminal','A text-based interface for running commands'],
  ['Type','The category of data: string, int, float, bool, etc.'],
  ['Variable','A named container that stores a value in memory'],
  ['Version Control','System for tracking changes to code over time (Git)']
];

function renderGlossary() {
  const search = (document.getElementById('glossarySearch')?.value || '').toLowerCase();
  const filtered = GLOSSARY.filter(([term,def]) => term.toLowerCase().includes(search) || def.toLowerCase().includes(search));
  const el = document.getElementById('glossaryList');
  if (!el) return;
  el.innerHTML = filtered.map(([term,def])=>`<div class="glossary-item"><dt>${esc(term)}</dt><dd>${esc(def)}</dd></div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AI PROMPTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const AI_PROMPTS = {
python: [
  {title:'Explain a concept simply',prompt:'Explain Python [TOPIC] like I\'m 5 years old. Use a real-life analogy and give me 3 simple code examples.'},
  {title:'Debug my code',prompt:'I wrote this Python code but it gives an error. Here\'s my code:\n\n[PASTE CODE]\n\nThe error is: [PASTE ERROR]\n\nWhat\'s wrong and how do I fix it?'},
  {title:'Give me practice problems',prompt:'Give me 5 Python practice problems about [TOPIC] for a beginner. Start easy and get harder. Include expected output for each.'},
  {title:'Review my code',prompt:'Review this Python code and tell me:\n1. Is it correct?\n2. How can I make it better?\n3. Any bad practices?\n\n[PASTE CODE]'},
  {title:'Compare two concepts',prompt:'Compare Python [CONCEPT A] vs [CONCEPT B]. When should I use each one? Give me examples of both.'},
  {title:'Build a project step by step',prompt:'Help me build a [PROJECT NAME] in Python step by step. I only know: variables, if/else, loops, lists, functions. Keep it beginner level.'},
  {title:'Explain an error',prompt:'I keep getting this Python error: [ERROR MESSAGE]. Explain what it means in simple words and show me 3 common situations that cause it.'},
  {title:'Create a cheat sheet',prompt:'Create a Python cheat sheet for [TOPIC] with syntax, examples, and common mistakes to avoid.'}
],
sql: [
  {title:'Explain SQL concept',prompt:'Explain SQL [TOPIC] like I\'m organizing files in a cabinet. Use a real-life analogy and show me 3 examples.'},
  {title:'Fix my query',prompt:'My SQL query doesn\'t work. Here\'s what I wrote:\n\n[PASTE QUERY]\n\nExpected: [WHAT YOU WANT]\nGetting: [WHAT YOU GET]\n\nWhat\'s wrong?'},
  {title:'Write a query for me',prompt:'Write a SQL query that: [DESCRIBE WHAT YOU WANT]. Use these tables: [DESCRIBE YOUR TABLES]. Explain each part of the query.'},
  {title:'Practice problems',prompt:'Give me 5 SQL practice problems for a beginner. Include the table setup (CREATE + INSERT) and the questions. Provide answers separately.'},
  {title:'Explain JOINs visually',prompt:'Explain SQL JOINs (INNER, LEFT, RIGHT, FULL) using a simple example with two small tables. Show the result of each JOIN type.'},
  {title:'Design a database',prompt:'Help me design a database for [YOUR PROJECT]. What tables do I need? What columns? How do they relate? Show me the CREATE TABLE statements.'}
],
golang: [
  {title:'Python to Go translation',prompt:'I know Python. Show me how to write this Python code in Go:\n\n[PASTE PYTHON CODE]\n\nExplain the key differences.'},
  {title:'Explain Go concept',prompt:'Explain Go [TOPIC] to a beginner who knows Python. What\'s different? Why does Go do it this way? Show examples.'},
  {title:'Debug Go code',prompt:'My Go code gives this error: [ERROR]. Here\'s the code:\n\n[PASTE CODE]\n\nExplain what\'s wrong and how to fix it.'},
  {title:'Build with Go',prompt:'Help me build a simple [PROJECT] in Go. I\'m a beginner. Use only: variables, if/else, for loops, functions, slices, and structs.'},
  {title:'Goroutines explained',prompt:'Explain Go goroutines and channels like I\'m managing a restaurant kitchen. Keep it simple with a basic code example.'},
  {title:'Go best practices',prompt:'What are the top 10 Go best practices for a beginner? Show a bad example vs good example for each.'}
],
general: [
  {title:'Learning roadmap',prompt:'I\'m learning Python, SQL, and Go as a complete beginner. Create a 30-day learning roadmap. What should I learn each week?'},
  {title:'Compare languages',prompt:'Compare Python, SQL, and Go: When should I use each one? What are they best at? Give me real-world examples.'},
  {title:'Project ideas',prompt:'Give me 10 beginner project ideas that use [Python/SQL/Go]. Sort by difficulty. Describe what I\'ll learn from each.'},
  {title:'Explain like I\'m 5',prompt:'Explain [PROGRAMMING CONCEPT] like I\'m 5 years old. Use toys, food, or everyday objects as analogies.'},
  {title:'Mock interview',prompt:'Give me a mock coding interview for a junior developer position. Ask me 5 questions about [Python/SQL/Go] one at a time. Wait for my answer before the next question.'},
  {title:'Career advice',prompt:'I\'m learning Python, SQL, and Go. What jobs can I get? What should I focus on? What projects should I build for my portfolio?'}
]
};

function renderPrompts() {
  for (const [lang, prompts] of Object.entries(AI_PROMPTS)) {
    const label = lang.charAt(0).toUpperCase()+lang.slice(1);
    const el = document.getElementById('prompts'+label);
    if (!el) continue;
    el.innerHTML = prompts.map((p,i)=>`<div class="prompt-card" onclick="copyPrompt(this,'${esc(p.prompt).replace(/'/g,"\\'")}')">
      <h4>${esc(p.title)} <span class="copied-badge" id="cpb_${lang}_${i}">Copied!</span></h4>
      <div class="prompt-text">${esc(p.prompt)}</div>
    </div>`).join('');
  }
}

function copyPrompt(card, text) {
  navigator.clipboard.writeText(text).then(()=>{
    const badge = card.querySelector('.copied-badge');
    if(badge){badge.classList.add('show');setTimeout(()=>badge.classList.remove('show'),1500);}
    sfx.click();
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WEEKLY GOALS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getGoals() { return load('dm_goals_'+users[currentUserIdx], []); }
function saveGoals(g) { save('dm_goals_'+users[currentUserIdx], g); }

function addGoal() {
  const input = document.getElementById('goalInput');
  const text = input.value.trim();
  if (!text) return;
  const goals = getGoals();
  goals.push({id: Date.now(), text, done: false});
  saveGoals(goals);
  input.value = '';
  renderGoals();
}

document.getElementById('goalInput')?.addEventListener('keydown', e => { if(e.key==='Enter') addGoal(); });

function toggleGoal(id) {
  const goals = getGoals();
  const g = goals.find(x=>x.id===id);
  if(g){ g.done=!g.done; if(g.done){addXP(10,'Goal completed');sfx.correct();} }
  saveGoals(goals);
  renderGoals();
}

function deleteGoal(id) { saveGoals(getGoals().filter(x=>x.id!==id)); renderGoals(); }
function clearCompletedGoals() { saveGoals(getGoals().filter(x=>!x.done)); renderGoals(); }

function renderGoals() {
  const goals = getGoals();
  const el = document.getElementById('goalsList');
  if (!el) return;
  el.innerHTML = goals.length === 0 ? '<p style="color:var(--muted);text-align:center;padding:1rem">No goals yet. Add your first goal above!</p>' :
    goals.map(g=>`<div class="goal-item ${g.done?'done':''}">
      <div class="goal-check" onclick="toggleGoal(${g.id})">${g.done?'âœ“':''}</div>
      <span class="goal-text">${esc(g.text)}</span>
      <button class="task-delete" onclick="deleteGoal(${g.id})" style="background:none;border:none;cursor:pointer;color:#bbb;font-size:.9rem">âœ•</button>
    </div>`).join('');
  const done = goals.filter(g=>g.done).length;
  const prog = document.getElementById('goalsProgress');
  if(prog) prog.textContent = `${done} / ${goals.length} completed`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CERTIFICATE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCertificate() {
  const el = document.getElementById('certPreview');
  if (!el) return;
  const u = users[currentUserIdx];
  const xp = getUserXP();
  const lvl = getLevel(xp);
  let totalQuiz=0, totalPossible=45;
  for (const mod of ['python','sql','golang']) {
    const state = load(`dm_quiz_${mod}_${u}`, {});
    for (let i=0;i<QUIZZES[mod].length;i++){if(state[`q${i}`]===QUIZZES[mod][i].ans)totalQuiz++;}
  }
  const badges = getUserBadges().length;
  const streak = getStreak();
  const completedDays = (load('dm_schedule_done_'+u,[]) || []).length;

  el.innerHTML = `
    <div class="cert-badge">ðŸŽ“</div>
    <div class="cert-title">Certificate of Achievement</div>
    <p class="cert-detail">This certifies that</p>
    <div class="cert-name">${esc(u)}</div>
    <p class="cert-detail">has successfully studied Python, SQL & Golang</p>
    <p class="cert-detail">at the DevMaster Hub</p>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin:1.5rem 0;text-align:center">
      <div><div style="font-size:1.5rem;font-weight:800;color:var(--accent)">${totalQuiz}/${totalPossible}</div><div style="font-size:.72rem;color:var(--muted)">Quiz Score</div></div>
      <div><div style="font-size:1.5rem;font-weight:800;color:var(--accent)">Lvl ${lvl}</div><div style="font-size:.72rem;color:var(--muted)">${xp} XP Earned</div></div>
      <div><div style="font-size:1.5rem;font-weight:800;color:var(--accent)">${badges}/${BADGES.length}</div><div style="font-size:.72rem;color:var(--muted)">Badges Earned</div></div>
    </div>
    <p class="cert-detail">${completedDays}/14 schedule days completed | ${streak}-day streak</p>
    <p class="cert-detail" style="margin-top:1rem;font-size:.78rem">Issued: ${new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'})}</p>
  `;
}

function downloadCertificate() {
  const u = users[currentUserIdx];
  const xp = getUserXP();
  const lvl = getLevel(xp);
  let totalQuiz=0;
  for(const mod of ['python','sql','golang']){const st=load(`dm_quiz_${mod}_${u}`,{});for(let i=0;i<QUIZZES[mod].length;i++){if(st[`q${i}`]===QUIZZES[mod][i].ans)totalQuiz++;}}
  const text = `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CERTIFICATE OF ACHIEVEMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

               ðŸŽ“ CODING ACADEMY ðŸŽ“

            This certifies that

                ${u}

   has successfully studied Python, SQL & Golang

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Quiz Score:  ${totalQuiz} / 45
   Level:       ${lvl} (${xp} XP)
   Badges:      ${getUserBadges().length} / ${BADGES.length}
   Streak:      ${getStreak()} days
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   Issued: ${new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'})}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`;
  const blob = new Blob([text],{type:'text/plain'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `${u}-devmaster-hub-certificate.txt`;
  a.click();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• COMMUNITY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCommunity() {
  const el = document.getElementById('communityGrid');
  if (!el) return;
  const links = [
    {icon:'ðŸ’¬',title:'Stack Overflow',desc:'Ask coding questions and get answers from millions of developers',url:'https://stackoverflow.com/',tags:'Q&A'},
    {icon:'ðŸ',title:'r/learnpython',desc:'Reddit community for Python beginners. Ask questions, share projects.',url:'https://www.reddit.com/r/learnpython/',tags:'Python'},
    {icon:'ðŸ—„ï¸',title:'r/SQL',desc:'Reddit SQL community. Get help with queries, share tips.',url:'https://www.reddit.com/r/SQL/',tags:'SQL'},
    {icon:'ðŸ”·',title:'r/golang',desc:'Reddit Go community. News, tutorials, discussions.',url:'https://www.reddit.com/r/golang/',tags:'Golang'},
    {icon:'ðŸ’»',title:'GitHub',desc:'Host your code, contribute to open source, build your portfolio.',url:'https://github.com/',tags:'Code'},
    {icon:'ðŸŽ®',title:'Discord â€” Python',desc:'Python Discord server â€” real-time help from friendly developers.',url:'https://discord.gg/python',tags:'Chat'},
    {icon:'ðŸŽ®',title:'Discord â€” Gophers',desc:'Go/Golang Discord server for learning and discussion.',url:'https://discord.gg/golang',tags:'Chat'},
    {icon:'ðŸ“º',title:'freeCodeCamp YouTube',desc:'Thousands of free programming tutorials and full courses.',url:'https://www.youtube.com/@freecodecamp',tags:'Videos'},
    {icon:'ðŸ†',title:'HackerRank',desc:'Practice coding challenges, earn badges, prep for interviews.',url:'https://www.hackerrank.com/',tags:'Practice'},
    {icon:'ðŸ†',title:'LeetCode',desc:'Coding problems sorted by difficulty. Essential for interview prep.',url:'https://leetcode.com/',tags:'Practice'},
    {icon:'ðŸŽ“',title:'Exercism',desc:'Free coding exercises with mentor feedback in 50+ languages.',url:'https://exercism.org/',tags:'Practice'},
    {icon:'ðŸ“',title:'Dev.to',desc:'Community of developers sharing articles, tutorials, and ideas.',url:'https://dev.to/',tags:'Blog'}
  ];
  el.innerHTML = links.map(l=>`<div class="comm-card">
    <div class="comm-icon">${l.icon}</div>
    <h4>${esc(l.title)}</h4>
    <p>${esc(l.desc)}</p>
    <a href="${l.url}" target="_blank" rel="noopener" class="btn btn-sm btn-outline">Visit â†’</a>
  </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• VIDEO TUTORIALS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const VIDEOS = [
  // PYTHON - Beginner
  {id:'py1',lang:'python',tags:['beginner'],title:'Python for Beginners â€” Full Course (4.5 hrs)',channel:'freeCodeCamp',duration:'4:26:52',desc:'Complete Python beginner course. Covers variables, loops, functions, OOP, and projects. Best single video to learn Python from scratch.',yt:'rfscVS0vtbw'},
  {id:'py2',lang:'python',tags:['beginner'],title:'Python Tutorial for Absolute Beginners',channel:'Corey Schafer',duration:'6:14:07',desc:'Comprehensive tutorial series compiled. Covers setup, strings, lists, dictionaries, functions, file handling, and more.',yt:'YYXdXT2l-Gg'},
  {id:'py3',lang:'python',tags:['beginner'],title:'Learn Python in 1 Hour',channel:'Programming with Mosh',duration:'1:00:06',desc:'Quick crash course covering all Python essentials. Perfect if you want a fast overview before diving deeper.',yt:'kqtD5dpn9C8'},
  {id:'py4',lang:'python',tags:['beginner'],title:'Python Variables & Data Types Explained',channel:'CS Dojo',duration:'18:36',desc:'Clear explanation of variables, integers, floats, strings, and booleans with practical examples.',yt:'Z1Yd7upQsXY'},
  {id:'py5',lang:'python',tags:['beginner'],title:'If Statements & Conditionals in Python',channel:'Corey Schafer',duration:'16:28',desc:'Master if, elif, else statements with real examples. Covers comparison operators and logical operators.',yt:'DZwmZ8Usvnk'},
  {id:'py6',lang:'python',tags:['beginner'],title:'Python Loops â€” For & While Explained',channel:'Corey Schafer',duration:'10:14',desc:'Learn for loops, while loops, break, continue, and range(). Includes practical exercises.',yt:'6iF8Xb7Z3wQ'},
  {id:'py7',lang:'python',tags:['beginner'],title:'Python Lists, Tuples, and Sets',channel:'Corey Schafer',duration:'29:05',desc:'Everything about Python collections: creating, accessing, modifying lists, tuples, and sets.',yt:'W8KRzm-HUcc'},
  {id:'py8',lang:'python',tags:['beginner'],title:'Python Functions â€” How to Write Them',channel:'Corey Schafer',duration:'21:48',desc:'Complete guide to functions: parameters, return values, default arguments, *args and **kwargs.',yt:'9Os0o3wzS_I'},
  {id:'py9',lang:'python',tags:['beginner'],title:'Python Dictionaries â€” Complete Guide',channel:'Corey Schafer',duration:'9:59',desc:'Learn dictionaries: creating, accessing, looping, methods, and nested dictionaries.',yt:'daefaLgNkw0'},
  // PYTHON - Projects
  {id:'py10',lang:'python',tags:['project'],title:'12 Beginner Python Projects in 3 Hours',channel:'freeCodeCamp',duration:'3:00:32',desc:'Build 12 real projects: madlibs, guessing game, tic-tac-toe, sudoku solver, web scraper, and more.',yt:'8ext9G7xspg'},
  {id:'py11',lang:'python',tags:['project'],title:'Build a Python To-Do App (Beginner Project)',channel:'Tech With Tim',duration:'32:15',desc:'Step-by-step project building a command-line to-do list application using Python basics.',yt:'Vm0sEOlpVWk'},

  // SQL - Beginner
  {id:'sq1',lang:'sql',tags:['beginner'],title:'SQL Full Course for Beginners (4 hrs)',channel:'freeCodeCamp',duration:'4:20:37',desc:'Complete SQL tutorial covering databases, tables, queries, joins, and more. Uses MySQL but concepts apply everywhere.',yt:'HXV3zeQKqGY'},
  {id:'sq2',lang:'sql',tags:['beginner'],title:'SQL Tutorial for Beginners (3 hrs)',channel:'Programming with Mosh',duration:'3:10:19',desc:'Clear, well-structured SQL course. Covers SELECT, WHERE, JOIN, GROUP BY, subqueries with real examples.',yt:'7S_tz1z_5bA'},
  {id:'sq3',lang:'sql',tags:['beginner'],title:'Learn SQL in 60 Minutes',channel:'Web Dev Simplified',duration:'56:24',desc:'Fast-paced introduction covering all essential SQL commands. Great for a quick overview.',yt:'p3qvj9hO_Bo'},
  {id:'sq4',lang:'sql',tags:['beginner'],title:'SQL SELECT Statement â€” Complete Guide',channel:'Socratica',duration:'5:20',desc:'Short, focused lesson on the most important SQL command. Clear visuals and examples.',yt:'YufocuHbYZo'},
  {id:'sq5',lang:'sql',tags:['beginner'],title:'SQL JOINs Explained â€” Inner, Left, Right, Full',channel:'Socratica',duration:'4:24',desc:'Visual explanation of all JOIN types with diagrams. The clearest JOIN tutorial for beginners.',yt:'9yeOJ0ZMUYw'},
  {id:'sq6',lang:'sql',tags:['beginner'],title:'SQL GROUP BY and Aggregate Functions',channel:'kudvenkat',duration:'9:32',desc:'Learn COUNT, SUM, AVG, MIN, MAX with GROUP BY. Practical examples with step-by-step explanation.',yt:'gweGMVMgWBA'},
  {id:'sq7',lang:'sql',tags:['beginner'],title:'SQL WHERE, AND, OR, NOT â€” Filter Data',channel:'Bro Code',duration:'7:11',desc:'Learn to filter data with conditions. Covers comparison operators, BETWEEN, IN, LIKE patterns.',yt:'MFkqBSCmFOo'},
  // SQL - Projects
  {id:'sq8',lang:'sql',tags:['project'],title:'SQL Project â€” Build a Database From Scratch',channel:'freeCodeCamp',duration:'1:01:26',desc:'Hands-on project: design a company database, create tables, insert data, write complex queries.',yt:'p3qvj9hO_Bo'},
  {id:'sq9',lang:'sql',tags:['project','beginner'],title:'SQL Practice â€” Solve 5 Problems Step by Step',channel:'techTFQ',duration:'22:45',desc:'Walk through 5 SQL practice problems with detailed solutions. Great for building confidence.',yt:'YYSA03MFWjA'},

  // GOLANG - Beginner
  {id:'go1',lang:'golang',tags:['beginner'],title:'Go Programming â€” Full Course for Beginners',channel:'freeCodeCamp',duration:'6:39:53',desc:'Comprehensive Go course covering all fundamentals: variables, functions, structs, interfaces, goroutines, and more.',yt:'un6ZyFkqFKo'},
  {id:'go2',lang:'golang',tags:['beginner'],title:'Go Tutorial for Beginners (Golang)',channel:'TechWorld with Nana',duration:'3:24:08',desc:'Practical Go tutorial with clear explanations. Covers setup, syntax, data types, functions, packages, and concurrency.',yt:'yyUHQIec83I'},
  {id:'go3',lang:'golang',tags:['beginner'],title:'Learn Go in 12 Minutes',channel:'Jake Wright',duration:'11:54',desc:'Lightning-fast introduction to Go. Perfect to understand what Go is about before committing to a full course.',yt:'C8LgvuEBraI'},
  {id:'go4',lang:'golang',tags:['beginner'],title:'Golang Variables & Data Types',channel:'Golang Dojo',duration:'14:22',desc:'Focused tutorial on Go variables: var keyword, short declaration, types, constants, and zero values.',yt:'pM0-CMysa_M'},
  {id:'go5',lang:'golang',tags:['beginner'],title:'Go Functions â€” Parameters & Multiple Returns',channel:'Golang Dojo',duration:'16:45',desc:'Learn Go functions: parameters, return values, multiple returns, named returns, and variadic functions.',yt:'feU9DQNoKGE'},
  {id:'go6',lang:'golang',tags:['beginner'],title:'Go Slices & Arrays Explained',channel:'Golang Dojo',duration:'19:30',desc:'Master arrays vs slices, append, length vs capacity, range loops, and slice tricks.',yt:'TiMkZv5LpIQ'},
  {id:'go7',lang:'golang',tags:['beginner'],title:'Go Structs and Interfaces for Beginners',channel:'TechWorld with Nana',duration:'25:13',desc:'Learn custom types with structs and polymorphism with interfaces. Core Go concepts made simple.',yt:'lbW-KVdImaI'},
  // GOLANG - Projects
  {id:'go8',lang:'golang',tags:['project'],title:'Build a REST API in Go (Beginner Project)',channel:'TechWorld with Nana',duration:'45:36',desc:'Build your first Go web server and REST API from scratch. Great hands-on project for beginners.',yt:'d_L64KT3SFM'},
  {id:'go9',lang:'golang',tags:['project'],title:'Go CLI App â€” Build a To-Do List',channel:'Golang Dojo',duration:'28:42',desc:'Create a command-line to-do app in Go. Practice structs, slices, user input, and file handling.',yt:'j1CXoOqXIBo'},

  // GENERAL
  {id:'gen1',lang:'general',tags:['beginner'],title:'How to Learn Programming â€” 7 Tips',channel:'Fireship',duration:'5:46',desc:'Essential advice for beginner programmers. How to study effectively, avoid tutorial hell, and actually build things.',yt:'NtfbWkxJTHw'},
  {id:'gen2',lang:'general',tags:['beginner'],title:'What is Programming? (Explained Simply)',channel:'Aaron Jack',duration:'8:29',desc:'Perfect first video. Explains what code is, how computers work, and why we need programming languages.',yt:'FCMxA-MQIag'},
  {id:'gen3',lang:'general',tags:['beginner'],title:'VS Code Setup for Beginners',channel:'James Q Quick',duration:'12:38',desc:'Set up Visual Studio Code for Python, SQL, and Go development. Extensions, themes, and tips.',yt:'B-s71n0dHUk'},
  {id:'gen4',lang:'general',tags:['beginner'],title:'Git & GitHub for Beginners â€” Crash Course',channel:'freeCodeCamp',duration:'1:08:29',desc:'Learn version control with Git: commits, branches, push, pull, and GitHub. Essential skill for all developers.',yt:'RGOj5yH7evk'}
];

let videoFilter = 'all';

function renderVideos() {
  const grid = document.getElementById('videoGrid');
  if (!grid) return;
  let filtered = VIDEOS;
  if (videoFilter !== 'all') {
    filtered = VIDEOS.filter(v => v.lang === videoFilter || v.tags.includes(videoFilter));
  }
  grid.innerHTML = filtered.map(v => {
    const langCls = {python:'vt-python',sql:'vt-sql',golang:'vt-golang',general:'vt-general'}[v.lang]||'vt-general';
    const langLabel = {python:'Python',sql:'SQL',golang:'Golang',general:'General'}[v.lang]||v.lang;
    return `<div class="video-card">
      <div class="video-thumb" onclick="playVideo('${v.yt}','${esc(v.title).replace(/'/g,"\\'")}','${esc(v.desc).replace(/'/g,"\\'")}')">
        <img src="https://img.youtube.com/vi/${v.yt}/mqdefault.jpg" alt="${esc(v.title)}" loading="lazy">
        <div class="play-btn"><span>â–¶</span></div>
      </div>
      <div class="video-info">
        <div class="video-meta">
          <span class="video-lang-tag ${langCls}">${langLabel}</span>
          <span>${esc(v.channel)}</span>
          <span>${esc(v.duration)}</span>
        </div>
        <h4>${esc(v.title)}</h4>
        <p class="video-desc">${esc(v.desc)}</p>
      </div>
    </div>`;
  }).join('');
  if (filtered.length === 0) grid.innerHTML = '<p style="color:var(--muted);text-align:center;padding:2rem">No videos found for this filter.</p>';
}

function filterVideos(filter, btn) {
  videoFilter = filter;
  document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('active'));
  if (btn) btn.classList.add('active');
  renderVideos();
}

function playVideo(ytId, title, desc) {
  document.getElementById('videoFrame').src = `https://www.youtube.com/embed/${ytId}?autoplay=1`;
  document.getElementById('videoModalTitle').textContent = title;
  document.getElementById('videoModalDesc').textContent = desc;
  document.getElementById('videoModal').classList.add('show');
}

function closeVideo() {
  document.getElementById('videoFrame').src = '';
  document.getElementById('videoModal').classList.remove('show');
}

document.addEventListener('keydown', e => { if (e.key === 'Escape') closeVideo(); });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FLASHCARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const FLASHCARD_DECKS = {
python: [
  {q:'What is a variable?',a:'A named container that stores data.\nExample: name = "Amrutha"'},
  {q:'What does print() do?',a:'Displays output to the screen.\nExample: print("Hello World!")'},
  {q:'What does input() return?',a:'Always returns a string (text).\nConvert with int() or float() for numbers.'},
  {q:'What is the difference between = and ==?',a:'= assigns a value (x = 5)\n== compares values (x == 5 returns True/False)'},
  {q:'What does range(5) produce?',a:'Generates: 0, 1, 2, 3, 4\nStarts at 0, stops BEFORE 5'},
  {q:'How do you add to a list?',a:'list.append(item) adds to end\nlist.insert(0, item) adds at position 0'},
  {q:'How do you define a function?',a:'def function_name(parameters):\n    return result'},
  {q:'What is a dictionary?',a:'Key-value pairs: {"name": "Ammu", "age": 25}\nAccess with dict["key"]'},
  {q:'What does len() do?',a:'Returns the length/count of items.\nWorks on strings, lists, dicts, etc.'},
  {q:'How to handle errors?',a:'try:\n    risky_code()\nexcept ErrorType:\n    handle_error()'},
  {q:'What is string slicing?',a:'"Hello"[1:3] returns "el"\n"Hello"[0] returns "H"\n"Hello"[-1] returns "o"'},
  {q:'What is a boolean?',a:'True or False value.\nUsed in conditions: if x > 5: (returns bool)'},
  {q:'What is a for loop?',a:'Repeats code for each item:\nfor item in list:\n    do_something(item)'},
  {q:'What does import do?',a:'Brings in external modules/libraries.\nimport math\nfrom random import randint'},
  {q:'What is a list comprehension?',a:'Shortcut to create lists:\nsquares = [x**2 for x in range(5)]\nResult: [0, 1, 4, 9, 16]'}
],
sql: [
  {q:'What does SELECT do?',a:'Retrieves data from a table.\nSELECT * FROM students;'},
  {q:'What is WHERE for?',a:'Filters rows based on conditions.\nSELECT * FROM t WHERE age > 20;'},
  {q:'How to sort results?',a:'ORDER BY column ASC (or DESC)\nASC = A-Z / smallest first (default)'},
  {q:'What is a PRIMARY KEY?',a:'A unique identifier for each row.\nNo two rows can have the same value.'},
  {q:'What does JOIN do?',a:'Combines rows from 2+ tables\nbased on a related column.\nSELECT * FROM a JOIN b ON a.id = b.a_id'},
  {q:'What is GROUP BY?',a:'Groups rows with same values\nfor aggregate functions.\nSELECT city, COUNT(*) FROM t GROUP BY city'},
  {q:'WHERE vs HAVING?',a:'WHERE filters individual rows (before grouping)\nHAVING filters groups (after GROUP BY)'},
  {q:'What does COUNT(*) return?',a:'The number of rows that match the query.\nSELECT COUNT(*) FROM students;'},
  {q:'How to add a row?',a:'INSERT INTO table (cols)\nVALUES (values);'},
  {q:'How to delete a row?',a:'DELETE FROM table WHERE condition;\nAlways use WHERE or it deletes ALL rows!'},
  {q:'What does LIKE do?',a:'Pattern matching for text.\n% = any characters, _ = one character\nWHERE name LIKE "A%"  (starts with A)'},
  {q:'What is NULL?',a:'Missing or unknown value.\nNot the same as 0 or empty string.\nCheck with IS NULL / IS NOT NULL'},
  {q:'What is a foreign key?',a:'A column that links to another table\'s primary key.\nCreates a relationship between tables.'},
  {q:'How to update data?',a:'UPDATE table SET col = value\nWHERE condition;'},
  {q:'What does DISTINCT do?',a:'Returns only unique values.\nSELECT DISTINCT city FROM students;\n(no duplicates)'}
],
golang: [
  {q:'What is := in Go?',a:'Short variable declaration.\nDeclares AND assigns in one step.\nx := 5 (Go infers type as int)'},
  {q:'How many loop types in Go?',a:'Only ONE: for\nBut it can act as for, while, and for-each.'},
  {q:'What does fmt.Println do?',a:'Prints text followed by a newline.\nfmt.Println("Hello!")'},
  {q:'What is a slice?',a:'A dynamic-size list.\ns := []int{1, 2, 3}\ns = append(s, 4)'},
  {q:'How to add to a slice?',a:'s = append(s, item)\nMust reassign because append returns new slice.'},
  {q:'What is a struct?',a:'Custom data type with named fields.\ntype Student struct {\n  Name string\n  Age  int\n}'},
  {q:'What is a goroutine?',a:'A lightweight concurrent thread.\nStarted with: go functionName()\nManaged by Go runtime.'},
  {q:'How does Go handle errors?',a:'Functions return error as last value.\nresult, err := doThing()\nif err != nil { handle it }'},
  {q:'What is a map?',a:'Key-value data structure.\nm := map[string]int{"a": 1}\nm["b"] = 2'},
  {q:'What does range do?',a:'Iterates over slices, maps, strings.\nfor index, value := range slice { }'},
  {q:'What is a pointer?',a:'Holds the memory address of a value.\nvar p *int = &x\n*p gives the value at that address.'},
  {q:'What is defer?',a:'Delays function execution until\nthe surrounding function returns.\ndefer fmt.Println("runs last")'},
  {q:'What does make() do?',a:'Creates slices, maps, and channels.\ns := make([]int, 0, 10)\nm := make(map[string]int)'},
  {q:'What is an interface?',a:'A set of method signatures.\nAny type that implements all methods\nsatisfies the interface automatically.'},
  {q:'What is the blank identifier _?',a:'Discards a value you don\'t need.\nfor _, value := range slice { }\n(ignores the index)'}
]
};

let fcDeck = 'python', fcIndex = 0, fcFlipped = false;

function renderFlashcards() {
  const sel = document.getElementById('fcDeckSelect');
  if (!sel) return;
  sel.innerHTML = [{id:'python',label:'ðŸ Python'},{id:'sql',label:'ðŸ—„ï¸ SQL'},{id:'golang',label:'ðŸ”· Golang'}].map(d =>
    `<button class="fc-deck-btn ${d.id===fcDeck?'active':''}" onclick="switchDeck('${d.id}')">${d.label}</button>`
  ).join('');
  showCurrentCard();
}

function switchDeck(deck) { fcDeck = deck; fcIndex = 0; fcFlipped = false; renderFlashcards(); }
function flipCard() { fcFlipped = !fcFlipped; document.getElementById('fcCard').classList.toggle('flipped', fcFlipped); sfx.click(); }

function showCurrentCard() {
  const cards = FLASHCARD_DECKS[fcDeck];
  if (!cards || cards.length === 0) return;
  if (fcIndex < 0) fcIndex = cards.length - 1;
  if (fcIndex >= cards.length) fcIndex = 0;
  const c = cards[fcIndex];
  document.getElementById('fcFront').innerHTML = `<div style="font-size:.78rem;color:var(--muted);margin-bottom:.5rem">${fcDeck.toUpperCase()} â€” Card ${fcIndex+1}/${cards.length}</div>${esc(c.q)}`;
  document.getElementById('fcBack').innerHTML = `<div style="white-space:pre-line;text-align:left">${esc(c.a)}</div>`;
  document.getElementById('fcProgress').textContent = `Card ${fcIndex+1} of ${cards.length}`;
  fcFlipped = false;
  document.getElementById('fcCard').classList.remove('flipped');

  // Mastery stats
  const mastery = load('dm_fc_mastery_'+users[currentUserIdx]+'_'+fcDeck, {});
  const got = Object.values(mastery).filter(v=>v==='got').length;
  document.getElementById('fcMastery').textContent = Math.round(got/cards.length*100)+'%';
  document.getElementById('fcReviewed').textContent = load('dm_fc_reviewed_'+users[currentUserIdx], 0);
}

function nextCard() { fcIndex++; showCurrentCard(); }
function prevCard() { fcIndex--; showCurrentCard(); }
function shuffleCards() {
  const deck = FLASHCARD_DECKS[fcDeck];
  for (let i=deck.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1));[deck[i],deck[j]]=[deck[j],deck[i]]; }
  fcIndex=0; showCurrentCard(); showToast('ðŸ”€','Cards shuffled!');
}

function markCard(status) {
  let mastery = load('dm_fc_mastery_'+users[currentUserIdx]+'_'+fcDeck, {});
  mastery[fcIndex] = status;
  save('dm_fc_mastery_'+users[currentUserIdx]+'_'+fcDeck, mastery);
  let reviewed = load('dm_fc_reviewed_'+users[currentUserIdx], 0);
  reviewed++;
  save('dm_fc_reviewed_'+users[currentUserIdx], reviewed);
  addXP(5, 'Flashcard reviewed');
  if (status==='got') sfx.correct(); else sfx.wrong();
  nextCard();
  checkBadges();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHALLENGES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CHALLENGES = [
  {id:1,lang:'python',title:'FizzBuzz',diff:'easy',time:5,desc:'Print numbers 1-30. For multiples of 3 print "Fizz", multiples of 5 print "Buzz", both print "FizzBuzz".',expected:'1, 2, Fizz, 4, Buzz, Fizz, 7, 8, Fizz, Buzz, 11, Fizz, 13, 14, FizzBuzz...'},
  {id:2,lang:'python',title:'Reverse a String',diff:'easy',time:5,desc:'Write a function that takes a string and returns it reversed. "hello" â†’ "olleh"',expected:'Input: "hello" â†’ Output: "olleh"'},
  {id:3,lang:'python',title:'Count Vowels',diff:'medium',time:10,desc:'Write a function that counts vowels (a,e,i,o,u) in a string. Handle both upper and lowercase.',expected:'Input: "Hello World" â†’ Output: 3'},
  {id:4,lang:'python',title:'Find Duplicates',diff:'medium',time:10,desc:'Write a function that finds duplicate numbers in a list. Return a list of duplicates.',expected:'Input: [1,2,3,2,4,3] â†’ Output: [2,3]'},
  {id:5,lang:'python',title:'Password Generator',diff:'medium',time:10,desc:'Generate a random password of given length with uppercase, lowercase, digits, and special characters.',expected:'generate_password(12) â†’ "aB3$kL9!mN2@"'},
  {id:6,lang:'sql',title:'Create Users Table',diff:'easy',time:5,desc:'Create a "users" table with: id (primary key), name (text, not null), email (text, unique), age (integer), created_at (text).',expected:'CREATE TABLE users (...)'},
  {id:7,lang:'sql',title:'Top 3 Students',diff:'easy',time:5,desc:'Write a query to find the top 3 students by GPA from a "students" table. Show name and gpa.',expected:'SELECT name, gpa FROM students ORDER BY gpa DESC LIMIT 3'},
  {id:8,lang:'sql',title:'Orders Per Customer',diff:'medium',time:10,desc:'Given "customers" and "orders" tables, write a query showing each customer name and their total number of orders.',expected:'SELECT c.name, COUNT(o.id) FROM customers c JOIN orders o...'},
  {id:9,lang:'sql',title:'Above Average Scores',diff:'medium',time:10,desc:'Find all students whose score is above the class average. Use a subquery.',expected:'SELECT * FROM students WHERE score > (SELECT AVG(score)...)'},
  {id:10,lang:'sql',title:'Revenue Report',diff:'hard',time:15,desc:'Write a query showing total revenue per product category, sorted highest first, only categories with revenue > 1000.',expected:'SELECT category, SUM(price*qty) as revenue... GROUP BY... HAVING...'},
  {id:11,lang:'golang',title:'Hello Greeter',diff:'easy',time:5,desc:'Write a greet function that takes a name and returns "Hello, {name}! Welcome to Go!"',expected:'greet("Amrutha") â†’ "Hello, Amrutha! Welcome to Go!"'},
  {id:12,lang:'golang',title:'Sum of Slice',diff:'easy',time:5,desc:'Write a function that takes a slice of integers and returns their sum.',expected:'sum([]int{1,2,3,4,5}) â†’ 15'},
  {id:13,lang:'golang',title:'Word Counter',diff:'medium',time:10,desc:'Write a function that takes a string and returns a map[string]int counting each word.',expected:'"go is fun go" â†’ map[go:2 is:1 fun:1]'},
  {id:14,lang:'golang',title:'Student Struct',diff:'medium',time:10,desc:'Create a Student struct with Name, Marks []int. Add an Average() method. Create 3 students and print their averages.',expected:'Student{Name:"Ammu", Marks:[]int{90,85}}.Average() â†’ 87.5'},
  {id:15,lang:'golang',title:'Safe Division',diff:'medium',time:10,desc:'Write a divide function returning (float64, error). Return an error for division by zero.',expected:'divide(10,0) â†’ 0, error("cannot divide by zero")'}
];

let activeChallenge = null, challengeTimer = null;

function renderChallenges() {
  const list = document.getElementById('challengesList');
  if (!list) return;
  const completed = load('dm_ch_done_'+users[currentUserIdx], []);
  const icons = {python:'ðŸ',sql:'ðŸ—„ï¸',golang:'ðŸ”·'};
  list.innerHTML = CHALLENGES.map(ch => {
    const done = completed.includes(ch.id);
    return `<div class="ch-card" id="ch_${ch.id}">
      <h4><span>${icons[ch.lang]} ${esc(ch.title)}</span>
        <span><span class="diff-badge diff-${ch.diff}">${ch.diff}</span> <span style="font-size:.78rem;color:var(--muted)">${ch.time} min</span></span>
      </h4>
      <p style="font-size:.88rem;margin-bottom:.5rem">${esc(ch.desc)}</p>
      <p style="font-size:.8rem;color:var(--muted)">Expected: ${esc(ch.expected)}</p>
      ${done ? '<div style="color:var(--success);font-weight:600;margin-top:.5rem">âœ… Completed!</div>' :
        (activeChallenge===ch.id ?
          `<div class="ch-timer" id="chTimer">--:--</div>
           <textarea class="ch-textarea" id="chAnswer" placeholder="Write your solution here..."></textarea>
           <div style="display:flex;gap:.5rem;margin-top:.5rem">
             <button class="btn btn-success" onclick="submitChallenge(${ch.id})">Submit</button>
             <button class="btn btn-danger btn-sm" onclick="cancelChallenge()">Cancel</button>
           </div>` :
          `<button class="btn btn-primary btn-sm" onclick="startChallenge(${ch.id})" style="margin-top:.5rem">Start Challenge</button>`
        )}
    </div>`;
  }).join('');
}

function startChallenge(id) {
  const ch = CHALLENGES.find(c=>c.id===id);
  if (!ch) return;
  activeChallenge = id;
  renderChallenges();
  let timeLeft = ch.time * 60;
  const timerEl = document.getElementById('chTimer');
  if (timerEl) timerEl.textContent = formatTime(timeLeft);
  challengeTimer = setInterval(() => {
    timeLeft--;
    if (timerEl) timerEl.textContent = formatTime(timeLeft);
    if (timeLeft <= 0) {
      clearInterval(challengeTimer);
      submitChallenge(id, true);
    }
  }, 1000);
}

function formatTime(s) { return String(Math.floor(s/60)).padStart(2,'0')+':'+String(s%60).padStart(2,'0'); }

function submitChallenge(id, overtime) {
  clearInterval(challengeTimer);
  const answer = document.getElementById('chAnswer')?.value || '';
  if (!answer.trim() && !overtime) { showToast('âš ï¸','Write something before submitting!'); return; }
  let done = load('dm_ch_done_'+users[currentUserIdx], []);
  if (!done.includes(id)) {
    done.push(id);
    save('dm_ch_done_'+users[currentUserIdx], done);
    let cnt = load('dm_ch_completed_'+users[currentUserIdx], 0);
    save('dm_ch_completed_'+users[currentUserIdx], cnt+1);
  }
  const xpAmount = overtime ? 25 : 50;
  addXP(xpAmount, 'Challenge completed');
  sfx.correct();
  showToast('âš¡', `Challenge completed! +${xpAmount} XP`);
  activeChallenge = null;
  renderChallenges();
  checkBadges();
}

function cancelChallenge() {
  clearInterval(challengeTimer);
  activeChallenge = null;
  renderChallenges();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOOK INTO QUIZ FOR XP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _origAnswerQuiz = answerQuiz;
answerQuiz = function(mod, qi, oi) {
  const state = getQuizState(mod);
  if (state[`q${qi}`] !== undefined) return;
  const isCorrect = oi === QUIZZES[mod][qi].ans;
  _origAnswerQuiz(mod, qi, oi);
  addXP(10, 'Quiz question answered');
  if (isCorrect) { addXP(20, 'Correct answer bonus'); sfx.correct(); }
  else { sfx.wrong(); }
  checkBadges();
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UTILS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function esc(s) { const d=document.createElement('div'); d.textContent=s; return d.innerHTML; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CODE GAME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const GAME_QUESTIONS = [
  {lang:'python',code:'x = [1, 2, 3]\nx.append(4)\nprint(len(x))',opts:['3','4','[1,2,3,4]','Error'],ans:1},
  {lang:'python',code:'print("hello"[1])',opts:['h','e','l','hello'],ans:1},
  {lang:'python',code:'x = 10\ny = 3\nprint(x // y)',opts:['3.33','3','3.0','1'],ans:1},
  {lang:'python',code:'a = "Python"\nprint(a[::-1])',opts:['Python','nohtyP','P','Error'],ans:1},
  {lang:'python',code:'x = [1, 2, 3]\nprint(x[-1])',opts:['1','2','3','Error'],ans:2},
  {lang:'python',code:'print(type(3.14).__name__)',opts:['int','float','str','double'],ans:1},
  {lang:'python',code:'x = {"a": 1, "b": 2}\nprint(len(x))',opts:['1','2','4','Error'],ans:1},
  {lang:'python',code:'for i in range(3):\n    print(i, end=" ")',opts:['1 2 3','0 1 2','0 1 2 3','1 2'],ans:1},
  {lang:'python',code:'x = "hello"\nprint(x.upper())',opts:['Hello','HELLO','hello','Error'],ans:1},
  {lang:'python',code:'print(bool(""))',opts:['True','False','""','Error'],ans:1},
  {lang:'sql',code:'SELECT COUNT(*)\nFROM users\nWHERE age > 18;',opts:['All users','Count of adults','Ages over 18','Error'],ans:1},
  {lang:'sql',code:'SELECT DISTINCT city\nFROM customers;',opts:['All cities with duplicates','Unique cities only','First city','Count of cities'],ans:1},
  {lang:'sql',code:'SELECT name\nFROM students\nORDER BY grade DESC\nLIMIT 1;',opts:['Worst student','Best student','All students','Random student'],ans:1},
  {lang:'sql',code:'SELECT AVG(salary)\nFROM employees\nGROUP BY department;',opts:['Total salary','Avg salary per dept','Max salary','Min salary'],ans:1},
  {lang:'sql',code:'SELECT *\nFROM orders\nWHERE status IS NULL;',opts:['All orders','Orders with no status','Empty table','Error'],ans:1},
  {lang:'golang',code:'x := 10\ny := 3\nfmt.Println(x / y)',opts:['3.33','3','3.0','Error'],ans:1},
  {lang:'golang',code:'s := []int{1, 2, 3}\ns = append(s, 4)\nfmt.Println(len(s))',opts:['3','4','Error','[1 2 3 4]'],ans:1},
  {lang:'golang',code:'x := "Hello"\nfmt.Println(x[0])',opts:['H','72','Hello','Error'],ans:1},
  {lang:'golang',code:'m := map[string]int{"a": 1}\nfmt.Println(m["b"])',opts:['nil','0','Error','undefined'],ans:1},
  {lang:'golang',code:'for i := 0; i < 3; i++ {\n  fmt.Print(i, " ")\n}',opts:['1 2 3','0 1 2','0 1 2 3','Error'],ans:1}
];

let gameCorrect = 0, gameStreakCount = 0, currentGameQ = null;

function loadGameQuestion(){
  const lang = document.getElementById('gameLang').value;
  let pool = lang === 'all' ? GAME_QUESTIONS : GAME_QUESTIONS.filter(q=>q.lang===lang);
  currentGameQ = pool[Math.floor(Math.random()*pool.length)];
  document.getElementById('gameCode').textContent = currentGameQ.code;
  document.getElementById('gameFeedback').style.display = 'none';
  document.getElementById('gameNextBtn').style.display = 'none';
  const shuffled = currentGameQ.opts.map((o,i)=>({text:o,idx:i})).sort(()=>Math.random()-0.5);
  document.getElementById('gameOptions').innerHTML = shuffled.map(o =>
    `<button class="btn btn-outline btn-lg" onclick="answerGame(${o.idx})" style="text-align:center;padding:.8rem">${esc(o.text)}</button>`
  ).join('');
}

function answerGame(idx){
  const fb = document.getElementById('gameFeedback');
  const correct = idx === currentGameQ.ans;
  if(correct){
    gameCorrect++;
    gameStreakCount++;
    fb.innerHTML = '<strong>Correct!</strong> Great job!';
    fb.style.background = 'rgba(46,196,182,0.15)';
    fb.style.color = 'var(--success)';
    addXP(15, 'Code Game correct answer');
  } else {
    gameStreakCount = 0;
    fb.innerHTML = `<strong>Wrong!</strong> The answer was: <strong>${esc(currentGameQ.opts[currentGameQ.ans])}</strong>`;
    fb.style.background = 'rgba(230,57,70,0.15)';
    fb.style.color = 'var(--danger)';
  }
  fb.style.display = 'block';
  document.getElementById('gameNextBtn').style.display = 'block';
  document.getElementById('gameScore').textContent = gameCorrect;
  document.getElementById('gameStreak').textContent = gameStreakCount;
  document.querySelectorAll('#gameOptions button').forEach(b=>b.disabled=true);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONCEPT MINI QUIZZES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CONCEPT_MINI_QUIZZES = {
python: {
  0: {q:'What type is the value 3.14 in Python?',opts:['str','int','float','bool'],ans:2},
  1: {q:'What does input() always return?',opts:['int','float','str','bool'],ans:2},
  2: {q:'What keyword starts an alternative condition?',opts:['else if','elif','elsif','elseif'],ans:1},
  3: {q:'Which loop is best when you know the count?',opts:['while','for','do-while','repeat'],ans:1},
  4: {q:'How do you add an item to a list?',opts:['.add()','.append()','.push()','.insert()'],ans:1},
  5: {q:'What keyword defines a function?',opts:['function','func','def','define'],ans:2},
  6: {q:'How do you access a dictionary value?',opts:['dict(key)','dict[key]','dict.key','dict->key'],ans:1},
  7: {q:'Which method makes a string uppercase?',opts:['.upper()','.toUpper()','.capitalize()','.UP()'],ans:0},
  8: {q:'What mode opens a file for writing?',opts:['"r"','"w"','"a"','"x"'],ans:1},
  9: {q:'Which block always runs after try?',opts:['except','else','finally','catch'],ans:2}
},
sql: {
  0: {q:'SQL stands for?',opts:['Simple Query Language','Structured Query Language','Standard Query Language','System Query Language'],ans:1},
  1: {q:'Which command creates a table?',opts:['MAKE TABLE','NEW TABLE','CREATE TABLE','ADD TABLE'],ans:2},
  2: {q:'Which inserts a new row?',opts:['ADD INTO','INSERT INTO','PUT INTO','CREATE ROW'],ans:1},
  3: {q:'What clause filters rows?',opts:['FILTER','WHERE','HAVING','WHEN'],ans:1},
  4: {q:'Which deletes all rows from a table?',opts:['REMOVE','DELETE FROM','DROP','CLEAR'],ans:1},
  5: {q:'COUNT(*) counts what?',opts:['Columns','Tables','All rows','Only NULLs'],ans:2},
  6: {q:'HAVING is used with?',opts:['WHERE','ORDER BY','GROUP BY','JOIN'],ans:2},
  7: {q:'Which JOIN returns all matching rows from both tables?',opts:['LEFT JOIN','RIGHT JOIN','INNER JOIN','FULL JOIN'],ans:2}
},
golang: {
  0: {q:'What is the Go shorthand for variable declaration?',opts:['var x = 5','let x = 5','x := 5','x = 5'],ans:2},
  1: {q:'Which prints with a newline in Go?',opts:['fmt.Print','fmt.Println','fmt.Printf','fmt.Write'],ans:1},
  2: {q:'Go uses which keyword for conditions?',opts:['if (x>0)','if x > 0','if x > 0 then','unless'],ans:1},
  3: {q:'Go has how many loop keywords?',opts:['3 (for,while,do)','2 (for,while)','1 (for)','4'],ans:2},
  4: {q:'What is a slice in Go?',opts:['Fixed-size array','Dynamic array','Linked list','Map'],ans:1},
  5: {q:'How do you define a function in Go?',opts:['def','function','func','fn'],ans:2},
  6: {q:'Maps in Go are similar to Python\'s?',opts:['lists','tuples','dictionaries','sets'],ans:2},
  7: {q:'What handles errors in Go?',opts:['try/catch','except','if err != nil','throw'],ans:2},
  8: {q:'What are goroutines?',opts:['Threads','Lightweight concurrent functions','Classes','Modules'],ans:1},
  9: {q:'Which package handles strings?',opts:['str','string','strings','text'],ans:2}
}};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PROGRESSIVE HINTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PROGRESSIVE_HINTS = {
python: {
  0: ['Think about what types of data you need to store (text, numbers, true/false)','Use variables with descriptive names, then use f-strings to format output','name="Amrutha"; age=25; print(f"I am {name}, age {age}")'],
  1: ['You need to get user input and do a math formula','Get input with input(), convert to float, apply the formula F = C * 9/5 + 32','c=float(input("Celsius: ")); f=c*9/5+32; print(f"{c}C = {f}F")'],
  2: ['Use the modulo operator (%) to check divisibility','Check if number % 2 equals 0 for even, then check sign with > 0, < 0, == 0','n=int(input()); print("even" if n%2==0 else "odd")'],
  3: ['Use a for loop that goes from 1 to 10','Use range(1, 11) inside a for loop, multiply in each iteration','n=int(input()); for i in range(1,11): print(f"{n}x{i}={n*i}")'],
  4: ['You can use a loop or a math formula','Loop from 1 to N and keep adding, or use N*(N+1)//2','n=int(input()); print(sum(range(1,n+1)))'],
  5: ['Import random, use a while loop for guessing','Generate random number, loop until guess matches, give high/low feedback','import random; s=random.randint(1,100); while True: g=int(input()); if g==s: break'],
  6: ['Create a list with [], use built-in list methods','Use append() to add, remove() to delete, sort() to arrange, len() for count','names=["A","B","C","D","E"]; names.append("F"); names.sort(); print(len(names))'],
  7: ['Use if/elif to check which operation string was passed','Define function with 3 params, use if/elif for +,-,*,/, return result','def calc(a,b,op): if op=="+": return a+b; elif op=="/": return a/b if b!=0 else "Error"'],
  8: ['Use split() for words, a loop and dictionary for counting','Split sentence into words, iterate and use dict to count occurrences','words=s.split(); counts={}; for w in words: counts[w]=counts.get(w,0)+1'],
  9: ['Use a dictionary where keys are names, values are lists of marks','Loop through dict.items(), calculate average with sum()/len()','for name,marks in students.items(): print(name, sum(marks)/len(marks))'],
  10: ['Check each character type using string methods','Loop through each char, check with .isupper() .islower() .isdigit()','has_upper=any(c.isupper() for c in pw); has_digit=any(c.isdigit() for c in pw)'],
  11: ['Use open() with different modes: "w" to write, "r" to read, "a" to append','Write with mode "w", read with "r", append new item with "a"','with open("todos.txt","w") as f: f.write("item1\\n"); with open("todos.txt","r") as f: print(f.read())'],
  12: ['Use nested dictionaries: outer key=name, inner dict has phone,email','Create dict of dicts, use input() for CRUD operations in a while loop','contacts={"John":{"phone":"123","email":"j@m.com"}}; contacts["Jane"]={"phone":"456"}'],
  13: ['Use a list of dictionaries, each with item name and price','Add items as dicts, sum prices for total, apply 10% off if > 1000','cart=[]; cart.append({"item":"Laptop","price":50000}); total=sum(i["price"] for i in cart)']
},
sql: {
  0: ['Think about what data types each column needs','Use INTEGER for id, TEXT for name, REAL for price, BOOLEAN for in_stock','CREATE TABLE products(id INTEGER PRIMARY KEY, name TEXT, price REAL, category TEXT, in_stock BOOLEAN);'],
  1: ['SELECT lets you choose which columns to see, WHERE filters rows','Use SELECT * for all, SELECT name,price for specific, add WHERE for conditions','SELECT name, price FROM products WHERE price < 500;'],
  2: ['ORDER BY sorts results, LIMIT restricts count','Add ORDER BY column DESC for descending, LIMIT N for top N','SELECT * FROM products ORDER BY price DESC LIMIT 3;'],
  3: ['UPDATE changes existing rows, DELETE removes rows','Use SET to change values, WHERE to target specific rows','UPDATE products SET price=999 WHERE name="Phone"; DELETE FROM products WHERE in_stock=0;'],
  4: ['Aggregate functions work on groups of values','COUNT counts rows, AVG averages, SUM totals, MAX/MIN find extremes','SELECT COUNT(*) as total, AVG(price) as avg_price, MAX(price) as max_price FROM products;'],
  5: ['GROUP BY groups rows with same values, HAVING filters groups','Group by category, use COUNT/AVG per group, HAVING filters after grouping','SELECT category, COUNT(*), AVG(price) FROM products GROUP BY category HAVING COUNT(*)>1;'],
  6: ['Create two related tables with a foreign key connection','Orders table needs customer_id that references customers(id)','CREATE TABLE orders(id INTEGER PRIMARY KEY, customer_id INTEGER, product TEXT, FOREIGN KEY(customer_id) REFERENCES customers(id));'],
  7: ['JOIN combines rows from two tables based on a related column','Use INNER JOIN with ON clause to match customer_id to id','SELECT c.name, o.product FROM customers c JOIN orders o ON c.id=o.customer_id;']
},
golang: {
  0: ['Go has strict typing but := infers the type automatically','Use := for short declaration, fmt.Printf with %s,%d,%f,%t for types','name:="Amrutha"; age:=25; fmt.Printf("Name:%s Age:%d",name,age)'],
  1: ['Use fmt.Scan to read input from user','Declare variable first, pass pointer with & to Scan','var c float64; fmt.Scan(&c); f:=c*9/5+32; fmt.Println(f)'],
  2: ['Go if statements don\'t need parentheses around condition','Use if/else if/else chain for grade ranges','if marks>=90{grade="A"}else if marks>=80{grade="B"}'],
  3: ['Go only has for loops, but they can act like while loops','Use for i:=1;i<=50;i++ with if conditions and % operator','for i:=1;i<=50;i++{if i%15==0{fmt.Println("FizzBuzz")}else if i%3==0{fmt.Println("Fizz")}}'],
  4: ['Slices use [] syntax, append() adds elements','Create with :=[]string{}, use append() to add, [2:5] for sub-slice','fruits:=[]string{"apple","banana"}; fruits=append(fruits,"mango"); fmt.Println(fruits[1:3])'],
  5: ['Go functions use func keyword with explicit return types','func name(params) returnType { }, use multiple returns for error handling','func isPrime(n int)bool{for i:=2;i*i<=n;i++{if n%i==0{return false}};return n>1}'],
  6: ['Go maps use map[keyType]valueType syntax','Create with make(map[string]int), increment with map[key]++','counts:=make(map[string]int); for _,w:=range words{counts[w]++}'],
  7: ['Go returns errors as second return values','Return (result, error) tuple, check with if err!=nil','func divide(a,b float64)(float64,error){if b==0{return 0,fmt.Errorf("div by zero")};return a/b,nil}']
}};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DEBUG EXERCISES DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let debugLang = 'python';
const DEBUG_EXERCISES = {
python: [
  {title:'Missing colon',code:'def greet(name)\n    print(f"Hello {name}")',bug:'Missing colon after function definition',fix:'def greet(name):',hint:'Python function definitions need a colon at the end'},
  {title:'Wrong comparison',code:'x = 5\nif x = 10:\n    print("ten")',bug:'Using = instead of == for comparison',fix:'if x == 10:',hint:'= is assignment, == is comparison'},
  {title:'Index error',code:'fruits = ["apple", "banana", "cherry"]\nprint(fruits[3])',bug:'Index 3 is out of range (max is 2)',fix:'print(fruits[2])',hint:'Lists are 0-indexed, so index 3 means 4th element'},
  {title:'String concat',code:'age = 25\nprint("I am " + age + " years old")',bug:'Cannot concatenate string and integer',fix:'print("I am " + str(age) + " years old")',hint:'Convert int to str or use f-strings'},
  {title:'Indentation',code:'for i in range(5):\nprint(i)',bug:'Missing indentation in loop body',fix:'    print(i)',hint:'Python uses indentation for code blocks'},
  {title:'Wrong method',code:'numbers = [3, 1, 4, 1, 5]\nnumbers.add(9)',bug:'Lists use append(), not add()',fix:'numbers.append(9)',hint:'add() is for sets, append() is for lists'},
  {title:'Return issue',code:'def double(x):\n    x * 2',bug:'Missing return statement',fix:'    return x * 2',hint:'Functions need return to send back a value'}
],
sql: [
  {title:'Missing quotes',code:'SELECT * FROM users\nWHERE name = John',bug:'String value needs quotes',fix:"WHERE name = 'John'",hint:'String literals in SQL need single quotes'},
  {title:'Wrong keyword',code:'SELECT name, age FROM users\nIF age > 18',bug:'Should use WHERE not IF',fix:'WHERE age > 18',hint:'SQL uses WHERE clause to filter rows'},
  {title:'GROUP BY missing',code:'SELECT category, COUNT(*)\nFROM products',bug:'Need GROUP BY when using aggregate with non-aggregate column',fix:'FROM products GROUP BY category',hint:'Aggregate functions with columns need GROUP BY'},
  {title:'Wrong order',code:'SELECT * FROM orders\nLIMIT 5\nORDER BY price DESC',bug:'ORDER BY must come before LIMIT',fix:'ORDER BY price DESC\nLIMIT 5',hint:'SQL clause order: SELECT FROM WHERE GROUP ORDER LIMIT'},
  {title:'Alias error',code:"SELECT COUNT(*) AS total\nFROM products\nWHERE total > 5",bug:'Cannot use column alias in WHERE',fix:'HAVING COUNT(*) > 5',hint:'Use HAVING for conditions on aggregates'},
  {title:'JOIN missing ON',code:'SELECT * FROM orders\nJOIN customers',bug:'JOIN needs ON clause',fix:'JOIN customers ON orders.customer_id = customers.id',hint:'JOINs need ON to specify the relationship'}
],
golang: [
  {title:'Missing package',code:'import "fmt"\n\nfunc main() {\n    fmt.Println("Hello")\n}',bug:'Missing package main declaration',fix:'package main',hint:'Every Go file needs a package declaration'},
  {title:'Short declare',code:'func main() {\n    var x = 5\n    x := 10\n}',bug:'Cannot use := to redeclare existing variable',fix:'    x = 10',hint:':= declares new variable, = reassigns existing'},
  {title:'Unused variable',code:'func main() {\n    x := 5\n    y := 10\n    fmt.Println(x)\n}',bug:'Variable y declared but not used',fix:'    fmt.Println(x, y)',hint:'Go requires all declared variables to be used'},
  {title:'Missing return',code:'func add(a, b int) int {\n    a + b\n}',bug:'Missing return statement',fix:'    return a + b',hint:'Functions with return type must use return'},
  {title:'Semicolons in for',code:'for i := 0, i < 10, i++ {\n    fmt.Println(i)\n}',bug:'For loop uses semicolons not commas',fix:'for i := 0; i < 10; i++ {',hint:'Go for loops separate clauses with semicolons'},
  {title:'Export naming',code:'type person struct {\n    Name string\n    age  int\n}',bug:'If you need age accessible outside package, capitalize it',fix:'    Age  int',hint:'Go exports start with uppercase letter'}
]};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FILL IN THE BLANK DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let fitbLang = 'python';
const FITB_EXERCISES = {
python: [
  {desc:'Define a function',code:'___BLANK___ greet(name):\n    ___BLANK___(f"Hello {name}")',blanks:['def','print']},
  {desc:'Loop through a list',code:'fruits = ["apple", "banana"]\n___BLANK___ fruit ___BLANK___ fruits:\n    print(fruit)',blanks:['for','in']},
  {desc:'Handle exceptions',code:'___BLANK___:\n    x = int(input())\n___BLANK___ ValueError:\n    print("Not a number")',blanks:['try','except']},
  {desc:'List comprehension',code:'squares = [x**2 ___BLANK___ x ___BLANK___ range(10)]',blanks:['for','in']},
  {desc:'Open a file',code:'___BLANK___ open("data.txt", "r") ___BLANK___ f:\n    content = f.read()',blanks:['with','as']},
  {desc:'Import module',code:'___BLANK___ random\nnum = random.___BLANK___(1, 100)',blanks:['import','randint']},
  {desc:'Class definition',code:'___BLANK___ Student:\n    def ___BLANK___(self, name):\n        self.name = name',blanks:['class','__init__']}
],
sql: [
  {desc:'Create a table',code:'___BLANK___ TABLE students (\n    id ___BLANK___ PRIMARY KEY,\n    name TEXT\n)',blanks:['CREATE','INTEGER']},
  {desc:'Insert data',code:'___BLANK___ INTO students (name, age)\n___BLANK___ ("Amrutha", 25)',blanks:['INSERT','VALUES']},
  {desc:'Filter and sort',code:'SELECT * FROM products\n___BLANK___ price > 100\n___BLANK___ BY name ASC',blanks:['WHERE','ORDER']},
  {desc:'Aggregate query',code:'SELECT category, ___BLANK___(*) as total\nFROM products\n___BLANK___ BY category',blanks:['COUNT','GROUP']},
  {desc:'Join tables',code:'SELECT c.name, o.total\nFROM customers c\n___BLANK___ JOIN orders o\n___BLANK___ c.id = o.customer_id',blanks:['INNER','ON']},
  {desc:'Update records',code:'___BLANK___ products\n___BLANK___ price = 999\nWHERE name = \'Phone\'',blanks:['UPDATE','SET']}
],
golang: [
  {desc:'Main function',code:'___BLANK___ main\n\nimport "fmt"\n\n___BLANK___ main() {\n    fmt.Println("Hello")\n}',blanks:['package','func']},
  {desc:'Variable & loop',code:'sum ___BLANK___ 0\n___BLANK___ i := 1; i <= 10; i++ {\n    sum += i\n}',blanks:[':=','for']},
  {desc:'If statement',code:'___BLANK___ age >= 18 {\n    fmt.Println("Adult")\n} ___BLANK___ {\n    fmt.Println("Minor")\n}',blanks:['if','else']},
  {desc:'Slice operations',code:'fruits := []string{"apple"}\nfruits = ___BLANK___(fruits, "banana")\nfmt.Println(___BLANK___(fruits))',blanks:['append','len']},
  {desc:'Map usage',code:'scores := ___BLANK___(map[string]int)\nscores["math"] = 95\nfmt.___BLANK___("Math:", scores["math"])',blanks:['make','Println']},
  {desc:'Struct definition',code:'___BLANK___ Student struct {\n    Name string\n    Age  ___BLANK___\n}',blanks:['type','int']}
]};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DRAG & DROP CODE ORDER DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let dndLang = 'python';
const DND_EXERCISES = {
python: [
  {desc:'Function that returns the square of a number',lines:['def square(n):','    result = n * n','    return result','','print(square(5))']},
  {desc:'Read a file and print each line',lines:['with open("data.txt", "r") as f:','    lines = f.readlines()','    for line in lines:','        print(line.strip())']},
  {desc:'Simple class with method',lines:['class Dog:','    def __init__(self, name):','        self.name = name','    def bark(self):','        print(f"{self.name} says Woof!")','','rex = Dog("Rex")','rex.bark()']},
  {desc:'Find the maximum in a list',lines:['numbers = [3, 7, 2, 9, 4]','max_num = numbers[0]','for n in numbers:','    if n > max_num:','        max_num = n','print(max_num)']},
  {desc:'Dictionary word counter',lines:['sentence = "hello world hello"','words = sentence.split()','counts = {}','for word in words:','    counts[word] = counts.get(word, 0) + 1','print(counts)']}
],
sql: [
  {desc:'Create table and insert data',lines:['CREATE TABLE students (','    id INTEGER PRIMARY KEY,','    name TEXT NOT NULL,','    grade REAL','    );','','INSERT INTO students VALUES (1, "Alice", 3.8);']},
  {desc:'Query with JOIN and filter',lines:['SELECT c.name, o.product','FROM customers c','INNER JOIN orders o','ON c.id = o.customer_id','WHERE o.total > 100','ORDER BY o.total DESC;']},
  {desc:'Aggregate query with HAVING',lines:['SELECT category,','    COUNT(*) as cnt,','    AVG(price) as avg_price','FROM products','GROUP BY category','HAVING cnt > 2','ORDER BY avg_price DESC;']}
],
golang: [
  {desc:'Hello World program',lines:['package main','','import "fmt"','','func main() {','    fmt.Println("Hello, World!")','    }']},
  {desc:'Function with error handling',lines:['func divide(a, b float64) (float64, error) {','    if b == 0 {','        return 0, fmt.Errorf("division by zero")','    }','    return a / b, nil','}']},
  {desc:'Loop with slice',lines:['package main','','import "fmt"','','func main() {','    nums := []int{2, 4, 6, 8}','    sum := 0','    for _, n := range nums {','        sum += n','    }','    fmt.Println("Sum:", sum)','}']},
  {desc:'Struct with method',lines:['type Rectangle struct {','    Width  float64','    Height float64','}','','func (r Rectangle) Area() float64 {','    return r.Width * r.Height','}','','func main() {','    r := Rectangle{5, 3}','    fmt.Println(r.Area())','}']},
]};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MINI PROJECTS DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const MINI_PROJECTS = {
  python: [
    {
      id:'py-expense-tracker',
      title:'Expense Tracker',
      desc:'Build a personal expense tracking app that stores transactions and shows summaries by category.',
      difficulty:'easy',
      xp:150,
      time:'2-3 hours',
      objectives:['Work with dictionaries and lists','Use file I/O to save/load data','Implement filtering and aggregation'],
      tasks:['Create data structure for expenses','Add function to record new expense','Implement category filtering','Add summary statistics (total, average)','Save/load from file'],
      starterCode:`expenses = []

def add_expense(description, amount, category):
    # Add expense to list
    pass

def get_expenses_by_category(category):
    # Return all expenses in a category
    pass

def get_total_by_category():
    # Return dict: {category: total_amount}
    pass

def display_summary():
    # Print formatted summary
    pass`,
      output:`=== Expense Tracker Summary ===
Food: $245.50 (5 items)
Transport: $150.00 (3 items)
Entertainment: $80.00 (2 items)
---
Total: $475.50`,
      hints:'ðŸ’¡ Use a list of dictionaries: [{\"description\": \"Lunch\", \"amount\": 15, \"category\": \"Food\", \"date\": \"2025-02-10\"}'
    },
    {
      id:'py-todo-app',
      title:'To-Do List App',
      desc:'Create a command-line to-do app with add, complete, delete, and list functionality. Save to file.',
      difficulty:'easy',
      xp:120,
      time:'2 hours',
      objectives:['Build CLI interfaces','Handle user input validation','Persist data with JSON'],
      tasks:['Create task storage structure','Implement add task function','Implement mark complete function','Implement delete task function','Add list/display function','Add save/load from JSON'],
      starterCode:`import json

tasks = []

def add_task(title, priority='normal'):
    # Add new task
    pass

def complete_task(task_id):
    # Mark task as completed
    pass

def list_tasks():
    # Display all tasks
    pass

def save_tasks():
    # Save to tasks.json
    pass

def load_tasks():
    # Load from tasks.json
    pass`,
      output:`ðŸ“Œ Your To-Do List
[1] âœ“ Finish Python course (High)
[2] â­• Buy groceries (Low)
[3] â­• Call mom (Normal)

Completed: 1/3`,
      hints:'ðŸ’¡ Use a unique ID for each task. Store as JSON: {\"id\": 1, \"title\": \"Task\", \"completed\": false, \"priority\": \"high\"}'
    },
    {
      id:'py-password-generator',
      title:'Password Generator & Validator',
      desc:'Build a tool that generates strong passwords and validates existing passwords based on security rules.',
      difficulty:'medium',
      xp:100,
      time:'1.5 hours',
      objectives:['Use random module','Work with strings','Implement validation logic'],
      tasks:['Create password generator with length option','Add character type options (uppercase, lowercase, numbers, symbols)','Implement password strength validator','Create security score system','Generate report on password strength'],
      starterCode:`import random
import string

def generate_password(length=12, use_uppercase=True, use_numbers=True, use_symbols=True):
    # Generate secure random password
    pass

def validate_password(password):
    # Check password strength
    # Return: (is_strong, score, feedback)
    pass

def get_strength_rating(score):
    # Convert score to rating
    pass

def main():
    # Interactive menu
    pass`,
      output:`ðŸ” Password Generator
Generated: Kx9#mP2$Lq@7Rx
Strength: STRONG (92/100)
âœ“ Contains uppercase
âœ“ Contains lowercase
âœ“ Contains numbers
âœ“ Contains symbols
âœ“ Length >= 12`,
      hints:'ðŸ’¡ Use random.choice() to pick random characters. Use string.ascii_letters, string.digits, string.punctuation'
    },
    {
      id:'py-quiz-game',
      title:'Interactive Quiz Game',
      desc:'Build a quiz game with questions, score tracking, and a leaderboard saved to file.',
      difficulty:'medium',
      xp:200,
      time:'3 hours',
      objectives:['Work with structured data','Implement scoring systems','File I/O for persistence'],
      tasks:['Store quiz questions with answers','Implement question display','Track user score and answers','Calculate and show results','Save scores to leaderboard','Display top scores'],
      starterCode:`quiz_questions = [
    {"q": "What is Python?", "options": ["A", "B", "C", "D"], "answer": 0},
    # Add more questions
]

scores = []

def play_quiz():
    # Run through questions
    pass

def calculate_score(answers):
    # Calculate final score
    pass

def save_score(player_name, score):
    # Add to leaderboard
    pass

def show_leaderboard():
    # Display top 10
    pass`,
      output:`ðŸŽ® Quiz Game Results
Player: Alice
Correct: 8/10
Score: 80%
ðŸ… Rank: #2 on Leaderboard

ðŸ† Top Players:
1. Bob - 95%
2. Alice - 80%
3. Charlie - 75%`,
      hints:'ðŸ’¡ Store leaderboard in JSON: [{\"name\": \"Alice\", \"score\": 85, \"date\": \"2025-02-10\"}]'
    },
    {
      id:'py-number-games',
      title:'Number Guessing & Dice Games',
      desc:'Create a collection of number games: higher/lower guessing game, dice rolling game, and rock-paper-scissors.',
      difficulty:'medium',
      xp:180,
      time:'2.5 hours',
      objectives:['Use random module','Game loop logic','User input handling'],
      tasks:['Implement higher/lower guessing game','Implement dice rolling game','Implement rock-paper-scissors','Add score tracking','Allow multiple rounds'],
      starterCode:`import random

def higher_lower_game():
    # Guess the number game
    pass

def dice_game():
    # Roll dice, player rolls, highest wins
    pass

def rock_paper_scissors():
    # Classic game vs computer
    pass

def menu():
    # Main game menu
    pass

if __name__ == '__main__':
    menu()`,
      output:`ðŸŽ® Number Games Menu
1. Higher/Lower Guessing Game
2. Dice Rolling Game
3. Rock-Paper-Scissors
4. View Scores
5. Exit

[Higher/Lower] Guess a number (1-100): 50
Too LOW! Try higher.
[Score: 1/5 correct]`,
      hints:'ðŸ’¡ Use random.randint() for numbers and random.choice() for computer moves'
    },
    {
      id:'py-weather-app',
      title:'Weather Data Analyzer',
      desc:'Parse weather CSV data, analyze temperatures, and generate reports on weather patterns.',
      difficulty:'medium',
      xp:170,
      time:'2.5 hours',
      objectives:['File I/O with CSV','Data analysis and aggregation','Report generation'],
      tasks:['Read weather data from CSV','Calculate average temperature by month','Find hottest/coldest days','Generate weather summary','Create formatted weather report','Export results to file'],
      starterCode:`import csv

def load_weather_data(filename):
    # Read CSV and return list of records
    pass

def analyze_temperature(data):
    # Calculate average, min, max
    pass

def find_extreme_days(data):
    # Find hottest and coldest days
    pass

def generate_report(data):
    # Create formatted weather report
    pass

def main():
    data = load_weather_data('weather.csv')
    generate_report(data)`,
      output:`ðŸ“Š Weather Analysis Report
Jan 2025 Summary:
Average Temp: 45Â°F
Hottest Day: Jan 15 - 62Â°F
Coldest Day: Jan 3 - 28Â°F
Rain Days: 8
Sunny Days: 15`,
      hints:'ðŸ’¡ Use csv.DictReader() to read CSV. Store as list of dictionaries with keys: date, temp, condition, humidity'
    }
  ],
  sql: [
    {
      id:'sql-student-db',
      title:'Student Database',
      desc:'Build a comprehensive student database with courses, enrollments, and grades. Run analytical queries.',
      difficulty:'easy',
      xp:150,
      time:'2-3 hours',
      objectives:['Multi-table design','JOINs and relationships','Aggregate functions'],
      tasks:['Create students table','Create courses table','Create enrollments table','Create grades table','Insert 20+ records','Write 10 analytical queries'],
      starterCode:`CREATE TABLE students (
    id INTEGER PRIMARY KEY,
    name TEXT NOT NULL,
    email TEXT,
    enrollment_date DATE
);

-- TODO: Create courses, enrollments, grades tables

-- Query: Students with average GPA > 3.5
SELECT s.name, AVG(g.grade) as gpa
FROM students s
JOIN enrollments e ON s.id = e.student_id
JOIN grades g ON e.id = g.enrollment_id
GROUP BY s.name
HAVING AVG(g.grade) > 3.5;`,
      output:`name        | gpa
Alice       | 3.8
Bob         | 3.6
Charlie     | 3.9`,
      hints:'ðŸ’¡ Use enrollments as bridge table between students and courses. Store grades separately with enrollment_id FK'
    },
    {
      id:'sql-ecommerce-db',
      title:'E-Commerce Database',
      desc:'Create an e-commerce system with users, products, orders, and order items. Write business queries.',
      difficulty:'medium',
      xp:200,
      time:'3-4 hours',
      objectives:['Complex JOINs','Many-to-many relationships','Business analytics'],
      tasks:['Design 5 tables (users, products, categories, orders, order_items)','Insert sample data','Query revenue by category','Find best sellers','Analyze customer spending','Calculate order statistics'],
      starterCode:`CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    name TEXT,
    email TEXT,
    created_date DATE
);

CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    name TEXT,
    price DECIMAL(10,2),
    category_id INTEGER,
    stock INTEGER
);

-- TODO: Complete schema

-- Query: Top 5 best-selling products
SELECT p.name, COUNT(oi.id) as times_sold, SUM(oi.quantity) as total_quantity
-- Your JOIN logic here`,
      output:`name           | times_sold | total_quantity
Laptop         | 42         | 50
Mouse Pad      | 89         | 156
USB Cable      | 127        | 245
Monitor        | 28         | 35
Keyboard       | 61         | 94`,
      hints:'ðŸ’¡ Use order_items bridge table for many-to-many. Calculate totals with DECIMAL type for prices'
    },
    {
      id:'sql-library-db',
      title:'Library Management System',
      desc:'Build a library database with books, members, borrowings, and returns. Track overdue books.',
      difficulty:'medium',
      xp:180,
      time:'2.5-3 hours',
      objectives:['Borrowing logic','Date calculations','Complex queries'],
      tasks:['Create books, members, borrowing_records tables','Track borrow and return dates','Calculate overdue books','Find most popular books','Generate member activity reports','List books currently checked out'],
      starterCode:`CREATE TABLE books (
    id INTEGER PRIMARY KEY,
    title TEXT,
    author TEXT,
    isbn TEXT UNIQUE,
    available_count INTEGER
);

CREATE TABLE members (
    id INTEGER PRIMARY KEY,
    name TEXT,
    membership_date DATE,
    membership_type TEXT
);

CREATE TABLE borrowings (
    id INTEGER PRIMARY KEY,
    member_id INTEGER,
    book_id INTEGER,
    borrow_date DATE,
    return_date DATE,
    FOREIGN KEY (member_id) REFERENCES members(id),
    FOREIGN KEY (book_id) REFERENCES books(id)
);`,
      output:`Overdue Books:
Member: Alice | Book: Python 101 | Days Overdue: 5
Member: Bob | Book: SQL Guide | Days Overdue: 2

Most Popular Books:
1. Python 101 (borrowed 45 times)
2. Web Dev (borrowed 32 times)
3. Data Science (borrowed 28 times)`,
      hints:'ðŸ’¡ Use DATE functions: JULIANDAY(\'now\') - JULIANDAY(return_date) to calculate days overdue'
    },
    {
      id:'sql-sales-analytics',
      title:'Sales Analytics Dashboard',
      desc:'Build queries for a sales analytics dashboard: revenues, trends, performance metrics, and forecasts.',
      difficulty:'hard',
      xp:250,
      time:'3-4 hours',
      objectives:['Window functions','Subqueries','Data aggregation'],
      tasks:['Create sales transactions table','Calculate total revenue','Revenue by region/product','Calculate growth trends','Find top performers','Create month-over-month comparison'],
      starterCode:`CREATE TABLE sales (
    id INTEGER PRIMARY KEY,
    date DATE,
    product_id INTEGER,
    quantity INTEGER,
    price DECIMAL(10,2),
    region TEXT
);

-- Monthly Revenue View
CREATE VIEW monthly_revenue AS
SELECT 
    strftime('%Y-%m', date) as month,
    SUM(quantity * price) as total_revenue
FROM sales
GROUP BY strftime('%Y-%m', date);

-- TODO: More complex analytics queries`,
      output:`ðŸ“Š Sales Report - Q1 2025
January:    $125,400 (â†‘ 15% from Dec)
February:   $142,800 (â†‘ 13.8%)
March:      $156,300 (â†‘ 9.4%)

Top Region: North - $892,000
Top Product: Laptop - $542,000

Growth Rate: +8.7% month-over-month`,
      hints:'ðŸ’¡ Use DATE functions and GROUP BY for aggregation. CASE WHEN for conditional calculations'
    },
    {
      id:'sql-inventory-system',
      title:'Inventory Management System',
      desc:'Track product inventory across warehouses, manage stock levels, and generate low-stock alerts.',
      difficulty:'medium',
      xp:170,
      time:'2.5 hours',
      objectives:['Multi-location tracking','Stock calculations','Alert system logic'],
      tasks:['Create warehouses and inventory tables','Track stock by location','Calculate total stock','Find low-stock items','Track stock movement','Generate inventory reports'],
      starterCode:`CREATE TABLE warehouses (
    id INTEGER PRIMARY KEY,
    name TEXT,
    location TEXT,
    capacity INTEGER
);

CREATE TABLE inventory (
    id INTEGER PRIMARY KEY,
    warehouse_id INTEGER,
    product_id INTEGER,
    quantity INTEGER,
    min_threshold INTEGER,
    last_updated DATE
);

-- Find low stock items
SELECT p.name, SUM(i.quantity) as total_stock
FROM inventory i
JOIN products p ON i.product_id = p.id
GROUP BY p.id
HAVING SUM(i.quantity) < MIN(i.min_threshold);`,
      output:`âš ï¸ Low Stock Alert
Laptop: 3 units (min: 10) - URGENT
Mouse: 7 units (min: 50) - WARNING
Monitor: 2 units (min: 5) - URGENT

âœ“ Adequate Stock: 47 products`,
      hints:'ðŸ’¡ Use warehouses as locations. Track min_threshold for each product per warehouse'
    }
  ],
  golang: [
    {
      id:'go-todo-cli',
      title:'To-Do CLI Application',
      desc:'Build a command-line to-do app with add, complete, delete, list, and filter tasks. Save to JSON.',
      difficulty:'easy',
      xp:150,
      time:'2-3 hours',
      objectives:['Struct and methods','File I/O','CLI interfaces'],
      tasks:['Define Task struct','Implement add, complete, delete functions','Implement list and filter functions','Add save/load from JSON','Create interactive menu loop'],
      starterCode:`package main

import (
    "fmt"
    "encoding/json"
    "io/ioutil"
)

type Task struct {
    ID        int    \`json:"id"\`
    Title     string \`json:"title"\`
    Completed bool   \`json:"completed"\`
    Priority  string \`json:"priority"\`
}

var tasks []Task

func (t *Task) Mark() {
    t.Completed = true
}

func addTask(title string) {
    // Add new task
}

func main() {
    // Menu loop
}`,
      output:`ðŸ“Œ To-Do List
[1] âœ“ Finish Go project
[2] â­• Review JSON (High)
[3] â­• Write blog post

1.Add 2.Complete 3.Delete 4.List 5.Quit
Choose: `,
      hints:'ðŸ’¡ Use ioutil.ReadFile() and json.Marshal/Unmarshal(). Store tasks with unique ID'
    },
    {
      id:'go-web-server',
      title:'Simple HTTP Web Server',
      desc:'Build a basic web server that serves HTML pages, handles routes, and logs requests.',
      difficulty:'medium',
      xp:200,
      time:'2.5-3 hours',
      objectives:['HTTP handlers','Routing','Logging'],
      tasks:['Create home page route','Create about page route','Create contact route','Add 404 handling','Implement request logging','Add JSON response endpoints'],
      starterCode:`package main

import (
    "fmt"
    "net/http"
    "log"
)

func main() {
    http.HandleFunc("/", homeHandler)
    http.HandleFunc("/about", aboutHandler)
    http.HandleFunc("/contact", contactHandler)
    
    log.Println("Server starting on :8080")
    http.ListenAndServe(":8080", nil)
}

func homeHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "<h1>Welcome to My Site</h1>")
}`,
      output:`Server starting on :8080
GET / from 127.0.0.1:54321
GET /about from 127.0.0.1:54322
GET /contact from 127.0.0.1:54323
404 /unknown from 127.0.0.1:54324`,
      hints:'ðŸ’¡ Use http.HandleFunc() for routes. Add middleware for logging requests'
    },
    {
      id:'go-calculator',
      title:'Advanced Calculator with Functions',
      desc:'Build a calculator with basic operations, statistical functions, and history tracking.',
      difficulty:'easy',
      xp:120,
      time:'1.5-2 hours',
      objectives:['Functions','Error handling','History tracking'],
      tasks:['Implement basic operations (+,-,*,/)','Add stat functions (avg, sum, max, min)','Track calculation history','Display history','Handle division by zero error'],
      starterCode:`package main

import "fmt"

type Calculator struct {
    history []string
}

func (c *Calculator) Add(a, b float64) float64 {
    result := a + b
    c.history = append(c.history, fmt.Sprintf("%f + %f = %f", a, b, result))
    return result
}

func (c *Calculator) ShowHistory() {
    for i, h := range c.history {
        fmt.Printf("%d. %s\\n", i+1, h)
    }
}

func main() {
    calc := &Calculator{}
    // Use calculator
}`,
      output:`Calculator
5 + 3 = 8
10 / 2 = 5
Error: Cannot divide by zero
History:
1. 5 + 3 = 8
2. 10 / 2 = 5`,
      hints:'ðŸ’¡ Use defer for cleanup. Handle errors with if err != nil pattern'
    },
    {
      id:'go-file-processor',
      title:'File Processing Tool',
      desc:'Create a tool that reads text files, analyzes content, counts words/lines, and generates reports.',
      difficulty:'medium',
      xp:170,
      time:'2-2.5 hours',
      objectives:['File I/O','String processing','Data analysis'],
      tasks:['Read file with error handling','Count lines, words, characters','Find most common words','Generate statistics report','Handle multiple files'],
      starterCode:`package main

import (
    "bufio"
    "fmt"
    "os"
)

type FileStats struct {
    Lines      int
    Words      int
    Characters int
}

func (fs *FileStats) Process(filename string) error {
    file, err := os.Open(filename)
    if err != nil {
        return fmt.Errorf("cannot open file: %w", err)
    }
    defer file.Close()
    
    scanner := bufio.NewScanner(file)
    for scanner.Scan() {
        // Count lines, words, chars
    }
    return scanner.Err()
}

func main() {
    stats := &FileStats{}
    err := stats.Process("input.txt")
    // Handle error
}`,
      output:`ðŸ“„ File Analysis Report
File: input.txt
Lines: 245
Words: 3,240
Characters: 18,950

Most common word: "the" (142 times)
Average words per line: 13.2`,
      hints:'ðŸ’¡ Use bufio.Scanner for line-by-line reading. Use strings.Fields() to count words'
    },
    {
      id:'go-concurrent-downloader',
      title:'Concurrent Task Downloader',
      desc:'Build a downloader using goroutines to fetch multiple files concurrently with progress tracking.',
      difficulty:'hard',
      xp:250,
      time:'3-4 hours',
      objectives:['Goroutines','Channels','Concurrency patterns'],
      tasks:['Create download worker function','Use goroutines for parallel downloads','Implement progress tracking','Add error handling','Track completion status','Display summary report'],
      starterCode:`package main

import (
    "fmt"
    "sync"
    "time"
)

type DownloadTask struct {
    URL      string
    Filename string
}

type Result struct {
    Task  DownloadTask
    Error error
}

func download(task DownloadTask, results chan Result) {
    // Simulate download
    time.Sleep(time.Second)
    results <- Result{Task: task, Error: nil}
}

func main() {
    tasks := []DownloadTask{
        {"url1", "file1.txt"},
        {"url2", "file2.txt"},
    }
    
    results := make(chan Result, len(tasks))
    var wg sync.WaitGroup
    
    for _, task := range tasks {
        wg.Add(1)
        go func(t DownloadTask) {
            defer wg.Done()
            download(t, results)
        }(task)
    }
    
    wg.Wait()
    close(results)
}`,
      output:`ðŸ“¥ Concurrent Downloader
Downloading 5 files...
âœ“ file1.txt (2.3 MB) - 1.2s
âœ“ file2.txt (1.8 MB) - 0.9s
âœ“ file3.txt (3.1 MB) - 1.5s
âš  file4.txt - Connection timeout
âœ“ file5.txt (2.0 MB) - 1.1s

Completed: 4/5
Total time: 1.5s (with concurrency)`,
      hints:'ðŸ’¡ Use sync.WaitGroup to wait for all goroutines. Use channels to collect results safely'
    }
  ]
};

let currentMiniProjectFilter = 'all';
let currentMiniProjectDetail = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DAILY TIPS DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DAILY_TIPS = [
  {tip:'Python tip: Use f-strings for readable formatting: f"Hello {name}, you are {age} years old"',challenge:'Create 3 variables and print them using an f-string.'},
  {tip:'SQL tip: Always use WHERE with UPDATE/DELETE to avoid modifying all rows accidentally!',challenge:'Write a DELETE statement that only removes inactive users.'},
  {tip:'Go tip: Use := for short variable declaration inside functions. var is for package-level.',challenge:'Declare 3 variables using := and print them.'},
  {tip:'Debug tip: When stuck, explain your code to a rubber duck (or a friend). Verbalizing helps!',challenge:'Pick any exercise and explain your solution step by step.'},
  {tip:'Python tip: List comprehensions are faster and cleaner than for loops for creating lists.',challenge:'Convert this loop to a list comprehension: result=[]; for x in range(10): result.append(x*2)'},
  {tip:'SQL tip: Use aliases to make queries readable: SELECT u.name FROM users AS u',challenge:'Write a SELECT with table aliases joining 2 tables.'},
  {tip:'Go tip: Always handle errors! if err != nil { log.Fatal(err) } is the Go way.',challenge:'Write a function that returns an error and handle it in main().'},
  {tip:'Practice tip: Code every day, even just 15 minutes. Consistency beats intensity!',challenge:'Set a timer for 15 minutes and solve one exercise.'},
  {tip:'Python tip: Use enumerate() instead of range(len()) for cleaner loops with indices.',challenge:'Loop through a list using enumerate() and print index + value.'},
  {tip:'SQL tip: COALESCE(column, default) replaces NULL values with a default.',challenge:'Write a query using COALESCE to replace NULL prices with 0.'},
  {tip:'Go tip: Slices are references to arrays. Modifying a slice modifies the underlying array.',challenge:'Create a slice, pass it to a function, modify it, and verify the change.'},
  {tip:'Algorithm tip: Break big problems into small steps. Solve each step, then combine.',challenge:'Break "sort a list" into 3 smaller sub-problems and solve each.'},
  {tip:'Python tip: Use .get() on dictionaries to avoid KeyError: d.get("key", "default")',challenge:'Create a dictionary and safely access a missing key with .get()'},
  {tip:'SQL tip: Use DISTINCT to get unique values: SELECT DISTINCT category FROM products',challenge:'Write a query to find all unique categories in a table.'},
  {tip:'Go tip: Use defer for cleanup: defer file.Close() runs when function returns.',challenge:'Write a function that opens a file and uses defer to close it.'},
  {tip:'Testing tip: Write the test BEFORE the code (TDD). It clarifies what you need to build.',challenge:'Write what you expect a function to return before coding it.'},
  {tip:'Python tip: zip() combines two lists: list(zip(names, ages)) creates pairs.',challenge:'Use zip() to combine a list of names with a list of scores.'},
  {tip:'SQL tip: EXISTS is faster than IN for subqueries checking existence.',challenge:'Rewrite a query using EXISTS instead of IN.'},
  {tip:'Go tip: Use goroutines with go keyword for concurrent tasks: go myFunction()',challenge:'Launch 3 goroutines that each print a different message.'},
  {tip:'Debugging tip: Add print statements at key points to trace your program flow.',challenge:'Add 3 strategic print statements to debug a broken loop.'},
  {tip:'Python tip: Use with statement for files - it auto-closes: with open("f.txt") as f:',challenge:'Read a file using with and count the lines.'},
  {tip:'SQL tip: Use BETWEEN for range queries: WHERE price BETWEEN 10 AND 50',challenge:'Write a query to find products in a price range.'},
  {tip:'Go tip: Use fmt.Sprintf for string formatting without printing.',challenge:'Use fmt.Sprintf to create a greeting string and store it.'},
  {tip:'Practice tip: After solving a problem, try to solve it a different way. It deepens understanding.',challenge:'Pick a previous exercise and solve it using a different approach.'},
  {tip:'Python tip: Negative indexing: my_list[-1] gets the last element, [-2] second to last.',challenge:'Use negative indexing to get the last 3 items of a list.'},
  {tip:'SQL tip: Use CASE WHEN for conditional logic in SELECT statements.',challenge:'Write a query that categorizes prices as cheap/medium/expensive.'},
  {tip:'Go tip: Use blank identifier _ to ignore values: for _, v := range slice {}',challenge:'Write a range loop that only uses values, not indices.'},
  {tip:'Code review tip: Read your code after a break. Fresh eyes catch bugs faster.',challenge:'Review code you wrote yesterday and find one improvement.'},
  {tip:'Python tip: Use *args and **kwargs for flexible function parameters.',challenge:'Write a function that accepts any number of arguments and sums them.'},
  {tip:'SQL tip: UNION combines results from multiple queries (removes duplicates).',challenge:'Write two SELECT queries and combine them with UNION.'}
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PEER CHALLENGE DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PEER_PROBLEMS = [
  {title:'Reverse a String',desc:'Write code to reverse a string without using built-in reverse functions.',lang:'any'},
  {title:'FizzBuzz',desc:'Print 1-30. For multiples of 3 print "Fizz", 5 print "Buzz", both print "FizzBuzz".',lang:'any'},
  {title:'Count Vowels',desc:'Write a function that counts vowels (a,e,i,o,u) in a given string.',lang:'any'},
  {title:'Palindrome Check',desc:'Write code to check if a word is a palindrome (reads same forwards and backwards).',lang:'any'},
  {title:'Sum of Digits',desc:'Given a number, find the sum of its digits (e.g., 123 -> 6).',lang:'any'},
  {title:'Find Duplicates',desc:'Given a list of numbers, find and return all duplicate values.',lang:'any'},
  {title:'Fibonacci',desc:'Generate the first 15 numbers in the Fibonacci sequence.',lang:'any'},
  {title:'Largest Word',desc:'Given a sentence, find and return the longest word.',lang:'any'},
  {title:'Common Elements',desc:'Given two lists, find elements that appear in both.',lang:'any'},
  {title:'Title Case',desc:'Convert "hello world from go" to "Hello World From Go" (capitalize each word).',lang:'any'}
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STREAK MILESTONES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const STREAK_MILESTONES = [
  {days:3,label:'3 days',color:'#d97706',reward:'Purple theme unlocked!'},
  {days:7,label:'1 week',color:'#e63946',reward:'Red theme unlocked!'},
  {days:14,label:'2 weeks',color:'#2ec4b6',reward:'Teal theme unlocked!'},
  {days:21,label:'3 weeks',color:'#ff9f1c',reward:'Gold theme unlocked!'},
  {days:30,label:'1 month',color:'#06d6a0',reward:'Emerald theme unlocked!'}
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DEBUG EXERCISES FUNCTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchDebugLang(lang) {
  debugLang = lang;
  document.querySelectorAll('#debugex .btn-sm').forEach(b => { b.className = 'btn btn-sm btn-outline'; });
  event.target.className = 'btn btn-sm btn-primary';
  renderDebugExercises();
}

function renderDebugExercises() {
  const list = document.getElementById('debugList');
  const exs = DEBUG_EXERCISES[debugLang] || [];
  const solved = load('dm_debug_solved_'+users[currentUserIdx]+'_'+debugLang, []);
  document.getElementById('debugTotal').textContent = exs.length;
  document.getElementById('debugScore').textContent = solved.length;
  list.innerHTML = exs.map((ex,i) => {
    const isSolved = solved.includes(i);
    return `<div class="debug-card">
      <h4><span>${isSolved?'âœ…':''} ${esc(ex.title)}</span><span class="diff-badge diff-medium">debug</span></h4>
      <p style="font-size:.85rem;color:var(--muted);margin-bottom:.3rem">Bug: ${esc(ex.bug)}</p>
      <div class="debug-code">${esc(ex.code)}</div>
      ${isSolved ? `<div class="debug-result correct" style="display:block">Solved! Fix: <code>${esc(ex.fix)}</code></div>` :
      `<input class="debug-input" id="debugIn${i}" placeholder="Type the corrected line..." onkeydown="if(event.key==='Enter')checkDebug(${i})">
      <div style="display:flex;gap:.5rem;align-items:center">
        <button class="btn btn-sm btn-primary" onclick="checkDebug(${i})">Check Fix</button>
        <details><summary style="cursor:pointer;font-size:.78rem;color:var(--muted)">Hint</summary><span style="font-size:.8rem;color:var(--muted)">${esc(ex.hint)}</span></details>
      </div>
      <div class="debug-result" id="debugRes${i}"></div>`}
    </div>`;
  }).join('');
}

function checkDebug(idx) {
  const ex = DEBUG_EXERCISES[debugLang][idx];
  const input = document.getElementById('debugIn'+idx).value.trim();
  const res = document.getElementById('debugRes'+idx);
  const normalize = s => s.replace(/\s+/g,' ').trim().toLowerCase();
  if (normalize(input) === normalize(ex.fix)) {
    res.className = 'debug-result correct';
    res.innerHTML = 'Correct! Great debugging!';
    res.style.display = 'block';
    let solved = load('dm_debug_solved_'+users[currentUserIdx]+'_'+debugLang, []);
    if (!solved.includes(idx)) { solved.push(idx); save('dm_debug_solved_'+users[currentUserIdx]+'_'+debugLang, solved); addXP(20,'Debug fixed'); }
    renderDebugExercises();
  } else {
    res.className = 'debug-result wrong';
    res.innerHTML = 'Not quite. Try again! Make sure to type the corrected line exactly.';
    res.style.display = 'block';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FILL IN THE BLANK FUNCTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchFITBLang(lang) {
  fitbLang = lang;
  document.querySelectorAll('#fillblank .btn-sm').forEach(b => { b.className = 'btn btn-sm btn-outline'; });
  event.target.className = 'btn btn-sm btn-primary';
  renderFITB();
}

function renderFITB() {
  const list = document.getElementById('fitbList');
  const exs = FITB_EXERCISES[fitbLang] || [];
  const solved = load('dm_fitb_solved_'+users[currentUserIdx]+'_'+fitbLang, []);
  document.getElementById('fitbTotal').textContent = exs.length;
  document.getElementById('fitbScore').textContent = solved.length;
  list.innerHTML = exs.map((ex,i) => {
    const isSolved = solved.includes(i);
    let blankIdx = 0;
    const codeHtml = ex.code.replace(/___BLANK___/g, () => {
      const bi = blankIdx++;
      if (isSolved) return `<span class="fitb-blank" style="color:#2ec4b6;border-color:#2ec4b6">${esc(ex.blanks[bi])}</span>`;
      return `<span class="fitb-blank"><input id="fitb_${i}_${bi}" placeholder="?" autocomplete="off"></span>`;
    });
    return `<div class="fitb-card">
      <h4 style="margin-bottom:.5rem">${isSolved?'âœ…':''} ${esc(ex.desc)}</h4>
      <div class="fitb-code"><pre style="margin:0;background:transparent;color:inherit;padding:0">${codeHtml}</pre></div>
      ${isSolved ? '' : `<button class="btn btn-sm btn-primary" onclick="checkFITB(${i})" style="margin-top:.4rem">Check Answers</button>`}
      <div class="fitb-result" id="fitbRes${i}"></div>
    </div>`;
  }).join('');
}

function checkFITB(idx) {
  const ex = FITB_EXERCISES[fitbLang][idx];
  let allCorrect = true;
  ex.blanks.forEach((ans, bi) => {
    const input = document.getElementById(`fitb_${idx}_${bi}`);
    if (input.value.trim().toLowerCase() === ans.toLowerCase()) {
      input.style.color = '#2ec4b6';
    } else {
      input.style.color = '#e63946';
      allCorrect = false;
    }
  });
  const res = document.getElementById('fitbRes'+idx);
  if (allCorrect) {
    res.className = 'fitb-result show';
    res.style.color = 'var(--success)';
    res.textContent = 'All correct!';
    let solved = load('dm_fitb_solved_'+users[currentUserIdx]+'_'+fitbLang, []);
    if (!solved.includes(idx)) { solved.push(idx); save('dm_fitb_solved_'+users[currentUserIdx]+'_'+fitbLang, solved); addXP(15,'Fill blank correct'); }
    setTimeout(() => renderFITB(), 800);
  } else {
    res.className = 'fitb-result show';
    res.style.color = 'var(--danger)';
    res.textContent = 'Some blanks are wrong. Red = incorrect. Try again!';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DRAG & DROP CODE ORDER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchDnDLang(lang) {
  dndLang = lang;
  document.querySelectorAll('#codeorder .btn-sm').forEach(b => { b.className = 'btn btn-sm btn-outline'; });
  event.target.className = 'btn btn-sm btn-primary';
  renderDnD();
}

function renderDnD() {
  const list = document.getElementById('dndList');
  const exs = DND_EXERCISES[dndLang] || [];
  list.innerHTML = exs.map((ex,i) => {
    const shuffled = [...ex.lines].sort(() => Math.random() - 0.5);
    return `<div class="dnd-card" id="dndCard${i}">
      <h4 style="margin-bottom:.6rem">${esc(ex.desc)}</h4>
      <div class="dnd-lines" id="dndLines${i}">
        ${shuffled.map((line,li) => `<div class="dnd-line" draggable="true" data-line="${esc(line)}"
          ondragstart="dndDragStart(event)" ondragover="dndDragOver(event)" ondrop="dndDrop(event,${i})" ondragend="dndDragEnd(event)">
          <span class="drag-handle">â ¿</span><code>${line===''?'(empty line)':esc(line)}</code>
        </div>`).join('')}
      </div>
      <button class="btn btn-sm btn-primary" onclick="checkDnD(${i})" style="margin-top:.5rem">Check Order</button>
      <button class="btn btn-sm btn-outline" onclick="renderDnD()" style="margin-top:.5rem">Reshuffle</button>
      <div id="dndRes${i}" style="margin-top:.4rem;font-size:.85rem"></div>
    </div>`;
  }).join('');
}

let dndDragging = null;
function dndDragStart(e) { dndDragging = e.target.closest('.dnd-line'); e.dataTransfer.effectAllowed = 'move'; }
function dndDragOver(e) { e.preventDefault(); e.dataTransfer.dropEffect = 'move'; const line = e.target.closest('.dnd-line'); if(line) line.classList.add('drag-over'); }
function dndDragEnd(e) { document.querySelectorAll('.dnd-line').forEach(l => l.classList.remove('drag-over')); }
function dndDrop(e, cardIdx) {
  e.preventDefault();
  const target = e.target.closest('.dnd-line');
  if (!target || !dndDragging || target === dndDragging) return;
  const container = document.getElementById('dndLines'+cardIdx);
  const lines = [...container.children];
  const fromIdx = lines.indexOf(dndDragging);
  const toIdx = lines.indexOf(target);
  if (fromIdx < toIdx) target.after(dndDragging);
  else target.before(dndDragging);
  document.querySelectorAll('.dnd-line').forEach(l => l.classList.remove('drag-over'));
}

function checkDnD(cardIdx) {
  const ex = DND_EXERCISES[dndLang][cardIdx];
  const container = document.getElementById('dndLines'+cardIdx);
  const lines = [...container.children];
  let correct = 0;
  lines.forEach((l,i) => {
    const val = l.dataset.line;
    l.classList.remove('correct-line','wrong-line');
    if (val === ex.lines[i]) { l.classList.add('correct-line'); correct++; }
    else { l.classList.add('wrong-line'); }
  });
  const res = document.getElementById('dndRes'+cardIdx);
  if (correct === ex.lines.length) {
    res.innerHTML = '<span style="color:var(--success);font-weight:600">Perfect order! All lines correct!</span>';
    addXP(20, 'Code order correct');
  } else {
    res.innerHTML = `<span style="color:var(--warn)">${correct}/${ex.lines.length} lines in correct position. Green=correct, Red=wrong.</span>`;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PROGRESS MAP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let pmLang = 'python';
function switchProgressMap(lang, btn) {
  pmLang = lang;
  document.querySelectorAll('#progressmap .pm-lang-tabs .btn').forEach(b => b.className='btn btn-sm btn-outline');
  if (btn) btn.className='btn btn-sm btn-primary';
  renderProgressMap();
}

function renderProgressMap() {
  const container = document.getElementById('progressMapContainer');
  if (!container) return;
  const concepts = CONCEPTS[pmLang] || [];
  const done = getConceptDone(pmLang);
  const total = concepts.length;
  const doneCount = done.length;
  const currentIdx = concepts.findIndex((c,i) => !done.includes(i) && (i===0 || done.includes(i-1)));
  const lockedCount = total - doneCount - (currentIdx >= 0 ? 1 : 0);
  const pct = total > 0 ? Math.round(doneCount/total*100) : 0;
  document.getElementById('pmPercent').textContent = pct + '%';
  document.getElementById('pmBar').style.width = pct + '%';
  const summaryHtml = `<div class="pm-summary">
    <div class="pm-summary-item"><div class="dot" style="background:var(--success)"></div> ${doneCount} Completed</div>
    <div class="pm-summary-item"><div class="dot" style="background:var(--accent)"></div> ${currentIdx >= 0 ? 1 : 0} Current</div>
    <div class="pm-summary-item"><div class="dot" style="background:var(--border)"></div> ${lockedCount} Locked</div>
  </div>`;
  container.innerHTML = summaryHtml + `<div class="pm-track">${concepts.map((c,i) => {
    const isDone = done.includes(i);
    const isCurrent = !isDone && (i===0 || done.includes(i-1));
    const cls = isDone ? 'done' : (isCurrent ? 'current' : 'locked');
    const clickable = isDone || isCurrent;
    return `<div class="pm-node ${cls}">
      <div class="pm-dot ${cls}" ${clickable ? `onclick="toggleProgressNode('${pmLang}',${i})" title="Click to toggle"` : 'title="Complete previous concepts first"'}>${isDone ? 'âœ“' : (i+1)}</div>
      <div class="pm-info">
        <div class="pm-title">${esc(c.title)}</div>
        <div class="pm-sub">${isDone ? 'âœ… Completed â€” click to undo' : (isCurrent ? 'ðŸ‘‰ Up next â€” click to mark done' : 'ðŸ”’ Locked')}</div>
      </div>
      ${i < concepts.length-1 ? '<div class="pm-line"></div>' : ''}
    </div>`;
  }).join('')}</div>`;
}

function toggleProgressNode(lang, idx) {
  let done = getConceptDone(lang);
  if (done.includes(idx)) {
    done = done.filter(x => x !== idx);
    showToast('â†©ï¸', 'Concept unmarked');
  } else {
    done.push(idx);
    addXP(15, 'Concept completed from map');
    showToast('ðŸŽ‰', 'Concept completed! +15 XP');
  }
  setConceptDone(lang, done);
  renderProgressMap();
  renderAllConcepts();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHEAT SHEET PANEL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let csCurrentLang = 'python';

function switchCheatSheetLang(lang, btn) {
  csCurrentLang = lang;
  document.querySelectorAll('.cs-lang-tab').forEach(b => b.classList.remove('active'));
  if (btn) btn.classList.add('active');
  document.getElementById('csSearchInput').value = '';
  renderCheatSheetPanel();
}

function renderCheatSheetPanel() {
  const el = document.getElementById('csContent');
  if (!el) return;
  el.innerHTML = CHEATSHEETS[csCurrentLang] || '<p>No cheat sheet data available.</p>';
}

function filterCheatSheet() {
  const query = document.getElementById('csSearchInput').value.toLowerCase().trim();
  const sections = document.querySelectorAll('#csContent .cheat-section');
  sections.forEach(sec => {
    const text = sec.textContent.toLowerCase();
    sec.style.display = text.includes(query) ? '' : 'none';
  });
  const pre = document.querySelectorAll('#csContent pre');
  pre.forEach(p => {
    const text = p.textContent.toLowerCase();
    p.parentElement.style.display = text.includes(query) ? '' : 'none';
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DAILY TIP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDailyTip() {
  const el = document.getElementById('dailyTipCard');
  if (!el) return;
  const dayOfYear = Math.floor((Date.now() - new Date(new Date().getFullYear(),0,0)) / 86400000);
  const tip = DAILY_TIPS[dayOfYear % DAILY_TIPS.length];
  el.innerHTML = `<h3>ðŸ’¡ Tip of the Day</h3>
    <div class="tip-text">${esc(tip.tip)}</div>
    <div class="tip-challenge"><strong>Mini Challenge:</strong> ${esc(tip.challenge)}</div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STUDY TIMER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let studyTimerInterval = null;
let studyTimerStart = null;
let studyTimerLang = null;

function trackStudyTime(panelId) {
  // Save previous session
  if (studyTimerLang && studyTimerStart) {
    const elapsed = Math.floor((Date.now() - studyTimerStart) / 1000);
    if (elapsed > 5) {
      const today = new Date().toISOString().slice(0,10);
      const key = 'dm_study_'+users[currentUserIdx]+'_'+today;
      let times = load(key, {python:0,sql:0,golang:0});
      times[studyTimerLang] = (times[studyTimerLang]||0) + elapsed;
      save(key, times);
    }
  }
  // Start new tracking
  clearInterval(studyTimerInterval);
  studyTimerStart = null;
  studyTimerLang = null;
  const active = document.getElementById('studyTimerActive');
  if (['python','sql','golang'].includes(panelId)) {
    studyTimerLang = panelId;
    studyTimerStart = Date.now();
    if (active) {
      active.style.display = 'flex';
      document.getElementById('stActiveLang').textContent = panelId.charAt(0).toUpperCase()+panelId.slice(1);
      studyTimerInterval = setInterval(() => {
        const s = Math.floor((Date.now()-studyTimerStart)/1000);
        document.getElementById('stActiveTime').textContent = Math.floor(s/60)+':'+String(s%60).padStart(2,'0');
      }, 1000);
    }
  } else {
    if (active) active.style.display = 'none';
  }
}

function renderStudyTimerBar() {
  const bar = document.getElementById('studyTimerBar');
  if (!bar) return;
  const today = new Date().toISOString().slice(0,10);
  const times = load('dm_study_'+users[currentUserIdx]+'_'+today, {python:0,sql:0,golang:0});
  const total = times.python + times.sql + times.golang;
  if (total === 0) {
    bar.innerHTML = '<div style="font-size:.82rem;color:var(--muted);padding:.3rem">No study time recorded today. Open a module to start tracking!</div>';
    return;
  }
  const fmt = s => { const m=Math.floor(s/60); return m>0?m+'m':'<1m'; };
  bar.innerHTML = `
    <div class="st-segment st-python" style="flex:${times.python||1}">ðŸ ${fmt(times.python)}</div>
    <div class="st-segment st-sql" style="flex:${times.sql||1}">ðŸ—„ï¸ ${fmt(times.sql)}</div>
    <div class="st-segment st-golang" style="flex:${times.golang||1}">ðŸ”· ${fmt(times.golang)}</div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STREAK MILESTONES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderStreakMilestones() {
  const el = document.getElementById('streakMilestones');
  if (!el) return;
  const streak = getStreak();
  const unlockedThemes = load('dm_streak_themes_'+users[currentUserIdx], []);
  el.innerHTML = STREAK_MILESTONES.map(ms => {
    const unlocked = streak >= ms.days;
    if (unlocked && !unlockedThemes.includes(ms.days)) {
      unlockedThemes.push(ms.days);
      save('dm_streak_themes_'+users[currentUserIdx], unlockedThemes);
    }
    return `<span class="streak-ms ${unlocked?'unlocked':''}" ${unlocked?`onclick="applyStreakTheme('${ms.color}')" style="cursor:pointer" title="Click to apply ${ms.label} theme"`:''}>${ms.label} ${unlocked?'ðŸŽ¨':''}</span>`;
  }).join('');
}

function applyStreakTheme(color) {
  document.documentElement.style.setProperty('--accent', color);
  save('dm_custom_accent_'+users[currentUserIdx], color);
  showToast('ðŸŽ¨', 'Theme color applied!');
}

function loadCustomTheme() {
  const color = load('dm_custom_accent_'+users[currentUserIdx], null);
  if (color) document.documentElement.style.setProperty('--accent', color);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONCEPT COMPLETION TRACKING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getConceptCompletionPct() {
  let total = 0, done = 0;
  for (const mod of ['python','sql','golang']) {
    const concepts = CONCEPTS[mod] || [];
    const completed = getConceptDone(mod);
    total += concepts.length;
    done += completed.length;
  }
  return total > 0 ? Math.round(done/total*100) : 0;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PEER CHALLENGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initPeerChallenge() {
  const s1 = document.getElementById('peer1');
  const s2 = document.getElementById('peer2');
  if (!s1 || !s2) return;
  s1.innerHTML = users.map((u,i) => `<option value="${i}">${esc(u)}</option>`).join('');
  s2.innerHTML = users.map((u,i) => `<option value="${i}" ${i===1||i===0?'':''}>${esc(u)}</option>`).join('');
  if (users.length > 1) s2.value = '1';
}

function startPeerChallenge() {
  const problem = PEER_PROBLEMS[Math.floor(Math.random()*PEER_PROBLEMS.length)];
  document.getElementById('peerProblem').style.display = 'block';
  document.getElementById('peerProblemTitle').textContent = problem.title;
  document.getElementById('peerProblemDesc').textContent = problem.desc;
  const p1 = users[document.getElementById('peer1').value];
  const p2 = users[document.getElementById('peer2').value];
  document.getElementById('peerName1').textContent = p1;
  document.getElementById('peerName2').textContent = p2;
  document.getElementById('peerAns1').value = '';
  document.getElementById('peerAns2').value = '';
  document.getElementById('peerResult').style.display = 'none';
}

function submitPeerChallenge() {
  const a1 = document.getElementById('peerAns1').value.trim();
  const a2 = document.getElementById('peerAns2').value.trim();
  const p1 = document.getElementById('peerName1').textContent;
  const p2 = document.getElementById('peerName2').textContent;
  const res = document.getElementById('peerResult');
  res.style.display = 'block';
  const lines1 = a1.split('\n').filter(l=>l.trim()).length;
  const lines2 = a2.split('\n').filter(l=>l.trim()).length;
  res.innerHTML = `<div style="border:1px solid var(--border);border-radius:10px;padding:1rem;text-align:center">
    <h4 style="margin-bottom:.8rem">Challenge Complete!</h4>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
      <div><strong>${esc(p1)}</strong><br>${lines1} lines of code<br>${a1.length} characters</div>
      <div><strong>${esc(p2)}</strong><br>${lines2} lines of code<br>${a2.length} characters</div>
    </div>
    <p style="margin-top:.8rem;font-size:.85rem;color:var(--muted)">Review each other's code and discuss different approaches!</p>
  </div>`;
  addXP(25, 'Peer challenge completed');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STREAK TRACKER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderStreakTracker() {
  const u = users[currentUserIdx];
  const streak = getStreak();
  const longestStreakKey = 'dm_longest_streak_' + u;
  const longestStreak = Math.max(streak, load(longestStreakKey, 0));
  if (longestStreak > streak) save(longestStreakKey, longestStreak);
  
  // Calculate stats
  const activityDates = load('dm_activity_dates_' + u, []);
  const today = new Date();
  const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
  const weekStart = new Date(today.setDate(today.getDate() - today.getDay()));
  
  let thisMonthDays = 0, thisWeekDays = 0, totalDays = activityDates.length;
  for (const d of activityDates) {
    const date = new Date(d);
    if (date >= monthStart) thisMonthDays++;
    if (date >= weekStart) thisWeekDays++;
  }
  
  // Check if streak at risk (last activity > 1 day ago)
  const lastActivityKey = 'dm_last_activity_' + u;
  const lastActivity = load(lastActivityKey, new Date().toISOString().split('T')[0]);
  const lastDate = new Date(lastActivity);
  const todayDate = new Date();
  todayDate.setHours(0, 0, 0, 0);
  const daysSinceActivity = Math.floor((todayDate - lastDate) / (1000 * 60 * 60 * 24));
  const streakAtRisk = daysSinceActivity > 1;
  
  // Streak start date
  const streakStartKey = 'dm_streak_start_' + u;
  const streakStartDate = load(streakStartKey, new Date().toISOString().split('T')[0]);
  
  // Milestones
  const milestones = [
    {days: 7, emoji: 'â­', label: '7-Day Streak'},
    {days: 14, emoji: 'âœ¨', label: 'Two Weeks'},
    {days: 30, emoji: 'ðŸ”¥', label: 'One Month'},
    {days: 100, emoji: 'ðŸ’Ž', label: 'Hundred Days'},
    {days: 365, emoji: 'ðŸ‘‘', label: 'One Year'}
  ];
  
  const unlockedMilestones = milestones.filter(m => streak >= m.days).map(m => `<span class="streak-ms unlocked">${m.emoji} ${m.label}</span>`).join('');
  const lockedMilestones = milestones.filter(m => streak < m.days).map(m => `<span class="streak-ms">${m.emoji} ${m.label}</span>`).join('');
  
  // Calendar for last 30 days
  const calendar = [];
  const days = 30;
  const actSet = new Set(activityDates);
  for (let i = days - 1; i >= 0; i--) {
    const d = new Date();
    d.setDate(d.getDate() - i);
    const dateStr = d.toISOString().split('T')[0];
    const hasActivity = actSet.has(dateStr);
    const isToday = dateStr === new Date().toISOString().split('T')[0];
    const isStart = dateStr === streakStartDate;
    const dayHtml = `<div class="streak-day ${hasActivity ? 'active' : ''} ${isToday ? 'today' : ''} ${isStart ? 'start' : ''}" title="${dateStr}"><span class="streak-tip">${dateStr}</span></div>`;
    calendar.push(dayHtml);
  }
  
  const el = document.getElementById('streakTrackerCount');
  if (el) el.textContent = streak;
  if (document.getElementById('longestStreak')) document.getElementById('longestStreak').textContent = longestStreak;
  if (document.getElementById('streakCalTracker')) document.getElementById('streakCalTracker').innerHTML = calendar.join('');
  if (document.getElementById('streakMilestones')) document.getElementById('streakMilestones').innerHTML = unlockedMilestones + lockedMilestones;
  if (document.getElementById('streakWarning')) {
    if (streakAtRisk) {
      document.getElementById('streakWarning').style.display = 'block';
      document.getElementById('streakWarningMsg').textContent = `âš ï¸ You haven't coded for ${daysSinceActivity} days. Code today to maintain your ${streak}-day streak!`;
    } else {
      document.getElementById('streakWarning').style.display = 'none';
    }
  }
  if (document.getElementById('totalDaysCoded')) document.getElementById('totalDaysCoded').textContent = totalDays;
  if (document.getElementById('currentMonthDays')) document.getElementById('currentMonthDays').textContent = thisMonthDays;
  if (document.getElementById('thisWeekDays')) document.getElementById('thisWeekDays').textContent = thisWeekDays;
  if (document.getElementById('streakStartDateDisplay')) document.getElementById('streakStartDateDisplay').textContent = new Date(streakStartDate).toLocaleDateString('en-US', {month: 'short', day: 'numeric', year: 'numeric'});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEADERBOARDS FILTERED â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderLeaderboardsFiltered() {
  const langFilter = document.getElementById('lbLangFilter')?.value || 'all';
  const timeFilter = document.getElementById('lbTimeFilter')?.value || 'all';
  const metricFilter = document.getElementById('lbMetricFilter')?.value || 'xp';
  const scopeFilter = document.getElementById('lbScopeFilter')?.value || 'all';
  const el = document.getElementById('leaderboardsOutput');
  if (!el) return;
  
  // Get data for all users
  const data = users.map(name => {
    let score = 0;
    let langScore = {python: 0, sql: 0, golang: 0};
    
    if (metricFilter === 'xp') {
      score = load('dm_xp_' + name, 0);
      // Calculate per-language XP (estimate based on quizzes + exercises)
      for (const lang of ['python', 'sql', 'golang']) {
        const quiz = load(`dm_quiz_${lang}_${name}`, {});
        langScore[lang] = Object.values(quiz).filter(v => v).length * 10 + load(`dm_concept_done_${name}_${lang}`, 0) * 5;
      }
    } else if (metricFilter === 'quizzes') {
      let total = 0;
      for (const lang of ['python', 'sql', 'golang']) {
        const quiz = load(`dm_quiz_${lang}_${name}`, {});
        langScore[lang] = Object.values(quiz).filter(v => v).length;
        total += langScore[lang];
      }
      score = total;
    } else if (metricFilter === 'projects') {
      score = load('dm_projects_completed_' + name, 0);
      for (const lang of ['python', 'sql', 'golang']) langScore[lang] = 0; // Projects count globally
    } else if (metricFilter === 'badges') {
      const badges = getUserBadges();
      score = badges.length;
      for (const lang of ['python', 'sql', 'golang']) langScore[lang] = badges.filter(b => b.includes(lang)).length;
    }
    
    return {name, score, langScore};
  }).filter(u => scopeFilter === 'all' || u.name === users[currentUserIdx]); // Friends only = current user for now
  
  // Filter by time period (would need date tracking)
  // For now, all metrics show all-time data
  
  // Filter by language
  let filtered = data;
  if (langFilter !== 'all') {
    filtered = filtered.map(u => ({...u, score: u.langScore[langFilter]})).filter(u => u.score > 0);
  }
  
  // Sort
  filtered.sort((a, b) => b.score - a.score);
  
  // Render
  const medals = ['ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰'];
  const metricLabel = {xp: 'XP', quizzes: 'Correct Answers', projects: 'Projects', badges: 'Badges'};
  const langLabel = langFilter === 'all' ? 'All Languages' : langFilter.charAt(0).toUpperCase() + langFilter.slice(1);
  
  el.innerHTML = `
    <div style="font-size:.88rem;color:var(--muted);margin-bottom:1rem">
      Showing: ${metricLabel[metricFilter]} â€¢ ${langLabel} â€¢ ${timeFilter === 'all' ? 'All Time' : (timeFilter === 'month' ? 'This Month' : 'This Week')}
    </div>
    <div>
      ${filtered.length === 0 ? '<p style="color:var(--muted);text-align:center">No data to display</p>' : filtered.map((d, i) => `
        <div class="lb-row rank-${i+1}" style="display:grid;grid-template-columns:auto 1fr auto;gap:1rem;align-items:center;padding:.8rem;border-radius:8px;border:1.5px solid var(--border);margin-bottom:.5rem">
          <div class="lb-rank" style="font-size:1.2rem">${medals[i] || ''}${i < 3 ? '' : (i+1)}</div>
          <div><div style="font-weight:600">${esc(d.name)}</div></div>
          <div style="text-align:right"><div style="font-size:1.3rem;font-weight:800;color:var(--accent)">${d.score}</div><div style="font-size:.75rem;color:var(--muted)">${metricLabel[metricFilter]}</div></div>
        </div>
      `).join('')}
    </div>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LIVE CODE PLAYGROUND â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let pgLanguage = 'python';
function setPGLanguage(lang) {
  pgLanguage = lang;
  document.getElementById('pgPyBtn').style.background = lang === 'python' ? 'var(--accent)' : 'var(--card-hover)';
  document.getElementById('pgSqlBtn').style.background = lang === 'sql' ? 'var(--accent)' : 'var(--card-hover)';
  document.getElementById('pgGoBtn').style.background = lang === 'golang' ? 'var(--accent)' : 'var(--card-hover)';
  loadPGExample();
}

function renderCodePlayground() {
  setPGLanguage(pgLanguage);
}

function clearPGCode() {
  document.getElementById('livePgCode').value = '';
  document.getElementById('livePgOutput').textContent = '';
}

function loadPGExample() {
  const examples = {
    python: 'name = "World"\ngreeting = f"Hello, {name}!"\nprint(greeting)\nfor i in range(5):\n    print(f"Count: {i+1}")',
    sql: 'SELECT name, age FROM students\nWHERE age > 18\nORDER BY age DESC\nLIMIT 10;',
    golang: 'package main\nimport "fmt"\nfunc main() {\n    name := "World"\n    fmt.Printf("Hello, %s!\\n", name)\n    for i := 1; i <= 5; i++ {\n        fmt.Printf("Count: %d\\n", i)\n    }\n}'
  };
  document.getElementById('livePgCode').value = examples[pgLanguage];
  document.getElementById('livePgOutput').textContent = '--- Output will appear here ---';
}

function addPGSnippet(type) {
  const snippets = {
    python: {
      variable: 'x = 42\nname = "Alice"\n',
      loop: 'for i in range(5):\n    print(i)\n',
      if: 'if x > 5:\n    print("Greater")\nelse:\n    print("Less")\n',
      function: 'def greet(name):\n    return f"Hello, {name}!"\n\nprint(greet("Alice"))\n'
    },
    sql: {
      variable: 'DECLARE @name VARCHAR(50) = \'Alice\';',
      loop: 'SELECT * FROM students;',
      if: 'SELECT * FROM students WHERE age > 18;',
      function: 'SELECT COUNT(*) as total FROM students;'
    },
    golang: {
      variable: 'x := 42\nname := "Alice"\n',
      loop: 'for i := 0; i < 5; i++ {\n    fmt.Println(i)\n}\n',
      if: 'if x > 5 {\n    fmt.Println("Greater")\n} else {\n    fmt.Println("Less")\n}\n',
      function: 'func greet(name string) string {\n    return "Hello, " + name + "!"\n}\n'
    }
  };
  const code = snippets[pgLanguage]?.[type] || '';
  document.getElementById('livePgCode').value += code;
}

function runPGCode() {
  const code = document.getElementById('livePgCode').value;
  const output = document.getElementById('livePgOutput');
  if (!code.trim()) {
    output.textContent = 'Write some code first!';
    output.style.color = 'var(--warn)';
    return;
  }

  if (pgLanguage === 'python') {
    const res = executePython(code);
    output.textContent = res.text;
    output.style.color = res.ok ? 'var(--success)' : 'var(--danger)';
  } else if (pgLanguage === 'sql') {
    output.textContent = 'SQL Query Results (Simulated):\n\n' +
                        '| ID | Name     | Score |\n' +
                        '|----|----------|-------|\n' +
                        '| 1  | Alice    | 95    |\n' +
                        '| 2  | Bob      | 87    |\n' +
                        '| 3  | Charlie  | 92    |\n' +
                        '\n3 rows returned';
    output.style.color = 'var(--success)';
  } else if (pgLanguage === 'golang') {
    output.textContent = 'Go Program Output:\n\nHello, World!\nCount: 1\nCount: 2\nCount: 3\nCount: 4\nCount: 5\n\nProgram completed';
    output.style.color = 'var(--success)';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEARNING ANALYTICS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderAnalytics() {
  const u = users[currentUserIdx];
  
  // Calculate overall performance
  let totalCorrect = 0, totalQuestions = 0;
  const langStats = {python: {correct: 0, total: 0}, sql: {correct: 0, total: 0}, golang: {correct: 0, total: 0}};
  
  for (const lang of ['python', 'sql', 'golang']) {
    const qs = QUIZZES[lang];
    const state = load(`dm_quiz_${lang}_${u}`, {});
    langStats[lang].total = qs.length;
    for (let i = 0; i < qs.length; i++) {
      if (state[`q${i}`] === qs[i].ans) {
        langStats[lang].correct++;
        totalCorrect++;
      }
    }
    totalQuestions += qs.length;
  }
  
  const avgScore = totalQuestions > 0 ? Math.round(totalCorrect / totalQuestions * 100) : 0;
  
  // Identify weak concepts (low scores in quizzes)
  const weakConcepts = [];
  const CONCEPT_TOPICS = {
    python: ['Variables', 'If/Else', 'Loops', 'Lists', 'Functions', 'Dictionaries', 'File I/O'],
    sql: ['SELECT', 'WHERE', 'JOIN', 'GROUP BY', 'Aggregates', 'Subqueries', 'UPDATE/DELETE'],
    golang: ['Variables', 'Functions', 'Loops', 'Slices', 'Maps', 'Structs', 'Interfaces']
  };
  
  for (const lang of ['python', 'sql', 'golang']) {
    const score = langStats[lang].total > 0 ? langStats[lang].correct / langStats[lang].total * 100 : 0;
    if (score < 70) weakConcepts.push({lang, score: Math.round(score), topic: 'General ' + lang.toUpperCase()});
  }
  
  // Render UI
  if (document.getElementById('analyticsAvgScore')) {
    document.getElementById('analyticsAvgScore').textContent = avgScore + '%';
  }
  
  if (document.getElementById('analyticsConceptsMastered')) {
    const mastered = Object.values(langStats).filter(s => s.correct === s.total).length + 
                     Object.values(langStats).filter(s => s.total > 0 && s.correct / s.total >= 0.8).length;
    document.getElementById('analyticsConceptsMastered').textContent = mastered + '/' + (langStats.python.total ? 3 : 0);
  }
  
  if (document.getElementById('analyticsWeakAreas')) {
    document.getElementById('analyticsWeakAreas').textContent = weakConcepts.length;
  }
  
  // Mastery chart
  if (document.getElementById('analyticsMasteryChart')) {
    const chart = `
      ${Object.entries(langStats).map(([lang, stats]) => {
        const pct = stats.total > 0 ? Math.round(stats.correct/stats.total*100) : 0;
        const bar = 'â–ˆ'.repeat(Math.floor(pct/5)) + 'â–‘'.repeat(20 - Math.floor(pct/5));
        const emoji = lang === 'python' ? 'ðŸ' : lang === 'sql' ? 'ðŸ—„ï¸' : 'ðŸ”·';
        return `<div style="margin-bottom:.8rem">
          <div style="display:flex;justify-content:space-between;margin-bottom:.3rem">
            <span style="font-weight:600">${emoji} ${lang.charAt(0).toUpperCase() + lang.slice(1)}</span>
            <span style="color:var(--accent)">${pct}%</span>
          </div>
          <div style="background:var(--border);border-radius:4px;height:8px;overflow:hidden">
            <div style="background:linear-gradient(90deg, var(--success), var(--accent));height:100%;width:${pct}%"></div>
          </div>
          <div style="font-size:.75rem;color:var(--muted);margin-top:.2rem">${stats.correct}/${stats.total} correct</div>
        </div>`;
      }).join('')}
    `;
    document.getElementById('analyticsMasteryChart').innerHTML = chart;
  }
  
  // Weak concepts list
  if (document.getElementById('analyticsWeakConcepts')) {
    const weakHtml = weakConcepts.length === 0 ? 
      '<p style="color:var(--muted)">ðŸŽ‰ Great! You\'re doing well in all concepts!</p>' :
      weakConcepts.map(w => `
        <div style="background:var(--card-hover);padding:.8rem;border-radius:8px;margin-bottom:.5rem;border-left:3px solid var(--warn)">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <span style="font-weight:600">${w.lang === 'python' ? 'ðŸ' : w.lang === 'sql' ? 'ðŸ—„ï¸' : 'ðŸ”·'} ${w.topic}</span>
            <span style="background:rgba(255,159,28,.2);color:var(--warn);padding:.2rem .6rem;border-radius:4px;font-size:.75rem;font-weight:600">${w.score}%</span>
          </div>
          <p style="font-size:.82rem;color:var(--muted);margin-top:.4rem">Focus on ${w.lang} fundamentals to improve your score</p>
        </div>
      `).join('');
    document.getElementById('analyticsWeakConcepts').innerHTML = weakHtml;
  }
  
  // Quiz performance
  if (document.getElementById('analyticsQuizPerformance')) {
    const perfHtml = `
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem">
        ${Object.entries(langStats).map(([lang, stats]) => {
          const emoji = lang === 'python' ? 'ðŸ' : lang === 'sql' ? 'ðŸ—„ï¸' : 'ðŸ”·';
          const pct = stats.total > 0 ? Math.round(stats.correct/stats.total*100) : 0;
          const status = pct >= 80 ? 'âœ… Mastered' : pct >= 60 ? 'ðŸŸ¡ Good' : 'âš ï¸ Needs Work';
          return `
            <div style="background:var(--card-hover);padding:1rem;border-radius:8px;text-align:center;border:1.5px solid var(--border)">
              <div style="font-size:1.5rem;margin-bottom:.3rem">${emoji}</div>
              <div style="font-weight:600;margin-bottom:.5rem">${lang.toUpperCase()}</div>
              <div style="font-size:1.8rem;font-weight:800;color:var(--accent);margin-bottom:.3rem">${pct}%</div>
              <div style="font-size:.75rem;color:var(--muted)">${status}<br/>${stats.correct}/${stats.total}</div>
            </div>
          `;
        }).join('')}
      </div>
    `;
    document.getElementById('analyticsQuizPerformance').innerHTML = perfHtml;
  }
  
  // Recommendations
  if (document.getElementById('analyticsRecommendations')) {
    let recs = [];
    for (const [lang, stats] of Object.entries(langStats)) {
      const pct = stats.total > 0 ? stats.correct/stats.total*100 : 0;
      if (pct < 50) recs.push(`ðŸ”´ <strong>${lang.toUpperCase()}</strong>: URGENT - Focus on basics. Review ${CONCEPT_TOPICS[lang][0]} and complete exercises.`);
      else if (pct < 70) recs.push(`ðŸŸ¡ <strong>${lang.toUpperCase()}</strong>: Good start! Review tough topics like ${CONCEPT_TOPICS[lang][Math.floor(Math.random() * CONCEPT_TOPICS[lang].length)]}.`);
      else recs.push(`âœ… <strong>${lang.toUpperCase()}</strong>: Excellent! Try mini projects to reinforce skills.`);
    }
    if (avgScore >= 80) recs.push(`ðŸš€ <strong>Next Steps</strong>: You're ready! Tackle mini projects and interview prep questions.`);
    
    document.getElementById('analyticsRecommendations').innerHTML = recs.map(r => `<div style="margin-bottom:.5rem">${r}</div>`).join('');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AI LEARNING PATH â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderLearningPath() {
  const u = users[currentUserIdx];
  const goal = document.getElementById('lpGoal')?.value || 'basics';
  
  // Calculate user level
  let totalCorrect = 0, totalQuestions = 0;
  for (const lang of ['python','sql','golang']) {
    const qs = QUIZZES[lang];
    const state = load(`dm_quiz_${lang}_${u}`, {});
    for (let i = 0; i < qs.length; i++) {
      if (state[`q${i}`] === qs[i].ans) totalCorrect++;
    }
    totalQuestions += qs.length;
  }
  const masteryPct = totalQuestions > 0 ? totalCorrect / totalQuestions * 100 : 0;
  const userLevel = masteryPct < 40 ? 'Beginner' : masteryPct < 70 ? 'Intermediate' : 'Advanced';
  
  if (document.getElementById('lpYourLevel')) {
    document.getElementById('lpYourLevel').textContent = userLevel;
  }
  
  // Learning paths by goal
  const paths = {
    basics: [
      {lang: 'python', topic: 'Variables & Data Types', duration: '2 days', status: 'start'},
      {lang: 'python', topic: 'If/Else & Loops', duration: '2 days', status: 'suggested'},
      {lang: 'python', topic: 'Lists & Functions', duration: '3 days', status: 'suggested'},
      {lang: 'sql', topic: 'SELECT & WHERE', duration: '2 days', status: 'suggested'},
      {lang: 'golang', topic: 'Variables & Functions', duration: '2 days', status: 'suggested'}
    ],
    intermediate: [
      {lang: 'python', topic: 'Dictionaries & OOP', duration: '3 days', status: 'start'},
      {lang: 'python', topic: 'File I/O & Exceptions', duration: '2 days', status: 'suggested'},
      {lang: 'sql', topic: 'JOINs & Subqueries', duration: '3 days', status: 'suggested'},
      {lang: 'golang', topic: 'Slices & Maps', duration: '2 days', status: 'suggested'},
      {lang: 'golang', topic: 'Structs & Interfaces', duration: '3 days', status: 'suggested'}
    ],
    advanced: [
      {lang: 'python', topic: 'Decorators & Meta', duration: '3 days', status: 'start'},
      {lang: 'sql', topic: 'Window Functions & CTEs', duration: '3 days', status: 'suggested'},
      {lang: 'golang', topic: 'Concurrency & Goroutines', duration: '3 days', status: 'suggested'},
      {lang: 'python', topic: 'Design Patterns', duration: '4 days', status: 'suggested'}
    ],
    interview: [
      {lang: 'all', topic: '20 Easy Interview Questions', duration: '3 days', status: 'start'},
      {lang: 'python', topic: '25 Medium Python Questions', duration: '5 days', status: 'suggested'},
      {lang: 'all', topic: 'System Design & Architecture', duration: '4 days', status: 'suggested'},
      {lang: 'all', topic: '10 Hard Algorithmic Problems', duration: '7 days', status: 'suggested'}
    ],
    project: [
      {lang: 'python', topic: 'Mini Project: To-Do App', duration: '3 days', status: 'start'},
      {lang: 'sql', topic: 'Mini Project: Expense Tracker', duration: '4 days', status: 'suggested'},
      {lang: 'golang', topic: 'Mini Project: CLI Tool', duration: '3 days', status: 'suggested'},
      {lang: 'all', topic: 'Full Stack: All 3 Languages', duration: '7 days', status: 'suggested'}
    ]
  };
  
  const path = paths[goal] || paths.basics;
  
  // Render sequence
  if (document.getElementById('lpSequence')) {
    const seqHtml = path.map((item, i) => {
      const emoji = item.lang === 'python' ? 'ðŸ' : item.lang === 'sql' ? 'ðŸ—„ï¸' : item.lang === 'golang' ? 'ðŸ”·' : 'â­';
      const statusBadge = item.status === 'start' ? '<span style="background:var(--accent);color:white;padding:.2rem .6rem;border-radius:4px;font-size:.7rem;font-weight:600">START HERE</span>' : 
                         '<span style="background:var(--border);color:var(--muted);padding:.2rem .6rem;border-radius:4px;font-size:.7rem;font-weight:600">NEXT</span>';
      return `
        <div style="background:var(--card-hover);padding:1rem;border-radius:8px;border-left:4px solid ${item.status === 'start' ? 'var(--accent)' : 'var(--border)'};margin-bottom:.8rem">
          <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:.5rem">
            <div><div style="font-weight:600;font-size:.95rem;margin-bottom:.2rem">${i+1}. ${emoji} ${item.topic}</div>
            <div style="color:var(--muted);font-size:.8rem">${item.duration}</div></div>
            ${statusBadge}
          </div>
        </div>
      `;
    }).join('');
    document.getElementById('lpSequence').innerHTML = seqHtml;
  }
  
  // Timeline
  if (document.getElementById('lpTimeline')) {
    const totalDays = path.reduce((sum, item) => sum + parseInt(item.duration), 0);
    const timeline = `
      <div style="font-size:.9rem;margin-bottom:.8rem"><strong>Total Duration:</strong> ${totalDays} days (~${Math.ceil(totalDays/7)} weeks)</div>
      <div><strong>Daily Commitment:</strong> 2-3 hours per day</div>
      <div style="margin-top:.5rem;color:var(--muted);font-size:.82rem">Start today to complete in ${Math.ceil(totalDays/5)} business days!</div>
    `;
    document.getElementById('lpTimeline').innerHTML = timeline;
  }
  
  // Progress
  if (document.getElementById('lpProgress')) {
    const completed = path.length > 0 ? 1 : 0;
    const progressHtml = `
      <div style="margin-bottom:.5rem">You've completed: <strong>${completed}</strong> out of <strong>${path.length}</strong> milestones</div>
      <div style="background:var(--border);border-radius:4px;height:8px;overflow:hidden;margin-top:.5rem">
        <div style="background:var(--success);height:100%;width:${Math.round(completed/path.length*100)}%"></div>
      </div>
      <div style="margin-top:.5rem">âœ… Current Milestone: ${path[0]?.topic || 'Get Started!'}</div>
    `;
    document.getElementById('lpProgress').innerHTML = progressHtml;
  }
}

function updateLearningPath() {
  renderLearningPath();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INTERVIEW QUESTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const INTERVIEW_QUESTIONS = [
  // Easy Python
  {id:1, lang:'python', difficulty:'easy', category:'fundamentals', q:'What is the difference between a list and a tuple in Python?', a:'Lists are mutable and use [], tuples are immutable and use (). Tuples are hashable and can be dict keys.'},
  {id:2, lang:'python', difficulty:'easy', category:'fundamentals', q:'How does Python handle memory management?', a:'Python uses reference counting for memory management and a garbage collector to handle circular references.'},
  {id:3, lang:'python', difficulty:'easy', category:'datastructures', q:'What are list comprehensions and give an example', a:'List comprehensions create lists concisely: [x*2 for x in range(5)] produces [0,2,4,6,8]. More readable than loops.'},
  {id:4, lang:'python', difficulty:'easy', category:'fundamentals', q:'What is a decorator in Python?', a:'A decorator is a function that modifies another function/class. Uses @decorator syntax. Example: @property, @staticmethod'},
  {id:5, lang:'python', difficulty:'easy', category:'algorithms', q:'How do you sort a list of dictionaries by a key?', a:'sorted(list, key=lambda x: x[\'key\']) or list.sort(key=lambda x: x[\'key\'])'},
  
  // Medium Python
  {id:6, lang:'python', difficulty:'medium', category:'fundamentals', q:'Explain generators and yield in Python', a:'Generators are functions using yield instead of return. They produce values lazily, memory-efficient. Use: def gen(): yield 1; yield 2'},
  {id:7, lang:'python', difficulty:'medium', category:'algorithms', q:'Write a function to reverse a string without slicing', a:'def reverse(s):\\n  result = ""\\n  for char in s:\\n    result = char + result\\n  return result'},
  {id:8, lang:'python', difficulty:'medium', category:'datastructures', q:'Implement a simple stack using a list', a:'class Stack:\\n  def __init__(self): self.items = []\\n  def push(self, x): self.items.append(x)\\n  def pop(self): return self.items.pop()'},
  {id:9, lang:'python', difficulty:'medium', category:'algorithms', q:'Write code to find the most common element in a list', a:'from collections import Counter; Counter(list).most_common(1)[0][0]'},
  {id:10, lang:'python', difficulty:'medium', category:'fundamentals', q:'What is a lambda function and when use it?', a:'Lambda is anonymous function: lambda x: x*2. Use for short functions, passed as arguments, not for complex logic.'},
  
  // Easy SQL
  {id:11, lang:'sql', difficulty:'easy', category:'fundamentals', q:'What is the difference between INNER JOIN and LEFT JOIN?', a:'INNER JOIN returns matching rows. LEFT JOIN returns all left table rows + matching right rows (NULL if no match).'},
  {id:12, lang:'sql', difficulty:'easy', category:'databases', q:'What is a primary key?', a:'Primary key uniquely identifies each row. Must be NOT NULL and UNIQUE. Each table has exactly one primary key.'},
  {id:13, lang:'sql', difficulty:'easy', category:'fundamentals', q:'What does GROUP BY do?', a:'GROUP BY groups rows by column values and allows aggregate functions. Example: SELECT dept, COUNT(*) FROM employees GROUP BY dept'},
  {id:14, lang:'sql', difficulty:'easy', category:'fundamentals', q:'Difference between COUNT(*) and COUNT(column)', a:'COUNT(*) counts all rows including NULLs. COUNT(column) counts non-NULL values in that column.'},
  {id:15, lang:'sql', difficulty:'easy', category:'databases', q:'What is an index and why use it?', a:'Index orders data for faster searches. Slows inserts/updates but speeds SELECT. Use on frequently searched columns.'},
  
  // Medium SQL
  {id:16, lang:'sql', difficulty:'medium', category:'algorithms', q:'Write a query to find employees earning more than their manager', a:'SELECT e.name FROM employees e JOIN employees m ON e.manager_id = m.id WHERE e.salary > m.salary'},
  {id:17, lang:'sql', difficulty:'medium', category:'databases', q:'Explain ACID properties in databases', a:'Atomicity: all-or-nothing. Consistency: valid state. Isolation: concurrent independence. Durability: committed = permanent.'},
  {id:18, lang:'sql', difficulty:'medium', category:'fundamentals', q:'What is a subquery and give an example', a:'Subquery executes inside another. Example: SELECT * FROM employees WHERE salary > (SELECT AVG(salary) FROM employees)'},
  {id:19, lang:'sql', difficulty:'medium', category:'databases', q:'What is normalization? Why important?', a:'Normalization removes redundancy through 1NF, 2NF, 3NF. Prevents update anomalies, saves space, maintains data integrity.'},
  {id:20, lang:'sql', difficulty:'medium', category:'fundamentals', q:'What is the difference between HAVING and WHERE?', a:'WHERE filters rows BEFORE grouping. HAVING filters groups AFTER grouping. Example: WHERE age>18 vs HAVING COUNT(*)>5'},
];

function renderInterviewQuestions() {
  const langFilter = document.getElementById('iqLangFilter')?.value || 'all';
  const diffFilter = document.getElementById('iqDiffFilter')?.value || 'all';
  const catFilter = document.getElementById('iqCategoryFilter')?.value || 'all';
  
  let filtered = INTERVIEW_QUESTIONS;
  if (langFilter !== 'all') filtered = filtered.filter(q => q.lang === langFilter);
  if (diffFilter !== 'all') filtered = filtered.filter(q => q.difficulty === diffFilter);
  if (catFilter !== 'all') filtered = filtered.filter(q => q.category === catFilter);
  
  const el = document.getElementById('iqQuestions');
  if (!el) return;
  
  const diffColor = {easy: 'var(--success)', medium: 'var(--accent)', hard: 'var(--warn)'};
  const langEmoji = {python: 'ðŸ', sql: 'ðŸ—„ï¸', golang: 'ðŸ”·'};
  
  el.innerHTML = filtered.length === 0 ? '<p style="color:var(--muted)">No questions match your filters</p>' : 
    filtered.map(q => `
      <div style="background:var(--card-hover);padding:1.2rem;border-radius:8px;border-left:4px solid ${diffColor[q.difficulty]}">
        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:.8rem">
          <div style="flex:1">
            <h4 style="margin:0;font-size:.95rem;margin-bottom:.4rem">${langEmoji[q.lang]} Q${q.id}: ${q.q}</h4>
            <div style="display:flex;gap:.5rem">
              <span style="background:${diffColor[q.difficulty]};color:white;padding:.2rem .6rem;border-radius:4px;font-size:.72rem;font-weight:600;text-transform:uppercase">${q.difficulty}</span>
              <span style="background:var(--border);color:var(--muted);padding:.2rem .6rem;border-radius:4px;font-size:.72rem;font-weight:600">${q.category}</span>
            </div>
          </div>
          <button class="btn btn-outline btn-sm" onclick="toggleAnswer(${q.id})">Show Answer</button>
        </div>
        <div id="ans-${q.id}" style="display:none;background:var(--card);padding:1rem;border-radius:6px;margin-top:.8rem;border-left:3px solid var(--accent);color:var(--text);font-size:.85rem;line-height:1.6">${esc(q.a)}</div>
      </div>
    `).join('');
}

function toggleAnswer(id) {
  const el = document.getElementById('ans-' + id);
  if (el) el.style.display = el.style.display === 'none' ? 'block' : 'none';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AI CHATBOT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let chatMode = 'learn';
let chatHistory = [];
let apiKey = load('dm_gemini_key', '');

/* â”€â”€ Comprehensive local AI knowledge base â”€â”€ */
const aiKnowledge = [
  // â”€â”€ Python Learn â”€â”€
  {k:['python','variable','assign'], m:'learn', r:"Variables in Python store data values. No declaration needed!\n\nx = 42           # integer\nname = 'Alice'   # string\npi = 3.14        # float\nis_ok = True     # boolean\n\nPython uses dynamic typing - the type is inferred automatically. You can check type with type(x)."},
  {k:['python','list'], m:'learn', r:"Lists are ordered, mutable collections:\n\nfruits = ['apple', 'banana', 'cherry']\n\n# Add items\nfruits.append('date')      # Add to end\nfruits.insert(1, 'fig')    # Insert at index\n\n# Remove items\nfruits.remove('banana')    # By value\nfruits.pop()               # Remove last\ndel fruits[0]              # By index\n\n# Access & slice\nfruits[0]     # First item\nfruits[-1]    # Last item\nfruits[1:3]   # Slice\n\n# Useful methods\nlen(fruits)    # Length\nfruits.sort()  # Sort\n'apple' in fruits  # Check membership"},
  {k:['python','dictionary','dict'], m:'learn', r:"Dictionaries store key-value pairs:\n\nperson = {'name': 'Alice', 'age': 25, 'city': 'NYC'}\n\n# Access\nperson['name']          # 'Alice'\nperson.get('age', 0)    # 25 (with default)\n\n# Modify\nperson['email'] = 'a@b.com'  # Add/update\ndel person['city']            # Delete key\n\n# Iterate\nfor key, val in person.items():\n    print(f'{key}: {val}')\n\n# Useful methods\nperson.keys()    # All keys\nperson.values()  # All values\n'name' in person  # Check key exists"},
  {k:['python','function','def'], m:'learn', r:"Functions are reusable blocks of code:\n\ndef greet(name, greeting='Hello'):\n    return f'{greeting}, {name}!'\n\nprint(greet('Alice'))           # Hello, Alice!\nprint(greet('Bob', 'Hi'))       # Hi, Bob!\n\n# *args and **kwargs\ndef total(*nums):\n    return sum(nums)\n\ntotal(1, 2, 3)  # 6\n\n# Lambda (anonymous function)\nsquare = lambda x: x ** 2\nsquare(5)  # 25"},
  {k:['python','loop','for loop','while loop','iterate','range'], m:'learn', r:"Loops in Python:\n\n# For loop\nfor i in range(5):\n    print(i)  # 0, 1, 2, 3, 4\n\n# Loop through list\nfruits = ['apple', 'banana']\nfor fruit in fruits:\n    print(fruit)\n\n# With index\nfor i, fruit in enumerate(fruits):\n    print(f'{i}: {fruit}')\n\n# While loop\ncount = 0\nwhile count < 5:\n    print(count)\n    count += 1\n\n# break & continue\nfor i in range(10):\n    if i == 3: continue  # Skip 3\n    if i == 7: break     # Stop at 7"},
  {k:['python','if else','elif','conditional','boolean'], m:'learn', r:"Conditional statements in Python:\n\nage = 18\n\nif age >= 21:\n    print('Adult')\nelif age >= 18:\n    print('Young adult')\nelse:\n    print('Minor')\n\n# Ternary operator\nstatus = 'adult' if age >= 18 else 'minor'\n\n# Multiple conditions\nif age >= 18 and age < 65:\n    print('Working age')"},
  {k:['python','class','oop','object'], m:'learn', r:"Classes in Python (OOP):\n\nclass Dog:\n    def __init__(self, name, breed):\n        self.name = name\n        self.breed = breed\n\n    def bark(self):\n        return f'{self.name} says Woof!'\n\n# Inheritance\nclass Puppy(Dog):\n    def __init__(self, name, breed):\n        super().__init__(name, breed)\n        self.energy = 100\n\ndog = Dog('Rex', 'Labrador')\nprint(dog.bark())  # Rex says Woof!"},
  {k:['python','string','str'], m:'learn', r:"String operations in Python:\n\nname = 'Hello World'\n\nname.upper()        # 'HELLO WORLD'\nname.lower()        # 'hello world'\nname.strip()        # Remove whitespace\nname.replace('o','0')  # 'Hell0 W0rld'\nname.split(' ')     # ['Hello', 'World']\n'-'.join(['a','b'])  # 'a-b'\nlen(name)           # 11\n\n# f-strings (formatted)\nage = 25\nf'I am {age} years old'\nf'{3.14159:.2f}'  # '3.14'"},
  {k:['python','tuple'], m:'learn', r:"Tuples are immutable ordered collections:\n\ncoords = (10, 20)\ncolors = ('red', 'green', 'blue')\n\ncolors[0]    # 'red'\nx, y = coords  # Unpacking\n\nWhy tuples?\n- Immutable (safe as dict keys)\n- Slightly faster than lists\n- Signal that data shouldn't change"},
  {k:['python','set'], m:'learn', r:"Sets are unordered collections of unique elements:\n\nnums = {1, 2, 3, 2, 1}  # {1, 2, 3}\nnums.add(4)\nnums.remove(1)\n\na = {1, 2, 3}\nb = {2, 3, 4}\na | b   # Union: {1, 2, 3, 4}\na & b   # Intersection: {2, 3}\na - b   # Difference: {1}\n\n3 in nums  # Check membership (very fast!)"},
  {k:['python','file','open file','read file','write file','file io'], m:'learn', r:"File I/O in Python:\n\n# Read file\nwith open('data.txt', 'r') as f:\n    content = f.read()\n\n# Write file\nwith open('output.txt', 'w') as f:\n    f.write('Hello World')\n\n# Append\nwith open('log.txt', 'a') as f:\n    f.write('New entry')\n\n# JSON\nimport json\nwith open('data.json') as f:\n    data = json.load(f)\n\nThe 'with' statement auto-closes the file."},
  {k:['python','exception','try except','error handling','raise'], m:'learn', r:"Exception handling in Python:\n\ntry:\n    result = 10 / 0\nexcept ZeroDivisionError:\n    print('Cannot divide by zero!')\nexcept Exception as e:\n    print(f'Error: {e}')\nelse:\n    print('Success!')\nfinally:\n    print('Always runs')\n\n# Raise exceptions\ndef validate(age):\n    if age < 0:\n        raise ValueError('Age cannot be negative')"},
  {k:['python','comprehension','list comp'], m:'learn', r:"List comprehensions:\n\nsquares = [x**2 for x in range(10)]\n# [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]\n\nevens = [x for x in range(20) if x % 2 == 0]\n\n# Dict comprehension\nsq_dict = {x: x**2 for x in range(5)}\n\n# Set comprehension\nunique_len = {len(w) for w in ['hi','hello','hey']}"},
  {k:['python','lambda','map','filter'], m:'learn', r:"Lambda, map, and filter:\n\nsquare = lambda x: x ** 2\n\nnums = [1, 2, 3, 4]\nsquared = list(map(lambda x: x**2, nums))  # [1,4,9,16]\nevens = list(filter(lambda x: x%2==0, nums))  # [2,4]\n\nsorted(['Charlie','Alice','Bob'], key=lambda x: len(x))"},
  {k:['python','import','module'], m:'learn', r:"Modules and imports:\n\nimport math\nmath.sqrt(16)  # 4.0\n\nfrom math import pi, sqrt\n\nimport random\nrandom.randint(1, 10)\nrandom.choice(['a','b','c'])\n\nPopular modules: os, json, re, collections, datetime, itertools"},
  // â”€â”€ SQL Learn â”€â”€
  {k:['sql','select','query','basic'], m:'learn', r:"SQL SELECT:\n\nSELECT name, age FROM students;\n\nSELECT * FROM students\nWHERE age > 18 AND grade = 'A';\n\nSELECT * FROM students\nORDER BY age DESC;\n\nSELECT * FROM students LIMIT 10;\n\nSELECT DISTINCT city FROM students;\n\nSELECT name AS student_name FROM students;"},
  {k:['sql','join'], m:'learn', r:"SQL JOINs combine rows from tables:\n\n-- INNER JOIN (matching only)\nSELECT s.name, c.course\nFROM students s\nINNER JOIN courses c ON s.id = c.student_id;\n\n-- LEFT JOIN (all left + matching right)\nSELECT s.name, c.course\nFROM students s\nLEFT JOIN courses c ON s.id = c.student_id;\n\nINNER = only matches\nLEFT = all from left table\nRIGHT = all from right table\nFULL = all from both"},
  {k:['sql','group','aggregate','count','sum','avg'], m:'learn', r:"SQL GROUP BY and aggregates:\n\nSELECT department,\n       COUNT(*) as count,\n       AVG(salary) as avg_sal,\n       MAX(salary) as max_sal,\n       SUM(salary) as total\nFROM employees\nGROUP BY department\nHAVING COUNT(*) > 5\nORDER BY avg_sal DESC;\n\nWHERE filters BEFORE grouping.\nHAVING filters AFTER grouping."},
  {k:['sql','insert','update','delete'], m:'learn', r:"SQL Data Modification:\n\nINSERT INTO students (name, age)\nVALUES ('Alice', 20);\n\nUPDATE students\nSET grade = 'A+'\nWHERE name = 'Alice';\n\nDELETE FROM students\nWHERE grade = 'F';\n\nAlways use WHERE with UPDATE/DELETE!"},
  {k:['sql','create','table','schema'], m:'learn', r:"SQL CREATE TABLE:\n\nCREATE TABLE students (\n    id INTEGER PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(255) UNIQUE,\n    age INTEGER CHECK(age >= 0),\n    grade CHAR(2) DEFAULT 'NA'\n);\n\nCommon types: INTEGER, VARCHAR(n), TEXT, DATE, BOOLEAN, FLOAT"},
  {k:['sql','subquer','nested'], m:'learn', r:"SQL Subqueries:\n\nSELECT name FROM students\nWHERE age > (SELECT AVG(age) FROM students);\n\nSELECT name FROM students\nWHERE id IN (\n    SELECT student_id FROM enrollments\n    WHERE course = 'Python'\n);\n\nSELECT name FROM students s\nWHERE EXISTS (\n    SELECT 1 FROM grades g\n    WHERE g.student_id = s.id\n);"},
  {k:['sql','where clause','filter','sql condition','between','like'], m:'learn', r:"SQL WHERE filtering:\n\nSELECT * FROM products WHERE price > 100;\nSELECT * FROM products WHERE price BETWEEN 50 AND 100;\nSELECT * FROM products WHERE price IN (10, 20, 30);\n\nSELECT * FROM users WHERE name LIKE 'A%';  -- Starts with A\nSELECT * FROM users WHERE name LIKE '%son'; -- Ends with son\n\nSELECT * FROM users WHERE email IS NULL;\nSELECT * FROM users WHERE email IS NOT NULL;"},
  // â”€â”€ Go Learn â”€â”€
  {k:['go','golang','variable','declare'], m:'learn', r:"Variables in Go:\n\nname := \"Alice\"   // Short declaration\nage := 25\n\nvar count int = 10  // Explicit type\n\nconst Pi = 3.14159\n\nZero values: int=0, string=\"\", bool=false"},
  {k:['go','golang','function','func'], m:'learn', r:"Functions in Go:\n\nfunc add(a, b int) int {\n    return a + b\n}\n\n// Multiple returns\nfunc divide(a, b float64) (float64, error) {\n    if b == 0 {\n        return 0, fmt.Errorf(\"division by zero\")\n    }\n    return a / b, nil\n}\n\nresult, err := divide(10, 3)\nif err != nil {\n    log.Fatal(err)\n}"},
  {k:['go','golang','struct'], m:'learn', r:"Structs in Go:\n\ntype Person struct {\n    Name string\n    Age  int\n}\n\np := Person{Name: \"Alice\", Age: 25}\n\nfunc (p Person) Greet() string {\n    return fmt.Sprintf(\"Hi, I'm %s!\", p.Name)\n}\n\n// Pointer receiver (can modify)\nfunc (p *Person) Birthday() {\n    p.Age++\n}"},
  {k:['go','golang','goroutine','concurren','channel'], m:'learn', r:"Goroutines & Channels:\n\ngo func() {\n    fmt.Println(\"Running concurrently!\")\n}()\n\nch := make(chan string)\ngo func() {\n    ch <- \"hello\"  // Send\n}()\nmsg := <-ch  // Receive\n\nselect {\ncase msg := <-ch1:\n    fmt.Println(msg)\ncase <-time.After(time.Second):\n    fmt.Println(\"timeout\")\n}"},
  {k:['go','golang','slice','array'], m:'learn', r:"Slices in Go:\n\nnums := []int{1, 2, 3, 4, 5}\nnums = append(nums, 6)\nsub := nums[1:4]  // [2, 3, 4]\n\nfor i, v := range nums {\n    fmt.Printf(\"%d: %d\\n\", i, v)\n}\n\nlen(nums)  // Length\ncap(nums)  // Capacity"},
  {k:['go','golang','interface'], m:'learn', r:"Interfaces in Go:\n\ntype Shape interface {\n    Area() float64\n}\n\ntype Circle struct { Radius float64 }\n\nfunc (c Circle) Area() float64 {\n    return math.Pi * c.Radius * c.Radius\n}\n\nfunc printArea(s Shape) {\n    fmt.Printf(\"Area: %.2f\\n\", s.Area())\n}\n\n// Circle implements Shape implicitly!"},
  {k:['go','golang','error','handle'], m:'learn', r:"Error handling in Go:\n\nresult, err := strconv.Atoi(\"123\")\nif err != nil {\n    log.Fatal(err)\n}\n\n// Custom errors\nvar ErrNotFound = errors.New(\"not found\")\n\nfunc find(id int) (*User, error) {\n    if id <= 0 {\n        return nil, ErrNotFound\n    }\n    return &User{}, nil\n}"},
  {k:['go','golang','map'], m:'learn', r:"Maps in Go:\n\nages := map[string]int{\n    \"Alice\": 25,\n    \"Bob\":   30,\n}\n\nages[\"Charlie\"] = 28     // Add\nage := ages[\"Alice\"]      // Get\nval, ok := ages[\"Dave\"]   // Check exists\ndelete(ages, \"Bob\")       // Delete\n\nfor name, age := range ages {\n    fmt.Printf(\"%s: %d\\n\", name, age)\n}"},
  // â”€â”€ General Learn â”€â”€
  {k:['oop','object oriented','encapsulation','inheritance','polymorphism'], m:'learn', r:"OOP has 4 pillars:\n\n1. Encapsulation - Bundle data + methods, hide internals\n2. Inheritance - Create new classes from existing ones\n3. Polymorphism - Same interface, different behavior\n4. Abstraction - Hide complexity, show essentials\n\nPython: Full OOP with classes\nGo: Uses structs + interfaces (no inheritance)\nSQL: Not OOP (declarative/set-based)"},
  {k:['api','rest','http'], m:'learn', r:"REST API Basics:\n\nGET    - Retrieve data\nPOST   - Create resource\nPUT    - Update resource\nDELETE - Remove resource\n\nStatus: 200 OK, 201 Created, 400 Bad Request,\n401 Unauthorized, 404 Not Found, 500 Server Error\n\nExample: GET /api/users/123 -> Get user 123\nData format: JSON"},
  {k:['git','version','branch'], m:'learn', r:"Git essentials:\n\ngit init               # Initialize\ngit add .              # Stage changes\ngit commit -m 'msg'    # Commit\ngit push origin main   # Push\n\ngit branch feature     # Create branch\ngit checkout -b fix    # Create + switch\ngit merge feature      # Merge\n\ngit pull    # Get latest\ngit status  # Check status\ngit log     # View history\ngit diff    # See changes"},
  {k:['algorithm','sorting','search','big o'], m:'learn', r:"Algorithms & Big O:\n\nO(1)       - Constant (hash lookup)\nO(log n)   - Logarithmic (binary search)\nO(n)       - Linear (simple loop)\nO(n log n) - Merge sort, quick sort\nO(n^2)     - Nested loops, bubble sort\nO(2^n)     - Recursive fibonacci\n\nBubble Sort O(n^2) - Simple but slow\nMerge Sort O(n log n) - Divide & conquer\nBinary Search O(log n) - Sorted array only"},
  {k:['data structure','stack','queue','tree','heap'], m:'learn', r:"Data Structures:\n\nArray - O(1) access, O(n) insert\nLinked List - O(n) access, O(1) insert\nStack (LIFO) - push/pop O(1)\nQueue (FIFO) - enqueue/dequeue O(1)\nHash Map - O(1) average lookup\nTree - O(log n) search (balanced)\nHeap - O(1) min/max, O(log n) insert"},
  {k:['python','go','difference','compare','vs'], m:'learn', r:"Python vs Go:\n\n         Python           Go\nTyping:  Dynamic          Static\nSpeed:   Slower           Very fast\nSyntax:  Concise          Verbose but clear\nOOP:     Full classes     Structs + interfaces\nConcur:  asyncio          Goroutines (built-in)\nUse:     ML, scripts      Servers, CLI tools\n\nBoth are excellent - Python for rapid dev, Go for performance!"},
  {k:['decorator','python'], m:'learn', r:"Decorators in Python:\n\ndef timer(func):\n    def wrapper(*args):\n        import time\n        start = time.time()\n        result = func(*args)\n        print(f'Took {time.time()-start:.2f}s')\n        return result\n    return wrapper\n\n@timer\ndef slow_function():\n    import time\n    time.sleep(1)\n\nslow_function()  # Prints: Took 1.00s"},
  {k:['generator','yield','python'], m:'learn', r:"Generators in Python:\n\ndef countdown(n):\n    while n > 0:\n        yield n\n        n -= 1\n\nfor num in countdown(5):\n    print(num)  # 5, 4, 3, 2, 1\n\n# Generator expression\nsquares = (x**2 for x in range(10))\n\nGenerators are memory-efficient - they produce values one at a time instead of storing all in memory."},
  // â”€â”€ Debug mode â”€â”€
  {k:['undefined','not a function','typeerror'], m:'debug', r:"TypeError: undefined is not a function\n\nCommon causes:\n1. Typo in function name\n2. Function not imported/defined yet\n3. Calling method on wrong type\n4. Variable shadowing a function\n\nFixes:\n- Check spelling carefully\n- Ensure function is defined before calling\n- Use typeof to check: typeof myVar"},
  {k:['cannot read','property','null','nonetype','attributeerror'], m:'debug', r:"Cannot read property / AttributeError: NoneType\n\nYou're accessing a property on null/None.\n\nPython fix:\n  if result is not None:\n      result.upper()\n\nJS fix:\n  obj?.prop  // Optional chaining\n\nCommon causes:\n- Function returned None unexpectedly\n- Variable not initialized\n- Wrong variable name"},
  {k:['syntax','syntaxerror','invalid syntax'], m:'debug', r:"SyntaxError: invalid syntax\n\nCommon causes:\n1. Missing colon: if x > 5:  (not if x > 5)\n2. Mismatched brackets: print('hello')\n3. Wrong indentation (use 4 spaces)\n4. Using = instead of ==: if x == 5:\n5. Missing quotes: name = 'Alice'\n\nTip: Check the line BEFORE the error too!"},
  {k:['indexerror','index out','out of range','list index'], m:'debug', r:"IndexError: list index out of range\n\nmy_list = [10, 20, 30]  # indices 0, 1, 2\nmy_list[3]  # IndexError!\n\nFixes:\n1. Check length: if i < len(my_list)\n2. Use negative index: my_list[-1]  # Last\n3. try/except IndexError\n4. Off-by-one: range(len(lst)) is 0 to len-1"},
  {k:['infinite','loop','hang','freeze'], m:'debug', r:"Infinite Loop:\n\nCommon causes:\n1. Forgot to update loop variable\n   while i < 10: print(i)  # Missing i += 1\n2. Wrong condition: while i != 10 with i += 3\n3. Break condition never met\n\nFixes:\n- Always update loop variable\n- Use < instead of !=\n- Add max iteration guard\n- Ctrl+C to stop the program"},
  {k:['import','module','no module','modulenotfound'], m:'debug', r:"ModuleNotFoundError:\n\nFixes:\n1. Install: pip install package_name\n2. Check spelling: import numpy (not numpie)\n3. Check virtual environment is activated\n4. Try: python -m pip install package_name\n5. For own modules: check file is in same directory"},
  {k:['keyerror','key error','key not found'], m:'debug', r:"KeyError: key not found\n\ndata = {'name': 'Alice'}\ndata['age']  # KeyError!\n\nFixes:\n1. data.get('age', 0)  # Default value\n2. if 'age' in data: ...\n3. try/except KeyError\n4. from collections import defaultdict"},
  {k:['typeerror','type error','convert','cast','unsupported type'], m:'debug', r:"TypeError: can't convert / unsupported types\n\nCommon:\n  'Age: ' + 25  # Error!\n  'Age: ' + str(25)  # Fix\n\n  '5' + 3  # Error!\n  int('5') + 3  # Fix\n\nTip: Use type(var) to check types"},
  {k:['nameerror','name error','not defined','undefined variable'], m:'debug', r:"NameError: name 'x' is not defined\n\nCommon causes:\n1. Variable used before assignment\n2. Typo in variable name\n3. Variable defined in different scope\n4. Missing import\n\nFixes:\n- Check spelling\n- Define variable before using it\n- Check if variable is in correct scope\n- Import needed modules"},
  {k:['valueerror','value error','invalid literal','invalid value'], m:'debug', r:"ValueError: invalid literal / wrong value\n\nCommon:\n  int('hello')  # ValueError!\n  int('3.14')   # ValueError! Use float()\n\nFixes:\n1. Validate input before converting\n2. Use try/except ValueError\n3. Check data format matches expected type\n4. Strip whitespace: int(s.strip())"},
  // â”€â”€ Interview mode â”€â”€
  {k:['list vs tuple','list tuple','tuple difference'], m:'interview', r:"List vs Tuple:\n\nList: Mutable [1,2,3], has append/remove/sort\nTuple: Immutable (1,2,3), can be dict keys\n\nUse List when data changes.\nUse Tuple for fixed data (coords, returns).\nTuples are faster and hashable."},
  {k:['array','linked list','vs'], m:'interview', r:"Array vs Linked List:\n\nArray:\n  Access: O(1), Insert: O(n), Cache-friendly\nLinked List:\n  Access: O(n), Insert: O(1), Extra memory\n\nUse Array for frequent access.\nUse Linked List for frequent insert/delete."},
  {k:['time complexity','big o','notation','complexity'], m:'interview', r:"Big O Notation:\n\nO(1) - hash lookup, array access\nO(log n) - binary search\nO(n) - linear search, single loop\nO(n log n) - merge sort, quick sort\nO(n^2) - nested loops\n\nAlways state time AND space complexity.\nMention best/average/worst case."},
  {k:['approach','problem','solve','coding interview'], m:'interview', r:"Problem-Solving Framework:\n\n1. UNDERSTAND - Repeat problem, ask questions\n2. PLAN - Think of approaches, discuss trade-offs\n3. CODE - Write clean, readable code\n4. TEST - Check examples and edge cases\n5. OPTIMIZE - Discuss complexity, improvements\n\nAlways think aloud and communicate!"},
  {k:['tell me about','yourself','introduce'], m:'interview', r:"'Tell me about yourself':\n\n1. Present: Current role/studies\n2. Past: Key projects and achievements\n3. Future: Goals and why this role\n\nKeep it under 2 minutes.\nInclude specific technical skills.\nEnd with why THIS role excites you."},
  {k:['why hire','strength','hire you'], m:'interview', r:"'Why should we hire you?':\n\n1. Match skills to job requirements\n2. Give concrete examples\n3. Show learning ability\n4. Highlight team contribution\n5. Show unique value\n\nAvoid generic answers. Use specific examples!"},
  {k:['design','system','scalab'], m:'interview', r:"System Design Framework:\n\n1. Requirements - What does it do? Scale?\n2. High-Level - Load balancer, app servers, DB\n3. Deep Dive - Schema, APIs, caching\n4. Scale - Sharding, replication, CDN\n\nDiscuss trade-offs: SQL vs NoSQL, consistency vs availability."},
  {k:['sql','python','interview','question'], m:'interview', r:"Common Interview Questions:\n\nSQL: WHERE vs HAVING? JOINs? Indexes? 2nd highest salary? Normalization?\n\nPython: Decorators? Generators? GIL? Deep vs shallow copy? Memory management?\n\nFor each: Define it, give example, explain when/why to use it."},
  {k:['reverse','string','palindrome'], m:'interview', r:"Common coding problems:\n\n# Reverse a string\ndef reverse(s): return s[::-1]\n\n# Check palindrome\ndef is_palindrome(s):\n    s = s.lower().replace(' ','')\n    return s == s[::-1]\n\n# FizzBuzz\nfor i in range(1, 101):\n    if i%15==0: print('FizzBuzz')\n    elif i%3==0: print('Fizz')\n    elif i%5==0: print('Buzz')\n    else: print(i)"},
  {k:['two sum','leetcode','hash'], m:'interview', r:"Two Sum (classic interview problem):\n\ndef two_sum(nums, target):\n    seen = {}  # value -> index\n    for i, num in enumerate(nums):\n        complement = target - num\n        if complement in seen:\n            return [seen[complement], i]\n        seen[num] = i\n    return []\n\nTime: O(n), Space: O(n)\nKey insight: Use a hash map for O(1) lookups."},
  // â”€â”€ General overview entries (match single language keywords) â”€â”€
  {k:['python'], m:'learn', r:"Python is a versatile, beginner-friendly programming language used for web development, data science, AI, automation, and more.\n\nI can explain these Python topics - just ask:\n- Variables, Strings, Numbers\n- Lists, Dictionaries, Tuples, Sets\n- Functions, Lambda, Decorators\n- Loops (for, while), Conditionals\n- Classes & OOP\n- File I/O, Exception Handling\n- List Comprehensions\n- Modules & Imports\n- Generators\n\nExample: Try asking 'python list' or 'python function'"},
  {k:['sql'], m:'learn', r:"SQL (Structured Query Language) is used to manage and query relational databases.\n\nI can explain these SQL topics - just ask:\n- SELECT queries & filtering (WHERE)\n- JOINs (INNER, LEFT, RIGHT, FULL)\n- GROUP BY & aggregate functions\n- INSERT, UPDATE, DELETE\n- CREATE TABLE & schema design\n- Subqueries\n- Indexes & optimization\n\nExample: Try asking 'sql join' or 'sql group by'"},
  {k:['golang'], m:'learn', r:"Go (Golang) is a fast, statically-typed language created by Google. It excels at concurrency, networking, and cloud services.\n\nI can explain these Go topics - just ask:\n- Variables & Constants\n- Functions & Methods\n- Structs (like classes)\n- Interfaces\n- Goroutines & Channels\n- Slices & Arrays\n- Maps\n- Error Handling\n\nExample: Try asking 'golang struct' or 'golang goroutine'"},
  {k:['programming','coding','learn','start','begin','basics'], m:'learn', r:"Welcome to programming! Here's how to get started:\n\n1. Pick a language:\n   - Python: Best for beginners, data science, AI\n   - SQL: Essential for working with databases\n   - Go: Great for servers and performance\n\n2. Learn fundamentals:\n   - Variables & data types\n   - Conditionals (if/else)\n   - Loops (for/while)\n   - Functions\n   - Data structures (lists, dicts)\n\n3. Practice daily:\n   - Use the Code Playground here!\n   - Try the challenges and mini projects\n   - Build small projects\n\nAsk me about any topic to get started!"},
  {k:['help','can you','what can'], m:'learn', r:"I can help you with:\n\n- Python: lists, dicts, functions, classes, loops, strings, file I/O, exceptions, decorators, generators\n- SQL: SELECT, JOIN, GROUP BY, INSERT/UPDATE/DELETE, CREATE TABLE, subqueries, indexes\n- Go: functions, structs, interfaces, goroutines, channels, slices, maps, error handling\n- General: OOP, REST APIs, Git, algorithms, data structures\n- Debug: SyntaxError, TypeError, IndexError, NameError, KeyError, ValueError\n- Interview: coding problems, system design, behavioral questions, Big O\n\nJust ask a question like 'explain python lists' or 'what is a sql join'!"}
];

function smartResponse(msg, mode) {
  var q = msg.toLowerCase().trim();
  var words = q.replace(/[^a-z0-9\s]/g,' ').split(/\s+/).filter(function(w){return w.length>0;});

  if (/^(hi|hello|hey|howdy|good\s|greetings)/.test(q))
    return "Hello! I'm your DevMaster Hub AI assistant. I can help with:\n\n- Python (lists, functions, classes, etc.)\n- SQL (queries, joins, optimization)\n- Go (goroutines, structs, interfaces)\n- Debugging errors\n- Interview preparation\n\nWhat would you like to learn?";
  if (/^(thanks|thank you|thx|ty)/.test(q))
    return "You're welcome! Happy coding! Feel free to ask anything else.";
  if (/^(bye|goodbye|see you)/.test(q))
    return "Goodbye! Keep learning and building. You're doing great!";

  var bestEntry = null, bestScore = 0;
  for (var i = 0; i < aiKnowledge.length; i++) {
    var entry = aiKnowledge[i];
    var matched = 0;
    for (var j = 0; j < entry.k.length; j++) {
      var kw = entry.k[j];
      if (kw.indexOf(' ') >= 0) {
        if (q.indexOf(kw) >= 0) matched++;
      } else {
        for (var w = 0; w < words.length; w++) {
          if (words[w] === kw || (kw.length > 3 && words[w].indexOf(kw) === 0)) { matched++; break; }
        }
      }
    }
    if (matched === 0) continue;
    var score = matched + (matched / entry.k.length) * 2;
    if (matched >= 2) score += matched;
    if (entry.m === mode) score += 0.5;
    if (score > bestScore) { bestScore = score; bestEntry = entry; }
  }

  if (bestEntry && bestScore >= 1) return bestEntry.r;

  if (mode === 'debug') return "I can help debug! Tell me:\n1. The error message\n2. The code causing it\n3. What you expected\n\nCommon errors: SyntaxError, TypeError, IndexError, NameError, KeyError, ValueError";
  if (mode === 'interview') return "I can help with interview prep!\n\nTry asking about:\n- How to approach coding problems\n- Tell me about yourself\n- Array vs Linked List\n- Time complexity / Big O\n- System design\n- Two Sum / common problems";
  return "I can help with many topics! Try asking about:\n\n- Python: lists, dicts, functions, classes, loops, strings\n- SQL: SELECT, JOIN, GROUP BY, subqueries\n- Go: goroutines, structs, interfaces, slices\n- General: OOP, REST APIs, Git, algorithms\n\nAsk something specific and I'll explain with examples!";
}

function renderChatbot() {
  chatHistory = load('dm_chatbot_history_' + users[currentUserIdx], []);
  setChatMode('learn');
  renderChatMessages();
}

function setChatMode(mode) {
  chatMode = mode;
  document.getElementById('cbModeLearn').style.background = mode === 'learn' ? 'var(--accent)' : 'var(--card-hover)';
  document.getElementById('cbModeLearn').style.color = mode === 'learn' ? 'white' : 'var(--text)';
  document.getElementById('cbModeDebug').style.background = mode === 'debug' ? 'var(--accent)' : 'var(--card-hover)';
  document.getElementById('cbModeDebug').style.color = mode === 'debug' ? 'white' : 'var(--text)';
  document.getElementById('cbModeInterview').style.background = mode === 'interview' ? 'var(--accent)' : 'var(--card-hover)';
  document.getElementById('cbModeInterview').style.color = mode === 'interview' ? 'white' : 'var(--text)';
  renderChatMessages();
}

async function sendChatMessage() {
  var input = document.getElementById('chatInput');
  var msg = input.value.trim();
  if (!msg) return;

  chatHistory.push({sender: 'user', text: msg, mode: chatMode});
  input.value = '';
  renderChatMessages();

  chatHistory.push({sender: 'bot', text: 'Thinking...', mode: chatMode, loading: true});
  renderChatMessages();

  var response;
  if (apiKey) {
    try {
      response = await callGeminiAPI('[Mode: ' + chatMode + '] ' + msg);
    } catch (err) {
      response = smartResponse(msg, chatMode);
    }
  } else {
    await new Promise(function(r){ setTimeout(r, 300 + Math.random() * 500); });
    response = smartResponse(msg, chatMode);
  }

  chatHistory.pop();
  chatHistory.push({sender: 'bot', text: response, mode: chatMode});
  save('dm_chatbot_history_' + users[currentUserIdx], chatHistory);
  renderChatMessages();
}

function quickQuestion(question) {
  document.getElementById('chatInput').value = question;
  sendChatMessage();
}

function renderChatMessages() {
  var el = document.getElementById('chatMessages');
  if (!el) return;

  var filtered = chatHistory.filter(function(m){ return m.mode === chatMode || !m.mode; });
  el.innerHTML = filtered.length === 0 ?
    '<div style="color:var(--muted);text-align:center;padding:2rem;display:flex;flex-direction:column;align-items:center;gap:.5rem"><span style="font-size:2rem">ðŸ¤–</span><span style="font-weight:600">AI Learning Assistant</span><span style="font-size:.82rem">Ask me anything about Python, SQL, or Go!</span></div>' :
    filtered.map(function(m){
      var content = m.sender === 'bot' ? formatBotMessage(m.text) : esc(m.text);
      return '<div style="margin-bottom:1rem;display:flex;' + (m.sender === 'user' ? 'justify-content:flex-end' : 'justify-content:flex-start') + '">' +
        '<div style="max-width:80%;background:' + (m.sender === 'user' ? 'var(--accent)' : 'var(--border)') + ';color:' + (m.sender === 'user' ? 'white' : 'var(--text)') + ';padding:.8rem 1rem;border-radius:12px;font-size:.85rem;line-height:1.6;white-space:pre-wrap">' +
          content +
        '</div></div>';
    }).join('');

  el.scrollTop = el.scrollHeight;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FLOATING CHATBOT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let floatingChatHistory = [];

function initFloatingChatbot() {
  floatingChatHistory = load('dm_floating_chat_history', []);
  renderFloatingChatMessages();
}

function toggleChatbot() {
  const modal = document.getElementById('chatbotModal');
  const btn = document.getElementById('chatbotButton');
  const isOpen = modal.classList.contains('open');

  if (isOpen) {
    modal.classList.remove('open');
    btn.classList.remove('open');
  } else {
    modal.classList.add('open');
    btn.classList.add('open');
    // Remove ring notification after first open
    const ring = btn.querySelector('.ring');
    if (ring) ring.remove();
    document.getElementById('chatbotInput').focus();
    renderFloatingChatMessages();
  }
}

async function sendFloatingChatMessage() {
  var input = document.getElementById('chatbotInput');
  var userMessage = input.value.trim();
  if (!userMessage) return;

  floatingChatHistory.push({sender: 'user', text: userMessage});
  input.value = '';
  renderFloatingChatMessages();

  floatingChatHistory.push({sender: 'bot', text: 'Thinking...', loading: true});
  renderFloatingChatMessages();

  var response;
  if (apiKey) {
    try {
      response = await callGeminiAPI(userMessage);
    } catch (err) {
      response = smartResponse(userMessage, 'learn');
    }
  } else {
    await new Promise(function(r){ setTimeout(r, 300 + Math.random() * 500); });
    response = smartResponse(userMessage, 'learn');
  }

  floatingChatHistory.pop();
  floatingChatHistory.push({sender: 'bot', text: response});
  save('dm_floating_chat_history', floatingChatHistory);
  renderFloatingChatMessages();
  addXP(5, 'Asked AI assistant a question');
}

async function callGeminiAPI(userMessage) {
  if (!apiKey) throw new Error('No API key');
  var url = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=' + apiKey;
  var res = await fetch(url, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      contents: [{parts: [{text: 'You are a helpful programming tutor for Python, SQL, and Go. Keep answers concise with code examples. ' + userMessage}]}],
      generationConfig: {maxOutputTokens: 800, temperature: 0.7}
    })
  });
  if (!res.ok) {
    var errData = await res.json().catch(function(){ return {}; });
    throw new Error((errData.error && errData.error.message) || 'API Error ' + res.status);
  }
  var data = await res.json();
  var text = data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0] && data.candidates[0].content.parts[0].text;
  if (!text) throw new Error('Empty response');
  return text;
}

function formatBotMessage(text) {
  var escaped = esc(text);
  // Format code blocks (lines starting with spaces or common code patterns)
  escaped = escaped.replace(/\n([ ]{2,}[^\n]+)/g, function(m, line) {
    return '\n<span style="background:rgba(13,148,136,.08);padding:1px 4px;border-radius:3px;font-family:Consolas,monospace;font-size:.82rem">' + line + '</span>';
  });
  escaped = escaped.replace(/\n/g, '<br>');
  return escaped;
}

function renderFloatingChatMessages() {
  var container = document.getElementById('chatbotMessages');
  if (!container) return;

  container.innerHTML = floatingChatHistory.length === 0 ?
    '<div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--muted);text-align:center;padding:1.5rem">' +
    '<div style="font-size:2.5rem;margin-bottom:.8rem">ðŸ¤–</div>' +
    '<div style="font-weight:600;font-size:.95rem;color:var(--text);margin-bottom:.4rem">Hi! I\'m your Code Assistant</div>' +
    '<div style="font-size:.82rem;line-height:1.5">Ask me about Python, SQL, or Go!<br>Try the quick buttons below or type your question.</div></div>' :
    floatingChatHistory.map(function(msg){
      var content = msg.sender === 'bot' ? formatBotMessage(msg.text) : esc(msg.text);
      return '<div class="chatbot-message ' + msg.sender + (msg.loading ? ' loading' : '') + '">' + content + '</div>';
    }).join('');

  container.scrollTop = container.scrollHeight;
}

function quickFloatingChat(text) {
  document.getElementById('chatbotInput').value = text;
  sendFloatingChatMessage();
}

function saveApiKey() {
  var key = document.getElementById('geminiKeyInput').value.trim();
  if (key) {
    apiKey = key;
    save('dm_gemini_key', key);
    showToast('âœ…', 'API key saved! AI responses will now use Gemini.');
  }
  closeModal('apiKeyModal');
}

function clearApiKey() {
  apiKey = '';
  save('dm_gemini_key', '');
  document.getElementById('geminiKeyInput').value = '';
  showToast('ðŸ—‘ï¸', 'API key cleared. Using built-in assistant.');
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXPORT PROGRESS REPORT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let reportHtml = '';
function generateReport() {
  const u = users[currentUserIdx];
  const xp = getUserXP();
  const lvl = getLevel(xp);
  const streak = getStreak();
  const badges = getUserBadges();
  const conceptPct = getConceptCompletionPct();
  let quizScores = {};
  let totalQuiz = 0;
  for (const mod of ['python','sql','golang']) {
    const state = load(`dm_quiz_${mod}_${u}`, {});
    let score = 0;
    for (let i=0;i<QUIZZES[mod].length;i++) { if(state[`q${i}`]===QUIZZES[mod][i].ans) score++; }
    quizScores[mod] = score;
    totalQuiz += score;
  }
  const completedDays = (load('dm_schedule_done_'+u,[]) || []).length;
  const today = new Date().toISOString().slice(0,10);
  const studyTimes = load('dm_study_'+u+'_'+today, {python:0,sql:0,golang:0});
  const fmt = s => { const m=Math.floor(s/60); return m>0?m+' min':'< 1 min'; };

  reportHtml = `<!DOCTYPE html><html><head><title>Progress Report - ${esc(u)}</title>
  <style>body{font-family:system-ui;max-width:700px;margin:2rem auto;padding:1rem;color:#0f172a}
  h1{color:#0d9488}h2{color:#d97706;border-bottom:2px solid #e0e0e0;padding-bottom:.3rem;margin-top:1.5rem}
  .stat{display:inline-block;text-align:center;padding:1rem;margin:.3rem;border:1px solid #e0e0e0;border-radius:10px;min-width:120px}
  .stat .num{font-size:1.8rem;font-weight:800;color:#0d9488}.stat .lbl{font-size:.8rem;color:#666}
  table{width:100%;border-collapse:collapse;margin:.5rem 0}th,td{padding:.5rem;border:1px solid #e0e0e0;text-align:left}
  th{background:#f5f7fa;font-size:.85rem}.badge{display:inline-block;padding:.2rem .6rem;border-radius:12px;font-size:.8rem;margin:.2rem;background:#fef3c7;color:#d97706}
  </style></head><body>
  <h1>ðŸ“Š Learning Progress Report</h1>
  <p><strong>Student:</strong> ${esc(u)} | <strong>Date:</strong> ${new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'})} | <strong>Level:</strong> ${lvl}</p>

  <h2>Overview</h2>
  <div class="stat"><div class="num">${xp}</div><div class="lbl">Total XP</div></div>
  <div class="stat"><div class="num">${streak}</div><div class="lbl">Day Streak</div></div>
  <div class="stat"><div class="num">${totalQuiz}/45</div><div class="lbl">Quiz Score</div></div>
  <div class="stat"><div class="num">${badges.length}/${BADGES.length}</div><div class="lbl">Badges</div></div>
  <div class="stat"><div class="num">${conceptPct}%</div><div class="lbl">Concepts</div></div>
  <div class="stat"><div class="num">${completedDays}</div><div class="lbl">Days Done</div></div>

  <h2>Quiz Scores by Language</h2>
  <table><tr><th>Language</th><th>Score</th><th>Percentage</th></tr>
  <tr><td>Python</td><td>${quizScores.python}/15</td><td>${Math.round(quizScores.python/15*100)}%</td></tr>
  <tr><td>SQL</td><td>${quizScores.sql}/15</td><td>${Math.round(quizScores.sql/15*100)}%</td></tr>
  <tr><td>Golang</td><td>${quizScores.golang}/15</td><td>${Math.round(quizScores.golang/15*100)}%</td></tr>
  </table>

  <h2>Concept Completion</h2>
  <table><tr><th>Language</th><th>Completed</th><th>Total</th><th>Progress</th></tr>
  ${['python','sql','golang'].map(mod => {
    const done = getConceptDone(mod).length;
    const total = CONCEPTS[mod].length;
    return `<tr><td>${mod.charAt(0).toUpperCase()+mod.slice(1)}</td><td>${done}</td><td>${total}</td><td>${Math.round(done/total*100)}%</td></tr>`;
  }).join('')}
  </table>

  <h2>Badges Earned (${badges.length}/${BADGES.length})</h2>
  <div>${badges.length > 0 ? badges.map(id => { const b=BADGES.find(x=>x.id===id); return b?`<span class="badge">${b.icon} ${b.name}</span>`:''; }).join('') : '<p>No badges yet.</p>'}</div>

  <h2>Study Time Today</h2>
  <table><tr><th>Language</th><th>Time</th></tr>
  <tr><td>Python</td><td>${fmt(studyTimes.python)}</td></tr>
  <tr><td>SQL</td><td>${fmt(studyTimes.sql)}</td></tr>
  <tr><td>Golang</td><td>${fmt(studyTimes.golang)}</td></tr>
  </table>

  <p style="margin-top:2rem;font-size:.82rem;color:#999;text-align:center">Generated by DevMaster Hub on ${new Date().toLocaleString()}</p>
  </body></html>`;

  document.getElementById('reportPreview').innerHTML = reportHtml;
}

function downloadReport() {
  if (!reportHtml) generateReport();
  const blob = new Blob([reportHtml], {type:'text/html'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `progress-report-${users[currentUserIdx]}-${new Date().toISOString().slice(0,10)}.html`;
  a.click();
  URL.revokeObjectURL(a.href);
  showToast('ðŸ“Š', 'Report downloaded!');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MINI PROJECTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderMiniProjects() {
  const grid = document.getElementById('miniProjectsGrid');
  let projects = [];
  
  if (currentMiniProjectFilter === 'all') {
    projects = [...MINI_PROJECTS.python, ...MINI_PROJECTS.sql, ...MINI_PROJECTS.golang];
  } else {
    projects = MINI_PROJECTS[currentMiniProjectFilter] || [];
  }
  
  grid.innerHTML = projects.map(proj => {
    const completed = load('dm_project_'+users[currentUserIdx]+'_'+proj.id, false);
    const inProgress = load('dm_project_inprogress_'+users[currentUserIdx]+'_'+proj.id, false);
    let status = 'Start';
    let statusClass = 'locked';
    if (completed) { status = 'âœ“ Completed'; statusClass = 'completed'; }
    else if (inProgress) { status = 'Continue'; statusClass = 'in-progress'; }
    
    return `<div class="project-card">
      <div class="project-header">
        <div class="project-title">
          <h4>${esc(proj.title)}</h4>
          <p>${esc(proj.desc)}</p>
        </div>
        <div class="project-badges">
          <span class="project-diff-badge ${proj.difficulty}">${proj.difficulty}</span>
          <span class="project-xp-badge">+${proj.xp}XP</span>
        </div>
      </div>
      <div class="project-section">
        <h5>â±ï¸ Estimated Time</h5>
        <p>${proj.time}</p>
      </div>
      <div class="project-footer">
        <div class="project-status ${statusClass}">
          ${completed ? 'ðŸ† Completed' : (inProgress ? 'â³ In Progress' : 'â­• Not Started')}
        </div>
        <button class="project-btn view" onclick="showProjectDetail('${proj.language||guessLanguage(proj.id)}','${proj.id}')">View</button>
      </div>
    </div>`;
  }).join('');
}

function guessLanguage(projectId) {
  if (projectId.startsWith('py-')) return 'python';
  if (projectId.startsWith('sql-')) return 'sql';
  if (projectId.startsWith('go-')) return 'golang';
  return 'python';
}

function filterMiniProjects(lang) {
  currentMiniProjectFilter = lang;
  document.querySelectorAll('#miniprojects .btn-sm').forEach(b => b.className = 'btn btn-sm btn-outline');
  event.target?.classList.add('btn-primary');
  renderMiniProjects();
}

function showProjectDetail(lang, projectId) {
  const allProjects = {...MINI_PROJECTS};
  let project = null;
  for (const l in allProjects) {
    project = allProjects[l].find(p => p.id === projectId);
    if (project) break;
  }
  if (!project) return;
  
  currentMiniProjectDetail = {lang, projectId, project};
  
  document.getElementById('projectModalTitle').textContent = project.title;
  document.getElementById('projectModalDesc').textContent = project.desc;
  document.getElementById('projectModalDiff').textContent = project.difficulty.toUpperCase();
  document.getElementById('projectModalXP').textContent = project.xp;
  document.getElementById('projectModalTime').textContent = project.time;
  
  const tasksList = project.tasks.map((t,i) => 
    `<div class="project-task">
      <input type="checkbox" id="task-${projectId}-${i}" onchange="saveTaskProgress('${projectId}',${i},this.checked)">
      <label for="task-${projectId}-${i}">${esc(t)}</label>
    </div>`).join('');
  document.getElementById('projectModalTasks').innerHTML = tasksList;
  
  // Load saved progress
  const savedTasks = load('dm_project_tasks_'+users[currentUserIdx]+'_'+projectId, []);
  savedTasks.forEach(idx => {
    const cb = document.getElementById(`task-${projectId}-${idx}`);
    if (cb) cb.checked = true;
  });
  
  document.getElementById('projectModalObjectives').innerHTML = 
    '<ul>' + project.objectives.map(o => `<li>${esc(o)}</li>`).join('') + '</ul>';
  
  document.getElementById('projectModalStarterCode').textContent = project.starterCode;
  document.getElementById('projectModalOutput').textContent = project.output;
  document.getElementById('projectModalHints').innerHTML = `<strong>ðŸ’¡ Hints & Tips:</strong><br>${esc(project.hints)}`;
  
  document.getElementById('projectModal').classList.add('show');
}

function closeProjectModal() {
  document.getElementById('projectModal').classList.remove('show');
  currentMiniProjectDetail = null;
}

function saveTaskProgress(projectId, taskIdx, checked) {
  let tasks = load('dm_project_tasks_'+users[currentUserIdx]+'_'+projectId, []);
  if (checked && !tasks.includes(taskIdx)) {
    tasks.push(taskIdx);
  } else if (!checked && tasks.includes(taskIdx)) {
    tasks = tasks.filter(t => t !== taskIdx);
  }
  save('dm_project_tasks_'+users[currentUserIdx]+'_'+projectId, tasks);
  showToast('âœ…', 'Task progress saved!');
}

function startMiniProject() {
  if (!currentMiniProjectDetail) return;
  const {projectId} = currentMiniProjectDetail;
  save('dm_project_inprogress_'+users[currentUserIdx]+'_'+projectId, true);
  addXP(50, 'Started project: ' + currentMiniProjectDetail.project.title);
  showToast('ðŸš€', 'Project started! +50 XP');
  closeProjectModal();
  renderMiniProjects();
}

function completeMiniProject() {
  if (!currentMiniProjectDetail) return;
  const {projectId, project} = currentMiniProjectDetail;
  save('dm_project_'+users[currentUserIdx]+'_'+projectId, true);
  save('dm_project_inprogress_'+users[currentUserIdx]+'_'+projectId, false);
  addXP(project.xp, 'Completed project: ' + project.title);
  showToast('ðŸ†', `Project completed! +${project.xp} XP`);
  closeProjectModal();
  renderMiniProjects();
}

function downloadMiniProject() {
  if (!currentMiniProjectDetail) return;
  const {projectId, project} = currentMiniProjectDetail;
  
  let content = `PROJECT: ${project.title}
Description: ${project.desc}
Difficulty: ${project.difficulty}
Estimated Time: ${project.time}
XP Reward: ${project.xp}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OBJECTIVES:
${project.objectives.map((o,i) => `${i+1}. ${o}`).join('\n')}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TASKS (Check off as you complete):
${project.tasks.map((t,i) => `â–¡ ${i+1}. ${t}`).join('\n')}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STARTER CODE:

${project.starterCode}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EXPECTED OUTPUT:

${project.output}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

HINTS & TIPS:

${project.hints}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

YOUR SOLUTION:

[Write your code here]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`;

  const blob = new Blob([content], {type: 'text/plain'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `${projectId}-starter.txt`;
  a.click();
  URL.revokeObjectURL(a.href);
  showToast('ðŸ“¥', 'Starter code downloaded!');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• START â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function fullInit() {
  init();
  recordLogin();
  loadCustomTheme();
  renderDashboard();
  renderSchedule();
  renderAllCheatSheets();
  renderVideos();
  renderFlashcards();
  renderChallenges();
  renderMiniProjects();
  renderInterviews();
  renderErrors();
  renderCompareTable();
  renderGlossary();
  renderPrompts();
  renderGoals();
  renderCertificate();
  renderCommunity();
  loadPgTemplate();
  updatePomoDisplay();
  checkBadges();
  renderDailyTip();
  renderStudyTimerBar();
  renderStreakMilestones();
  renderProgressMap();
  renderDebugExercises();
  renderFITB();
  renderDnD();
  initFloatingChatbot();
}

// One-time: clear all old accounts so user starts fresh
(function(){
  if(!localStorage.getItem('dm_fresh_v6')){
    ['dm_accounts','dm_logged_in','dm_clean_v5','dm_fresh_start_v2','dm_fresh_start_v3','dm_fresh_start_v4'].forEach(function(k){ localStorage.removeItem(k); });
    localStorage.setItem('dm_fresh_v6','1');
  }
})();

// Check if already logged in, otherwise show auth overlay
if(checkAuth()){
  fullInit();
}

// Load saved theme on startup
loadSavedTheme();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PARTICLE ANIMATION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initParticles() {
  var canvas = document.getElementById('particleCanvas');
  if (!canvas) return;
  var ctx = canvas.getContext('2d');
  var particles = [];
  var animId = null;

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  for (var i = 0; i < 60; i++) {
    particles.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      r: Math.random() * 2.5 + 1,
      dx: (Math.random() - 0.5) * 0.6,
      dy: (Math.random() - 0.5) * 0.6,
      alpha: Math.random() * 0.5 + 0.3
    });
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (var i = 0; i < particles.length; i++) {
      var p = particles[i];
      p.x += p.dx;
      p.y += p.dy;
      if (p.x < 0) p.x = canvas.width;
      if (p.x > canvas.width) p.x = 0;
      if (p.y < 0) p.y = canvas.height;
      if (p.y > canvas.height) p.y = 0;
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(13,148,136,' + p.alpha + ')';
      ctx.fill();
      // Draw lines between close particles
      for (var j = i + 1; j < particles.length; j++) {
        var p2 = particles[j];
        var dist = Math.sqrt((p.x - p2.x) ** 2 + (p.y - p2.y) ** 2);
        if (dist < 120) {
          ctx.beginPath();
          ctx.moveTo(p.x, p.y);
          ctx.lineTo(p2.x, p2.y);
          ctx.strokeStyle = 'rgba(13,148,136,' + (0.15 * (1 - dist / 120)) + ')';
          ctx.lineWidth = 0.5;
          ctx.stroke();
        }
      }
    }
    animId = requestAnimationFrame(draw);
  }
  draw();

  window._stopParticles = function() {
    if (animId) cancelAnimationFrame(animId);
    if (canvas) canvas.remove();
  };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONFETTI CELEBRATION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function fireConfetti() {
  var container = document.createElement('div');
  container.style.cssText = 'position:fixed;inset:0;z-index:99999;pointer-events:none;overflow:hidden';
  document.body.appendChild(container);
  var colors = ['#0d9488','#d97706','#ec4899','#7c3aed','#2563eb','#16a34a','#f59e0b','#dc2626','#06b6d4'];
  for (var i = 0; i < 60; i++) {
    var piece = document.createElement('div');
    var color = colors[Math.floor(Math.random() * colors.length)];
    var size = Math.random() * 8 + 4;
    var left = Math.random() * 100;
    var delay = Math.random() * 0.5;
    var rot = Math.random() * 360;
    var shape = Math.random() > 0.5 ? '50%' : '2px';
    piece.style.cssText = 'position:absolute;top:-10px;left:' + left + '%;width:' + size + 'px;height:' + size + 'px;background:' + color + ';border-radius:' + shape + ';opacity:0.9;animation:confettiFall ' + (2 + Math.random()) + 's ease-out ' + delay + 's forwards;transform:rotate(' + rot + 'deg)';
    container.appendChild(piece);
  }
  setTimeout(function() { container.remove(); }, 3500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DAILY MOTIVATIONAL QUOTE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
var CODING_QUOTES = [
  {q:"The best error message is the one that never shows up.", a:"Thomas Fuchs"},
  {q:"First, solve the problem. Then, write the code.", a:"John Johnson"},
  {q:"Code is like humor. When you have to explain it, it's bad.", a:"Cory House"},
  {q:"Make it work, make it right, make it fast.", a:"Kent Beck"},
  {q:"Clean code always looks like it was written by someone who cares.", a:"Robert C. Martin"},
  {q:"Programs must be written for people to read, and only incidentally for machines to execute.", a:"Harold Abelson"},
  {q:"The only way to learn a new programming language is by writing programs in it.", a:"Dennis Ritchie"},
  {q:"Sometimes it pays to stay in bed on Monday, rather than spending the rest of the week debugging Monday's code.", a:"Dan Salomon"},
  {q:"Debugging is twice as hard as writing the code in the first place.", a:"Brian Kernighan"},
  {q:"The most disastrous thing that you can ever learn is your first programming language.", a:"Alan Kay"},
  {q:"Simplicity is the soul of efficiency.", a:"Austin Freeman"},
  {q:"Any fool can write code that a computer can understand. Good programmers write code that humans can understand.", a:"Martin Fowler"},
  {q:"Programming isn't about what you know; it's about what you can figure out.", a:"Chris Pine"},
  {q:"The function of good software is to make the complex appear to be simple.", a:"Grady Booch"},
  {q:"It's not a bug; it's an undocumented feature.", a:"Anonymous"},
  {q:"Talk is cheap. Show me the code.", a:"Linus Torvalds"},
  {q:"Perfection is achieved not when there is nothing more to add, but when there is nothing left to take away.", a:"Antoine de Saint-Exupery"},
  {q:"Java is to JavaScript what car is to carpet.", a:"Chris Heilmann"},
  {q:"In theory, there is no difference between theory and practice. But in practice, there is.", a:"Jan L. A. van de Snepscheut"},
  {q:"Truth can only be found in one place: the code.", a:"Robert C. Martin"},
  {q:"A language that doesn't affect the way you think about programming is not worth knowing.", a:"Alan Perlis"},
  {q:"The computer was born to solve problems that did not exist before.", a:"Bill Gates"},
  {q:"Experience is the name everyone gives to their mistakes.", a:"Oscar Wilde"},
  {q:"Knowledge is power, but enthusiasm pulls the switch.", a:"Ivern Ball"}
];

function getDailyQuote() {
  var dayOfYear = Math.floor((Date.now() - new Date(new Date().getFullYear(),0,0)) / 86400000);
  return CODING_QUOTES[dayOfYear % CODING_QUOTES.length];
}

function renderQuoteBanner() {
  var existing = document.getElementById('quoteBanner');
  if (existing) existing.remove();
  var quote = getDailyQuote();
  var banner = document.createElement('div');
  banner.id = 'quoteBanner';
  banner.className = 'quote-banner';
  banner.innerHTML = '<div class="quote-icon">ðŸ’¡</div><div class="quote-content"><div class="quote-text">"' + quote.q + '"</div><div class="quote-author">â€” ' + quote.a + '</div></div>';
  var dashboard = document.getElementById('dashboard');
  if (dashboard) {
    var statsDiv = dashboard.querySelector('.dash-stats');
    if (statsDiv) statsDiv.parentNode.insertBefore(banner, statsDiv.nextSibling);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PROGRESS RINGS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderProgressRings() {
  var existing = document.getElementById('progressRings');
  if (existing) existing.remove();

  var xp = getUserXP();
  var lvl = getLevel(xp);
  var xpInLvl = getXPInCurrentLevel(xp);
  var xpNeeded = getXPForLevel(lvl);
  var xpPct = Math.round(xpInLvl / xpNeeded * 100);

  var totalQuiz = 0;
  ['python','sql','golang'].forEach(function(mod) {
    var state = load('dm_quiz_' + mod + '_' + users[currentUserIdx], {});
    var qs = QUIZZES[mod];
    for (var i = 0; i < qs.length; i++) { if (state['q' + i] === qs[i].ans) totalQuiz++; }
  });
  var quizPct = Math.round(totalQuiz / 45 * 100);
  var conceptPct = getConceptCompletionPct();

  var rings = [
    {label:'XP Progress', pct:xpPct, color:'var(--accent)', val:xpPct+'%'},
    {label:'Quiz Score', pct:quizPct, color:'var(--accent2)', val:totalQuiz+'/45'},
    {label:'Concepts', pct:conceptPct, color:'var(--success)', val:conceptPct+'%'}
  ];

  var html = '<div id="progressRings" class="card progress-rings-card"><h3>ðŸ“Š Progress Overview</h3><div class="rings-grid">';
  rings.forEach(function(r) {
    var circumference = 2 * Math.PI * 40;
    var offset = circumference - (r.pct / 100) * circumference;
    html += '<div class="ring-item">' +
      '<svg width="100" height="100" viewBox="0 0 100 100">' +
      '<circle cx="50" cy="50" r="40" fill="none" stroke="var(--border)" stroke-width="6"/>' +
      '<circle class="ring-progress" cx="50" cy="50" r="40" fill="none" stroke="' + r.color + '" stroke-width="6" stroke-linecap="round" stroke-dasharray="' + circumference + '" stroke-dashoffset="' + circumference + '" data-target="' + offset + '" transform="rotate(-90 50 50)" style="transition:stroke-dashoffset 1.5s ease-out"/>' +
      '<text x="50" y="50" text-anchor="middle" dominant-baseline="central" fill="var(--text)" font-size="14" font-weight="700">' + r.val + '</text>' +
      '</svg>' +
      '<div class="ring-label">' + r.label + '</div>' +
      '</div>';
  });
  html += '</div></div>';

  var dashboard = document.getElementById('dashboard');
  if (dashboard) {
    var quoteBanner = document.getElementById('quoteBanner');
    var insertAfter = quoteBanner || dashboard.querySelector('.dash-stats');
    if (insertAfter && insertAfter.nextSibling) {
      insertAfter.parentNode.insertBefore(createElementFromHTML(html), insertAfter.nextSibling);
    } else if (dashboard.firstChild) {
      dashboard.appendChild(createElementFromHTML(html));
    }
  }

  // Animate rings after a short delay
  setTimeout(function() {
    var ringEls = document.querySelectorAll('.ring-progress');
    ringEls.forEach(function(el) {
      el.style.strokeDashoffset = el.getAttribute('data-target');
    });
  }, 200);
}

function createElementFromHTML(htmlString) {
  var div = document.createElement('div');
  div.innerHTML = htmlString.trim();
  return div.firstChild;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TYPING SPEED TEST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const CODE_SNIPPETS = {
python: [
  `def fibonacci(n):\n    a, b = 0, 1\n    result = []\n    for _ in range(n):\n        result.append(a)\n        a, b = b, a + b\n    return result`,
  `def is_palindrome(s):\n    s = s.lower().strip()\n    return s == s[::-1]`,
  `class Stack:\n    def __init__(self):\n        self.items = []\n\n    def push(self, item):\n        self.items.append(item)\n\n    def pop(self):\n        return self.items.pop()`,
  `def word_count(text):\n    words = text.split()\n    freq = {}\n    for w in words:\n        freq[w] = freq.get(w, 0) + 1\n    return freq`,
  `def binary_search(arr, target):\n    low, high = 0, len(arr) - 1\n    while low <= high:\n        mid = (low + high) // 2\n        if arr[mid] == target:\n            return mid\n        elif arr[mid] < target:\n            low = mid + 1\n        else:\n            high = mid - 1\n    return -1`,
  `numbers = [3, 1, 4, 1, 5, 9]\nsquares = [x**2 for x in numbers]\nevens = [x for x in numbers if x % 2 == 0]\nprint(sorted(squares))`,
  `with open("data.txt", "r") as f:\n    lines = f.readlines()\n    for line in lines:\n        print(line.strip())`
],
sql: [
  `SELECT e.name, d.dept_name\nFROM employees e\nINNER JOIN departments d\nON e.dept_id = d.id\nWHERE e.salary > 50000\nORDER BY e.name;`,
  `SELECT department,\n       COUNT(*) AS total,\n       AVG(salary) AS avg_sal\nFROM employees\nGROUP BY department\nHAVING COUNT(*) > 5\nORDER BY avg_sal DESC;`,
  `SELECT name, salary,\n       RANK() OVER (\n         PARTITION BY dept_id\n         ORDER BY salary DESC\n       ) AS dept_rank\nFROM employees;`,
  `INSERT INTO orders (customer_id, product, qty)\nVALUES (101, 'Laptop', 1);\n\nUPDATE products\nSET stock = stock - 1\nWHERE name = 'Laptop';`,
  `CREATE TABLE users (\n    id INT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(255) UNIQUE,\n    created_at TIMESTAMP DEFAULT NOW()\n);`,
  `SELECT c.name,\n       COALESCE(SUM(o.total), 0) AS spending\nFROM customers c\nLEFT JOIN orders o ON c.id = o.customer_id\nGROUP BY c.name\nORDER BY spending DESC;`
],
golang: [
  `func main() {\n    nums := []int{2, 4, 6, 8}\n    sum := 0\n    for _, n := range nums {\n        sum += n\n    }\n    fmt.Println("Sum:", sum)\n}`,
  `type Person struct {\n    Name string\n    Age  int\n}\n\nfunc (p Person) Greet() string {\n    return "Hello, " + p.Name\n}`,
  `func divide(a, b float64) (float64, error) {\n    if b == 0 {\n        return 0, errors.New("division by zero")\n    }\n    return a / b, nil\n}`,
  `func worker(id int, ch chan string) {\n    time.Sleep(time.Second)\n    ch <- fmt.Sprintf("worker %d done", id)\n}\n\nfunc main() {\n    ch := make(chan string, 3)\n    for i := 1; i <= 3; i++ {\n        go worker(i, ch)\n    }\n}`,
  `func contains(slice []string, item string) bool {\n    for _, v := range slice {\n        if v == item {\n            return true\n        }\n    }\n    return false\n}`,
  `func reverseString(s string) string {\n    runes := []rune(s)\n    for i, j := 0, len(runes)-1; i < j; i, j = i+1, j-1 {\n        runes[i], runes[j] = runes[j], runes[i]\n    }\n    return string(runes)\n}`
]
};

let ttState = { active: false, snippet: '', startTime: null, timerInterval: null, errors: 0, totalTyped: 0, correctTyped: 0 };

function startTypingTest() {
  const lang = document.getElementById('ttLang').value;
  const snippets = CODE_SNIPPETS[lang];
  const snippet = snippets[Math.floor(Math.random() * snippets.length)];
  ttState = { active: true, snippet: snippet, startTime: null, timerInterval: null, errors: 0, totalTyped: 0, correctTyped: 0 };

  const display = document.getElementById('ttDisplay');
  display.innerHTML = snippet.split('').map((ch, i) =>
    `<span class="typing-char" id="ttc${i}">${ch === '\n' ? 'â†µ\n' : ch === ' ' ? 'Â·' : ch.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</span>`
  ).join('');
  if (display.querySelector('#ttc0')) display.querySelector('#ttc0').classList.add('typing-current');

  const input = document.getElementById('ttInput');
  input.disabled = false;
  input.value = '';
  input.focus();
  input.oninput = onTypingTestInput;

  document.getElementById('ttResult').style.display = 'none';
  document.getElementById('ttTimer').textContent = '0';
  document.getElementById('ttWPM').textContent = '0';
  document.getElementById('ttAccuracy').textContent = '100%';
  document.getElementById('ttErrors').textContent = '0';
  document.getElementById('ttStartBtn').textContent = 'â³ Typing...';
  document.getElementById('ttStartBtn').disabled = true;
}

function onTypingTestInput() {
  if (!ttState.active) return;
  const input = document.getElementById('ttInput');
  const typed = input.value;

  if (!ttState.startTime && typed.length > 0) {
    ttState.startTime = Date.now();
    ttState.timerInterval = setInterval(updateTypingTimer, 200);
  }

  let errors = 0;
  let correct = 0;
  for (let i = 0; i < ttState.snippet.length; i++) {
    const el = document.getElementById('ttc' + i);
    if (!el) continue;
    el.className = 'typing-char';
    if (i < typed.length) {
      if (typed[i] === ttState.snippet[i]) {
        el.classList.add('typing-correct');
        correct++;
      } else {
        el.classList.add('typing-wrong');
        errors++;
      }
    }
    if (i === typed.length) {
      el.classList.add('typing-current');
    }
  }

  ttState.totalTyped = typed.length;
  ttState.correctTyped = correct;
  ttState.errors = errors;

  const elapsed = ttState.startTime ? (Date.now() - ttState.startTime) / 1000 : 0;
  const minutes = elapsed / 60;
  const wpm = minutes > 0 ? Math.round((correct / 5) / minutes) : 0;
  const accuracy = typed.length > 0 ? Math.round((correct / typed.length) * 100) : 100;

  document.getElementById('ttWPM').textContent = wpm;
  document.getElementById('ttAccuracy').textContent = accuracy + '%';
  document.getElementById('ttErrors').textContent = errors;

  if (typed.length >= ttState.snippet.length) {
    finishTypingTest();
  }
}

function updateTypingTimer() {
  if (!ttState.startTime) return;
  const elapsed = Math.round((Date.now() - ttState.startTime) / 1000);
  document.getElementById('ttTimer').textContent = elapsed;
}

function finishTypingTest() {
  ttState.active = false;
  clearInterval(ttState.timerInterval);
  document.getElementById('ttInput').disabled = true;
  document.getElementById('ttStartBtn').textContent = 'â–¶ Start Test';
  document.getElementById('ttStartBtn').disabled = false;

  const elapsed = (Date.now() - ttState.startTime) / 1000;
  const minutes = elapsed / 60;
  const wpm = minutes > 0 ? Math.round((ttState.correctTyped / 5) / minutes) : 0;
  const accuracy = ttState.totalTyped > 0 ? Math.round((ttState.correctTyped / ttState.totalTyped) * 100) : 100;

  const result = {
    date: new Date().toLocaleDateString(),
    lang: document.getElementById('ttLang').value,
    wpm: wpm,
    accuracy: accuracy,
    time: Math.round(elapsed),
    errors: ttState.errors
  };

  const histKey = 'dm_typing_history_' + users[currentUserIdx];
  const history = load(histKey, []);
  history.unshift(result);
  if (history.length > 20) history.length = 20;
  save(histKey, history);

  const resultDiv = document.getElementById('ttResult');
  resultDiv.style.display = 'block';
  resultDiv.innerHTML = `<div class="typing-result">
    <h3>ðŸŽ‰ Test Complete!</h3>
    <div class="typing-result-grid">
      <div class="typing-result-stat"><div class="big">${wpm}</div><div class="small">WPM</div></div>
      <div class="typing-result-stat"><div class="big">${accuracy}%</div><div class="small">Accuracy</div></div>
      <div class="typing-result-stat"><div class="big">${result.time}s</div><div class="small">Time</div></div>
      <div class="typing-result-stat"><div class="big">${ttState.errors}</div><div class="small">Errors</div></div>
    </div>
    <p style="font-size:.85rem;color:var(--muted)">${wpm >= 60 ? 'ðŸ”¥ Blazing fast!' : wpm >= 40 ? 'ðŸ‘ Great speed!' : wpm >= 20 ? 'ðŸ’ª Keep practicing!' : 'ðŸŒ± Good start â€” practice makes perfect!'}</p>
  </div>`;

  renderTypingTestHistory();
  addXP(Math.max(5, Math.round(wpm / 2)));
  showToast('âŒ¨ï¸', `Typing test done! ${wpm} WPM, ${accuracy}% accuracy`);
}

function resetTypingTest() {
  ttState.active = false;
  if (ttState.timerInterval) clearInterval(ttState.timerInterval);
  document.getElementById('ttDisplay').innerHTML = 'Press <strong style="color:var(--accent)">Start Test</strong> to begin...';
  document.getElementById('ttInput').value = '';
  document.getElementById('ttInput').disabled = true;
  document.getElementById('ttResult').style.display = 'none';
  document.getElementById('ttTimer').textContent = '0';
  document.getElementById('ttWPM').textContent = '0';
  document.getElementById('ttAccuracy').textContent = '100%';
  document.getElementById('ttErrors').textContent = '0';
  document.getElementById('ttStartBtn').textContent = 'â–¶ Start Test';
  document.getElementById('ttStartBtn').disabled = false;
}

function renderTypingTestHistory() {
  const histKey = 'dm_typing_history_' + users[currentUserIdx];
  const history = load(histKey, []);
  const container = document.getElementById('ttHistory');
  if (!container) return;
  if (history.length === 0) {
    container.innerHTML = '<p style="text-align:center;color:var(--muted);font-size:.85rem;margin-top:1rem">No typing history yet. Start a test!</p>';
    return;
  }
  container.innerHTML = '<h4 style="margin-bottom:.6rem">ðŸ“Š Recent Results</h4>' +
    '<div class="typing-history-row"><span>Date</span><span>Language</span><span>WPM</span><span>Accuracy</span><span>Time</span></div>' +
    history.slice(0, 10).map(h =>
      `<div class="typing-history-row"><span>${h.date}</span><span>${h.lang}</span><span style="font-weight:700;color:var(--accent)">${h.wpm}</span><span>${h.accuracy}%</span><span>${h.time}s</span></div>`
    ).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WELCOME BANNER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const MOTIVATIONAL_MESSAGES = [
  "Every expert was once a beginner. Keep coding!",
  "Code is like humor. When you have to explain it, it's bad.",
  "The best way to predict the future is to create it.",
  "Small daily improvements lead to staggering results.",
  "Don't watch the clock; do what it does â€” keep going.",
  "First, solve the problem. Then, write the code.",
  "The only way to learn programming is by programming.",
  "Today's struggle is tomorrow's strength.",
  "Debug your doubts, compile your confidence!",
  "Consistency beats intensity. Show up every day!",
  "You're one commit away from something amazing.",
  "Programs must be written for people to read.",
  "Think twice, code once."
];

function renderWelcomeBanner() {
  const banner = document.getElementById('welcomeBanner');
  const textEl = document.getElementById('welcomeText');
  const subEl = document.getElementById('welcomeSubtitle');
  if (!banner || !textEl) return;

  const hour = new Date().getHours();
  let greeting;
  if (hour >= 5 && hour < 12) greeting = 'Good Morning';
  else if (hour >= 12 && hour < 17) greeting = 'Good Afternoon';
  else if (hour >= 17 && hour < 22) greeting = 'Good Evening';
  else greeting = 'Good Night';

  const name = users[currentUserIdx] || 'Developer';
  const fullText = `${greeting}, ${name}! ðŸš€`;
  const subtitle = MOTIVATIONAL_MESSAGES[Math.floor(Math.random() * MOTIVATIONAL_MESSAGES.length)];

  banner.style.display = 'flex';
  textEl.textContent = '';
  textEl.classList.remove('done');
  subEl.textContent = subtitle;
  subEl.style.animation = 'none';

  let charIdx = 0;
  function typeChar() {
    if (charIdx < fullText.length) {
      textEl.textContent += fullText[charIdx];
      charIdx++;
      setTimeout(typeChar, 40);
    } else {
      textEl.classList.add('done');
      subEl.style.animation = 'fadeInUp .5s ease-out forwards';
    }
  }
  typeChar();
}


</script>
</body>
</html>
